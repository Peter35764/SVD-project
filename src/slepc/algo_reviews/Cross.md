# Cross.c
## 1. –í–≤–µ–¥–µ–Ω–∏–µ
### –¢–µ—Ä–º–∏–Ω—ã
–ú–µ—Ç–æ–¥ svd CrossMatrix –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ **–∫—Ä–æ—Å—Å-–º–∞—Ç—Ä–∏—Ü—ã**:
C = A * $A^T$, –≥–¥–µ A - –∏—Å—Ö–æ–¥–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞, $A^T$ - –µ–µ —Ç—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞.

**–≥–∏–ø–µ—Ä–±–æ–ª–∏—á–µ—Å–∫–∏–π —Ç–∏–ø –º–∞—Ç—Ä–∏—Ü—ã**

–ú–∞—Ç—Ä–∏—Ü–∞ A —è–≤–ª—è–µ—Ç—Å—è –≥–∏–ø–µ—Ä–±–æ–ª–∏—á–µ—Å–∫–∏ —Ç–∏–ø–∞, –µ—Å–ª–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ —É—Å–ª–æ–≤–∏—è:
1. –í—Å–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è Œª_i –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ.
2. –°—Ä–µ–¥–∏ —ç—Ç–∏—Ö —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –µ—Å—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ –∏ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ.

–î—Ä—É–≥–∏–º–∏ —Å–ª–æ–≤–∞–º–∏, –µ—Å–ª–∏ —Å—Ä–µ–¥–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –º–∞—Ç—Ä–∏—Ü—ã –µ—Å—Ç—å –∫–∞–∫ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ, —Ç–∞–∫ –∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ, —Ç–æ —Ç–∞–∫–∞—è –º–∞—Ç—Ä–∏—Ü–∞ —è–≤–ª—è–µ—Ç—Å—è –≥–∏–ø–µ—Ä–±–æ–ª–∏—á–µ—Å–∫–∏–º —Ç–∏–ø–∞.

**–û–±–æ–±—â–µ–Ω–Ω—ã–π —Ç–∏–ø –º–∞—Ç—Ä–∏—Ü—ã**  
##### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ: –û–±–æ–±—â—ë–Ω–Ω—ã–π —Ç–∏–ø –º–∞—Ç—Ä–∏—Ü—ã –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—É, –≥–¥–µ —ç–ª–µ–º–µ–Ω—Ç—ã, —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ –∏–ª–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω—ã –¥–ª—è —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–π, —Ç–∞–∫–∏—Ö –∫–∞–∫ —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω—ã–µ –º–∞—Ç—Ä–∏—Ü—ã, –±–ª–æ—á–Ω—ã–µ –º–∞—Ç—Ä–∏—Ü—ã, –º–∞—Ç—Ä–∏—Ü—ã —Ñ—É–Ω–∫—Ü–∏–π, –∏–ª–∏ —Ç–µ–Ω–∑–æ—Ä—ã.

–û—Å–Ω–æ–≤–Ω—ã–µ —á–µ—Ä—Ç—ã:
–≠–ª–µ–º–µ–Ω—Ç—ã –º–∞—Ç—Ä–∏—Ü—ã:
 - –ù–µ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—Ç—Å—è —á–∏—Å–ª–∞–º–∏ (–º–æ–≥—É—Ç –±—ã—Ç—å —Ñ—É–Ω–∫—Ü–∏—è–º–∏, –≤–µ–∫—Ç–æ—Ä–∞–º–∏, –æ–±—ä–µ–∫—Ç–∞–º–∏ –∏–ª–∏ –≤—ã—Ä–∞–∂–µ–Ω–∏—è–º–∏).
–†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å:
- –ú–æ–∂–µ—Ç –±—ã—Ç—å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π, –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–π, –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–π –∏–ª–∏ –º–Ω–æ–≥–æ–º–µ—Ä–Ω–æ–π.
–û–ø–µ—Ä–∞—Ü–∏–∏:
- –†–∞—Å—à–∏—Ä—è—é—Ç—Å—è –¥–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π, –Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–Ω—Ç–µ–≥—Ä–∞–ª–æ–≤ –∏–ª–∏ –¥–∏—Å–∫—Ä–µ—Ç–Ω—ã—Ö –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π.
–ü—Ä–∏–º–µ—Ä—ã:
 - –ë–ª–æ—á–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞: –ú–∞—Ç—Ä–∏—Ü–∞, —ç–ª–µ–º–µ–Ω—Ç—ã –∫–æ—Ç–æ—Ä–æ–π —Å–∞–º–∏ —è–≤–ª—è—é—Ç—Å—è –º–∞—Ç—Ä–∏—Ü–∞–º–∏.
 - –†–∞–∑—Ä–µ–∂–µ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞: –•—Ä–∞–Ω–∏—Ç —Ç–æ–ª—å–∫–æ –Ω–µ–Ω—É–ª–µ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –ø–∞–º—è—Ç–∏.
 - –¢–µ–Ω–∑–æ—Ä: –ú–Ω–æ–≥–æ–º–µ—Ä–Ω–æ–µ –æ–±–æ–±—â–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü—ã.

**–æ–±—â–∞—è –∑–∞–¥–∞—á–µ —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π**
–ó–∞–¥–∞—á–∞ —Å–∏–Ω–≥—É–ª—è—Ä–Ω–æ–≥–æ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏—è –¥–ª—è –ø–∞—Ä—ã –º–∞—Ç—Ä–∏—Ü –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –≤ —Ç–∞–∫ –Ω–∞–∑—ã–≤–∞–µ–º–æ–π –æ–±—â–µ–π –∑–∞–¥–∞—á–µ —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π (Generalized Singular Value Decomposition, GSVD). –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ SVD, –≥–¥–µ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç—Å—è –æ–¥–Ω–∞ –º–∞—Ç—Ä–∏—Ü–∞, –≤ GSVD —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—é—Ç—Å—è –¥–≤–µ –º–∞—Ç—Ä–∏—Ü—ã –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ. –ó–∞–¥–∞—á–∞ —Ñ–æ—Ä–º—É–ª–∏—Ä—É–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

–î–∞–Ω—ã –¥–≤–µ –º–∞—Ç—Ä–∏—Ü—ã A –∏ B —Ä–∞–∑–º–µ—Ä–∞ m√ón –∏ p√ón, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ. –¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞–π—Ç–∏ —Ç–∞–∫–∏–µ —É–Ω–∏—Ç–∞—Ä–Ω—ã–µ –º–∞—Ç—Ä–∏—Ü—ã U, V –∏ –¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É Œ£, —á—Ç–æ:

- $A = U * Œ£_A * X^T$
- $B = V * Œ£_B * X^T$
–ì–¥–µ X –∏ Y ‚Äî —É–Ω–∏—Ç–∞—Ä–Ω—ã–µ –º–∞—Ç—Ä–∏—Ü—ã, –∞ Œ£ ‚Äî –¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ —Å —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏.
##### –†–æ–ª—å –º–∞—Ç—Ä–∏—Ü A –∏ B:
- A –ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –ø–µ—Ä–≤—É—é –∏ –≤—Ç–æ—Ä—É—é –º–∞—Ç—Ä–∏—Ü—É, —É—á–∞—Å—Ç–≤—É—é—â—É—é –≤ –∑–∞–¥–∞—á–µ GSVD.
- B –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –ø–µ—Ä–≤–æ–≥–æ –∏ –≤—Ç–æ—Ä–æ–≥–æ –Ω–∞–±–æ—Ä–∞ —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤.
##### –†–æ–ª—å –≤–µ–∫—Ç–æ—Ä–æ–≤ u –∏ v:
- u –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø–µ—Ä–≤–æ–º—É –∏ –≤—Ç–æ—Ä–æ–º—É –Ω–∞–±–æ—Ä—É —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤, –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –∏–∑ –º–∞—Ç—Ä–∏—Ü—ã A –∏ B.
- v –Ø–≤–ª—è—é—Ç—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –æ–ø–µ—Ä–∞—Ü–∏–∏ MatMult.

**–ü–ª–æ—Ö–æ –æ–±—É—Å–ª–æ–≤–ª–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞**  
##### –ü–ª–æ—Ö–æ –æ–±—É—Å–ª–æ–≤–ª–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ ‚Äî —ç—Ç–æ —Å–∏—Å—Ç–µ–º–∞ –ª–∏–Ω–µ–π–Ω—ã—Ö —É—Ä–∞–≤–Ω–µ–Ω–∏–π, –≤ –∫–æ—Ç–æ—Ä–æ–π –Ω–µ–±–æ–ª—å—à–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –º–∞—Ç—Ä–∏—Ü—ã –∏–ª–∏ –ø—Ä–∞–≤–∞—è —á–∞—Å—Ç—å) –ø—Ä–∏–≤–æ–¥—è—Ç –∫ —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–º –∏–∑–º–µ–Ω–µ–Ω–∏—è–º –≤ —Ä–µ—à–µ–Ω–∏–∏. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç —Ä–µ—à–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –∫—Ä–∞–π–Ω–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º –∫ –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—è–º –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –∏–ª–∏ –∏–∑–º–µ—Ä–µ–Ω–∏–π.

##### –ö–≤–∞–Ω—Ç–æ–≤–∞–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü—ã ‚Äî —ç—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –º–∞—Ç—Ä–∏—Ü—ã –∏–∑ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–≥–æ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –∑–Ω–∞—á–µ–Ω–∏–π –≤ –¥–∏—Å–∫—Ä–µ—Ç–Ω–æ–µ –º–Ω–æ–∂–µ—Å—Ç–≤–æ, —Å–æ—Å—Ç–æ—è—â–µ–µ –∏–∑ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –Ω–∞–±–æ—Ä–∞ —É—Ä–æ–≤–Ω–µ–π (–∫–≤–∞–Ω—Ç–æ–≤). –≠—Ç–æ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –¥–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è –æ–±—ä–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö, –ø–æ–≤—ã—à–µ–Ω–∏—è –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ–π —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏–ª–∏ –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ –º–∞—Ç—Ä–∏—Ü –∫ —Å–∏—Å—Ç–µ–º–∞–º —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–π –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ–π —Ç–æ—á–Ω–æ—Å—Ç—å—é.

–§–æ—Ä–º—É–ª–∞ –∫–≤–∞–Ω—Ç–æ–≤–∞–Ω–∏—è –º–∞—Ç—Ä–∏—Ü—ã –≤—ã–≥–ª—è–¥–∏—Ç —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

$a_{ij}^{\text{quantized}} = \text{round}\left(\frac{a_{ij} - a_{\text{min}}}{\Delta}\right) \cdot \Delta + a_{\text{min}}$

–≥–¥–µ:
    $a_{ij}$ ‚Äî —ç–ª–µ–º–µ–Ω—Ç –∏—Å—Ö–æ–¥–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã $A$,
    $a_{\text{min}}$ ‚Äî –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–∏–∞–ø–∞–∑–æ–Ω–∞,
    $\Delta = \frac{a_{\text{max}} - a_{\text{min}}}{L - 1}$ ‚Äî —à–∞–≥ –∫–≤–∞–Ω—Ç–æ–≤–∞–Ω–∏—è,
    $L$ ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Ä–æ–≤–Ω–µ–π –∫–≤–∞–Ω—Ç–æ–≤–∞–Ω–∏—è.

–î–∏—Å–∫—Ä–µ—Ç–Ω–æ–µ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –∏–≥—Ä–∞–µ—Ç –∫–ª—é—á–µ–≤—É—é —Ä–æ–ª—å –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ –∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∫–≤–∞–Ω—Ç–æ–≤–∞–Ω–∏—è –º–∞—Ç—Ä–∏—Ü—ã, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫ –∫–∞–∫–∏–º –∑–Ω–∞—á–µ–Ω–∏—è–º –º–æ–≥—É—Ç –±—ã—Ç—å –ø—Ä–∏–≤–µ–¥–µ–Ω—ã —ç–ª–µ–º–µ–Ω—Ç—ã –º–∞—Ç—Ä–∏—Ü—ã –ø–æ—Å–ª–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è. –ë–µ–∑ –¥–∏—Å–∫—Ä–µ—Ç–Ω–æ–≥–æ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –∫–≤–∞–Ω—Ç–æ–≤–∞–Ω–∏–µ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ, –ø–æ—Å–∫–æ–ª—å–∫—É —Å—É—Ç—å –ø—Ä–æ—Ü–µ—Å—Å–∞ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –ø–µ—Ä–µ–≤–æ–¥–µ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–≥–æ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –∑–Ω–∞—á–µ–Ω–∏–π –≤ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –Ω–∞–±–æ—Ä —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —É—Ä–æ–≤–Ω–µ–π.

##### –ê–ª–≥–æ—Ä–∏—Ç–º–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü ‚Äî —ç—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –º–∞—Ç—Ä–∏—Ü—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∞–ª–≥–æ—Ä–∏—Ç–º–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º —ç–ª–µ–º–µ–Ω—Ç—ã –º–∞—Ç—Ä–∏—Ü—ã –≤—ã—á–∏—Å–ª—è—é—Ç—Å—è –ø–æ –∑–∞–¥–∞–Ω–Ω—ã–º –ø—Ä–∞–≤–∏–ª–∞–º –∏–ª–∏ —Ñ–æ—Ä–º—É–ª–µ, –∞ –Ω–µ –∑–∞–¥–∞—é—Ç—Å—è –≤—Ä—É—á–Ω—É—é. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –º–∞—Ç—Ä–∏—Ü—ã –ª—é–±–æ–π —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏, –æ—Å–æ–±–µ–Ω–Ω–æ –≤ —Å–ª—É—á–∞—è—Ö, –∫–æ–≥–¥–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–¥—á–∏–Ω—è–µ—Ç—Å—è –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–º—É –∑–∞–∫–æ–Ω—É –∏–ª–∏ —Å—Ö–µ–º–µ.

##### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü ‚Äî —ç—Ç–æ —Å–ø–æ—Å–æ–± –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –º–∞—Ç—Ä–∏—Ü—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∑–∞–¥–∞–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä–∞—è –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∏–Ω–¥–µ–∫—Å–æ–≤ —Å—Ç—Ä–æ–∫–∏ –∏ —Å—Ç–æ–ª–±—Ü–∞. –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –º–∞—Ç—Ä–∏—Ü—ã –≤—ã—á–∏—Å–ª—è—é—Ç—Å—è –ø–æ –µ–¥–∏–Ω–æ–π —Ñ–æ—Ä–º—É–ª–µ $ùëé_{ùëñùëó}$ = ùëì(ùëñ,ùëó), –≥–¥–µ f ‚Äî –∑–∞–¥–∞–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è, –∞ i –∏ j ‚Äî –∏–Ω–¥–µ–∫—Å—ã —Å—Ç—Ä–æ–∫–∏ –∏ —Å—Ç–æ–ª–±—Ü–∞.

##### –≠—Ä–º–∏—Ç–æ–≤–∞ –º–∞—Ç—Ä–∏—Ü–∞ ‚Äî —ç—Ç–æ –∫–≤–∞–¥—Ä–∞—Ç–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ A, –∫–æ—Ç–æ—Ä–∞—è —Ä–∞–≤–Ω–∞ —Å–≤–æ–µ–º—É —Å–æ–ø—Ä—è–∂—ë–Ω–Ω–æ–º—É —Ç—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–º—É –≤–∏–¥—É. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —ç–ª–µ–º–µ–Ω—Ç—ã –º–∞—Ç—Ä–∏—Ü—ã —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è—é—Ç —Å–ª–µ–¥—É—é—â–µ–º—É —É—Å–ª–æ–≤–∏—é: ùê¥ = $ùê¥^‚àó$ 

##### –ò–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ ‚Äî —ç—Ç–æ –º–µ—Ç–æ–¥ —á–∏—Å–ª–µ–Ω–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –ø—Ä–∏ —Ä–µ—à–µ–Ω–∏–∏ –∑–∞–¥–∞—á —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π. –û–Ω–æ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–∏ –º–∞—Ç—Ä–∏—Ü—ã –∑–∞–¥–∞—á–∏ —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —á—Ç–æ–±—ã —É—Å–∫–æ—Ä–∏—Ç—å —Å—Ö–æ–¥–∏–º–æ—Å—Ç—å –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Ç–µ—Ö, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤–±–ª–∏–∑–∏ –∑–∞–¥–∞–Ω–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è (—Å–¥–≤–∏–≥–∞).

–ü—Ä–∏–º–µ—Ä—ã –Ω–µ—è–≤–Ω—ã—Ö –º–∞—Ç—Ä–∏—Ü: 
1. –†–∞–∑—Ä–µ–∂–µ–Ω–Ω—ã–µ –º–∞—Ç—Ä–∏—Ü—ã
–†–∞–∑—Ä–µ–∂–µ–Ω–Ω—ã–µ –º–∞—Ç—Ä–∏—Ü—ã - —Ç–∞–∫–∏–µ, —É –∫–æ—Ç–æ—Ä—ã—Ö –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Ä–∞–≤–Ω—ã –Ω—É–ª—é. –í–º–µ—Å—Ç–æ —Ç–æ–≥–æ —á—Ç–æ–±—ã —Ö—Ä–∞–Ω–∏—Ç—å –≤—Å—é –º–∞—Ç—Ä–∏—Ü—É —Ü–µ–ª–∏–∫–æ–º, –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö, —Ç–∞–∫–∏–µ –∫–∞–∫ —Å–ø–∏—Å–∫–∏ —Å–º–µ–∂–Ω–æ—Å—Ç–µ–π –∏–ª–∏ —Ñ–æ—Ä–º–∞—Ç COO (–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç), –∫–æ—Ç–æ—Ä—ã–µ —Ö—Ä–∞–Ω—è—Ç —Ç–æ–ª—å–∫–æ –Ω–µ–Ω—É–ª–µ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –≤–º–µ—Å—Ç–µ —Å –∏—Ö –∏–Ω–¥–µ–∫—Å–∞–º–∏. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –º–∞—Ç—Ä–∏—Ü–∞ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–µ—è–≤–Ω–æ–π, –ø–æ—Å–∫–æ–ª—å–∫—É –±–æ–ª—å—à–∞—è —á–∞—Å—Ç—å –µ—ë –¥–∞–Ω–Ω—ã—Ö –Ω–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è —è–≤–Ω–æ.

2. –ö–≤–∞–Ω—Ç–æ–≤–∞–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü 
–ù–µ–∫–æ—Ç–æ—Ä—ã–µ –º–µ—Ç–æ–¥—ã –∫–≤–∞–Ω—Ç–æ–≤–∞–Ω–∏—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç –º–∞—Ç—Ä–∏—Ü—ã –≤ —Å–∂–∞—Ç–æ–º –≤–∏–¥–µ, –∏—Å–ø–æ–ª—å–∑—É—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∏—Ç –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —É–º–µ–Ω—å—à–∏—Ç—å —Ä–∞–∑–º–µ—Ä –º–∞—Ç—Ä–∏—Ü—ã –∑–∞ —Å—á—ë—Ç —Ç–æ—á–Ω–æ—Å—Ç–∏, –∏ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –º—ã –ø–æ–ª—É—á–∞–µ–º –Ω–µ—è–≤–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü—ã.

3. –ê–ª–≥–æ—Ä–∏—Ç–º–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü.
–ò–Ω–æ–≥–¥–∞ –º–∞—Ç—Ä–∏—Ü—ã –º–æ–≥—É—Ç –∑–∞–¥–∞–≤–∞—Ç—å—Å—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç —ç–ª–µ–º–µ–Ω—Ç—ã –ø–æ –º–µ—Ä–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏. –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –º–∞—Ç—Ä–∏—Ü–∞ —è–≤–ª—è–µ—Ç—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –Ω–µ–∫–æ—Ç–æ—Ä–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞, –µ—ë —ç–ª–µ–º–µ–Ω—Ç—ã –º–æ–≥—É—Ç –≤—ã—á–∏—Å–ª—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏, –∞ –Ω–µ —Ö—Ä–∞–Ω–∏—Ç—å—Å—è –≤ –ø–∞–º—è—Ç–∏ –∑–∞—Ä–∞–Ω–µ–µ.

4. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —ç–ª–µ–º–µ–Ω—Ç–æ–≤.
–í –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–ª—É—á–∞—è—Ö —ç–ª–µ–º–µ–Ω—Ç—ã –º–∞—Ç—Ä–∏—Ü—ã –º–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–µ–π, –∫–æ—Ç–æ—Ä–∞—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ –ø–æ –µ–≥–æ –∏–Ω–¥–µ–∫—Å—É. –¢–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ –æ—Å–æ–±–µ–Ω–Ω–æ –ø–æ–ª–µ–∑–µ–Ω, –∫–æ–≥–¥–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –æ—á–µ–Ω—å –±–æ–ª—å—à–∏–º–∏ –º–∞—Ç—Ä–∏—Ü–∞–º–∏ –∏–ª–∏ —Å –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–º–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—è–º–∏.

–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–µ—è–≤–Ω–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –º–∞—Ç—Ä–∏—Ü:
 - –≠–∫–æ–Ω–æ–º–∏—è –ø–∞–º—è—Ç–∏: –î–ª—è –±–æ–ª—å—à–∏—Ö –º–∞—Ç—Ä–∏—Ü —Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤, —Ç–æ–≥–¥–∞ –∫–∞–∫ –Ω–µ—è–≤–Ω–∞—è —Ñ–æ—Ä–º–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–∑–±–µ–∂–∞—Ç—å —ç—Ç–æ–≥–æ.
 - –ë–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π: –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–∞–¥ –º–∞—Ç—Ä–∏—Ü–∞–º–∏ –º–æ–≥—É—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –±—ã—Å—Ç—Ä–µ–µ, –µ—Å–ª–∏ –æ–Ω–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü–∏–∏, –∞ –Ω–µ —á–µ—Ä–µ–∑ –ø—Ä—è–º–æ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ –∫–∞–∂–¥–æ–º—É —ç–ª–µ–º–µ–Ω—Ç—É.
 - –£–ø—Ä–æ—â–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã: –í –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–ª—É—á–∞—è—Ö —Ä–∞–±–æ—Ç–∞ —Å –Ω–µ—è–≤–Ω—ã–º–∏ –º–∞—Ç—Ä–∏—Ü–∞–º–∏ —É–ø—Ä–æ—â–∞–µ—Ç –∫–æ–¥ –∏ –¥–µ–ª–∞–µ—Ç –µ–≥–æ –±–æ–ª–µ–µ –ø–æ–Ω—è—Ç–Ω—ã–º.

–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:
 - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –≤–∏–¥—ã –æ–ø–µ—Ä–∞—Ü–∏–π: –ù–µ –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –º–æ–∂–Ω–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å —Å –Ω–µ—è–≤–Ω–æ –∑–∞–¥–∞–Ω–Ω—ã–º–∏ –º–∞—Ç—Ä–∏—Ü–∞–º–∏. –ù–∞–ø—Ä–∏–º–µ—Ä, —Å–ª–æ–∂–µ–Ω–∏–µ –¥–≤—É—Ö –Ω–µ—è–≤–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö –º–∞—Ç—Ä–∏—Ü –º–æ–∂–µ—Ç —Ç—Ä–µ–±–æ–≤–∞—Ç—å –∏—Ö –ø–æ–ª–Ω–æ–≥–æ —Ä–∞—Å–∫—Ä—ã—Ç–∏—è.
 - –°–ª–æ–∂–Ω–æ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: –†–∞–±–æ—Ç–∞ —Å –Ω–µ—è–≤–Ω—ã–º –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ–º —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —É—Å–∏–ª–∏–π –ø—Ä–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤.

## –û–ø–∏—Å–∞–Ω–∏–µ

SLEPc –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –º–∞—Ç—Ä–∏—Ü—ã, –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö —á–∏—Å–µ–ª –∏ —Å–æ–∑–¥–∞–Ω–∏—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π –∞–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏–∏. –≠—Ç–æ—Ç –ø–æ–¥—Ö–æ–¥ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ —Å–æ–∫—Ä–∞—â–∞—Ç—å —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö, —Å–æ—Ö—Ä–∞–Ω—è—è –ø—Ä–∏ —ç—Ç–æ–º –æ—Å–Ω–æ–≤–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, —á—Ç–æ –¥–µ–ª–∞–µ—Ç SLEPc –ø–æ–ª–µ–∑–Ω—ã–º –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –æ–±–ª–∞—Å—Ç—è—Ö –Ω–∞—É–∫–∏ –∏ —Ç–µ—Ö–Ω–∏–∫–∏.

–ó–∞–¥–∞—á–∞ —Ä–µ—à–∞–µ—Ç—Å—è –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ –¥–ª—è –≥–∏–ø–µ—Ä–±–æ–ª–∏—á–µ—Å–∫–æ–≥–æ –∏ –æ–±–æ–±—â–µ–Ω–Ω–≥–æ —Ç–∏–ø–æ–≤. –ß—Ç–æ –¥–∞–µ—Ç –Ω–∞–º –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Ñ–æ—Ä–º—É–ª–æ–π:

$\sigma = \sqrt{|\lambda|}$, –≥–¥–µ $\lambda$ - —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∫—Ä–æ—Å—Å-–º–∞—Ç—Ä–∏—Ü—ã, $\sigma$ - —Å–∏–Ω–≥—è–ª—É—Ä–Ω–æ–µ —Å–æ–æ—Ç–≤–µ—Å—Ç–≤—É—é—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ.

–í –±–∏–±–ª–∏–æ—Ç–µ–∫–µ SLEPc —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –¥–ª—è –ø–æ–∏—Å–∫–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π —Ç–∞–∫–∏–µ –º–µ—Ç–æ–¥—ã, –∫–∞–∫:
1. Power Iteration (power):
- –ü—Ä–æ—Å—Ç–æ–π –º–µ—Ç–æ–¥ –¥–ª—è –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è –Ω–∞–∏–±–æ–ª—å—à–µ–≥–æ –ø–æ –º–æ–¥—É–ª—é —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è.
- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω –¥–ª—è –∑–∞–¥–∞—á —Å —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω—ã–º–∏ –º–∞—Ç—Ä–∏—Ü–∞–º–∏, –≥–¥–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ.\ 
2. Subspace Iteration (subspace)
- –ú–µ—Ç–æ–¥, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–π –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –¥–ª—è –ø–æ–¥–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞, —á—Ç–æ–±—ã –≤—ã–¥–µ–ª–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.
- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω –¥–ª—è –∑–∞–¥–∞—á, –≥–¥–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –≤–µ—Ä—Ö–Ω—è—è —á–∞—Å—Ç—å —Å–ø–µ–∫—Ç—Ä–∞.\
–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
- –ü—Ä–æ—Å—Ç–æ–π –∏ –Ω–∞–¥–µ–∂–Ω—ã–π –º–µ—Ç–æ–¥.
- –ú–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–Ω–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–º –¥–ª—è –∑–∞–¥–∞—á —Å —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω—ã–º–∏ –º–∞—Ç—Ä–∏—Ü–∞–º–∏.\
3. Arnoldi (arnoldi):
- –ú–µ—Ç–æ–¥, –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–π Lanczos, –Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –Ω–µ—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã—Ö –∑–∞–¥–∞—á.
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –æ—Ä—Ç–æ–≥–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –ø–æ–¥–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –ö—Ä—ã–ª–æ–≤–∞.\
–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
- –£–Ω–∏–≤–µ—Ä—Å–∞–ª–µ–Ω –∏ –ø—Ä–∏–º–µ–Ω–∏–º –¥–ª—è —à–∏—Ä–æ–∫–æ–≥–æ –∫–ª–∞—Å—Å–∞ –∑–∞–¥–∞—á.
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç —Å–∏–º–º–µ—Ç—Ä–∏–∏ –º–∞—Ç—Ä–∏—Ü—ã.\
4.Lanczos (lanczos):
- –•–æ—Ä–æ—à–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã—Ö –∑–∞–¥–∞—á.
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç—Ä–∏–¥–∏–∞–≥–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—é –º–∞—Ç—Ä–∏—Ü—ã, —á—Ç–æ —É–ø—Ä–æ—â–∞–µ—Ç –≤—ã—á–∏—Å–ª–µ–Ω–∏—è.\
–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω –¥–ª—è —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã—Ö –∑–∞–¥–∞—á.\
5. Krylov-Schur (krylovschur):
- –û—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥ –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π, –æ—Å–æ–±–µ–Ω–Ω–æ —Ö–æ—Ä–æ—à–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –ø–æ–∏—Å–∫–∞ –Ω–µ–±–æ–ª—å—à–æ–π —á–∞—Å—Ç–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.
- –û—Å–Ω–æ–≤–∞–Ω –Ω–∞ –º–µ—Ç–æ–¥–µ –ö—Ä—ã–ª–æ–≤–∞ –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ—Ä—Ç–æ–≥–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—é –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –ø–æ–¥–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞.
- –•–æ—Ä–æ—à–æ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è –≤ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏—è—Ö.\
–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
- –í—ã–±–æ—Ä —á–∏—Å–ª–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã—Ö —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.
- –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –∑–∞–¥–∞—á —Å –ø–ª–æ—Ç–Ω–æ–π –º–∞—Ç—Ä–∏—Ü–µ–π –∏–ª–∏ –º–∞—Ç—Ä–∏—Ü–µ–π —Å—Ä–µ–¥–Ω–µ–≥–æ —Ä–∞–∑–º–µ—Ä–∞.
6. Jacobi-Davidson (jd):
- –ò—Ç–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –º–µ—Ç–æ–¥, –∫–æ—Ç–æ—Ä—ã–π —Å–æ—á–µ—Ç–∞–µ—Ç –º–µ—Ç–æ–¥ –î—ç–≤–∏–¥—Å–æ–Ω–∞ —Å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º —Ä–µ—à–∞—Ç–µ–ª–µ–º –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏ –ø–æ–¥–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞.
- –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –∑–∞–¥–∞—á —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π, —Ç–∞–∫–∏–º–∏ –∫–∞–∫ –±–ª–∏–∂–∞–π—à–∏–µ –∫ –∑–∞–¥–∞–Ω–Ω–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é.\
–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
- –ì–∏–±–∫–æ—Å—Ç—å –∑–∞ —Å—á–µ—Ç –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —Ä–µ—à–∞—Ç–µ–ª—è.
- –¢—Ä–µ–±—É–µ—Ç –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.

**–í—ã–±–æ—Ä –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –º–µ—Ç–æ–¥–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–ø–µ—Ü–∏—Ñ–∏–∫–∏ –∑–∞–¥–∞—á–∏ –∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ —Ç–æ—á–Ω–æ—Å—Ç–∏.**

–ü–∞—Ä–∞–º–µ—Ç—Ä **swapped** –≤ SLEPc –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, –∫–æ–≥–¥–∞ —Ä–µ—à–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –±—ã–ª–æ –ø–æ–ª—É—á–µ–Ω–æ —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —á—Ç–æ –º–∞—Ç—Ä–∏—Ü—ã –±—ã–ª–∏ —Ä–µ—à–µ–Ω—ã –≤ –ø–æ—Ä—è–¥–∫–µ, –æ—Ç–ª–∏—á–∞—é—â–µ–º—Å—è –æ—Ç —Ç–æ–≥–æ, –∫–∞–∫–æ–π –ø–æ—Ä—è–¥–æ–∫ –æ–∂–∏–¥–∞–ª—Å—è –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ. –≠—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–æ–∏–∑–æ–π—Ç–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ —Ä–µ—à–µ–Ω–∏–µ –±—ã–ª–æ –Ω–∞–π–¥–µ–Ω–æ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–µ—Ç–æ–¥–∞, –∫–æ—Ç–æ—Ä—ã–π —Ä–µ—à–∞–µ—Ç –∑–∞–¥–∞—á—É –¥–ª—è –æ–¥–Ω–æ–≥–æ –ø–æ—Ä—è–¥–∫–∞ –º–∞—Ç—Ä–∏—Ü, —Ç–æ–≥–¥–∞ –∫–∞–∫ –æ–∂–∏–¥–∞–µ—Ç—Å—è –¥—Ä—É–≥–æ–π –ø–æ—Ä—è–¥–æ–∫.

## 2. –û–ø–∏—Å–∞–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–∞. 
### –ó–¥–µ—Å—å –º—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º 2 –∞–ª–≥–æ—Ä–∏—Ç–º–∞-—Ñ—É–Ω–∫—Ü–∏–∏: 

### –§—É–Ω–∫—Ü–∏—è SVDSolve_Cross - —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –Ω–∞—Ö–æ–¥–∏—Ç —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è. 
–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É SVD svd, —Å–æ–¥–µ—Ä–∂–∞—â—É—é –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.\
–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ SVD svd.

1. –í–Ω–∞—á–∞–ª–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –∫—Ä–æ—Å—Å –º–∞—Ç—Ä–∏—Ü—ã –æ–¥–Ω–∏–º –∏–∑ –≤—ã—à–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤. –¢–∞–∫ –∂–µ –ø–æ–ª—É—á–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ö–æ–¥—è—â–∏—Ö—Å—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π (nconv), –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –∏—Ç–µ—Ä–∞—Ü–∏–π (its) –∏ –ø—Ä–∏—á–∏–Ω—É —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏ (reason).
2. –ó–∞—Ç–µ–º –ø—Ä–æ—Ö–æ–¥—è—Å—å –ø–æ –∫–∞–∂–¥–æ–º—É —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–º—É —á–∏—Å–ª—É. –ú—ã –±–µ—Ä–µ–º —Ç–æ–ª—å–∫–æ –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω—É—é —á–∞—Å—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —á–∏—Å–ª–∞.
3. –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –ª–∏ –Ω–∞—à–∞ –∑–∞–¥–∞—á–∞ –∫ –≥–∏–ø–µ—Ä–±–æ–ª–∏—á–µ—Å–∫–æ–º—É —Ç–∏–ø—É, –µ—Å–ª–∏ –¥–∞ —Ç–æ $\sigma = \sqrt{|\sigma|}$.
4. –ï—Å–ª–∏ –Ω–µ—Ç, —Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –±–æ–ª—å—à–µ –ª–∏ $\sigma>-10* \epsilon$, –≥–¥–µ $\epsilon$ –º–∞—à–∏–Ω–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å. –ò –≤—ã–¥–∞–µ—Ç—Å—è –ø—Ä–∏–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ–± —ç—Ç–æ–º.
5. –ó–∞—Ç–µ–º –µ—Å–ª–∏ $\sigma<0.0$ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤–æ, —Ç–æ $\sigma = 0.0$
6. –î–∞–ª–µ–µ, –±–µ—Ä–µ—Ç—Å—è –∫–æ—Ä–µ–Ω—å –∏–∑ –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω–æ —á–∞—Å—Ç–∏ $\sigma = \sqrt{\sigma}$

```
static PetscErrorCode SVDSolve_Cross(SVD svd)
{
  SVD_CROSS      *cross = (SVD_CROSS*)svd->data;
  PetscInt       i;
  PetscScalar    lambda;
  PetscReal      sigma;
  PetscFunctionBegin;
  PetscCall(EPSSolve(cross->eps));
  PetscCall(EPSGetConverged(cross->eps,&svd->nconv));
  PetscCall(EPSGetIterationNumber(cross->eps,&svd->its));
  PetscCall(EPSGetConvergedReason(cross->eps,(EPSConvergedReason*)&svd->reason));
  for (i=0;i<svd->nconv;i++) {
    PetscCall(EPSGetEigenvalue(cross->eps,i,&lambda,NULL));
    sigma = PetscRealPart(lambda);
    if (svd->ishyperbolic) svd->sigma[i] = PetscSqrtReal(PetscAbsReal(sigma));
    else {
      PetscCheck(sigma>-10*PETSC_MACHINE_EPSILON,PetscObjectComm((PetscObject)svd),PETSC_ERR_FP,"Negative eigenvalue computed by EPS: %g",(double)sigma);
      if (sigma<0.0) {
        PetscCall(PetscInfo(svd,"Negative eigenvalue computed by EPS: %g, resetting to 0\n",(double)sigma));
        sigma = 0.0;
      }
      svd->sigma[i] = PetscSqrtReal(sigma);
    }
  }
  PetscFunctionReturn(PETSC_SUCCESS);
}
```

### –§—É–Ω–∫—Ü–∏—è SVDComputeVectors_Cross(SVD svd) - –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤ –¥–ª—è –æ–±–æ–±—â—ë–Ω–Ω—ã—Ö –∑–∞–¥–∞—á, –≥–∏–ø–µ—Ä–±–æ–ª–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏ –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∑–∞–¥–∞—á–∏, –≤–æ–∑–Ω–∏–∫–∞—é—â–∏–µ –≤ —Ä–∞–º–∫–∞—Ö –º–µ—Ç–æ–¥–∞ —Å–∏–Ω–≥—É–ª—è—Ä–Ω–æ–≥–æ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏—è.

–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É SVD svd, —Å–æ–¥–µ—Ä–∂–∞—â—É—é –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤.\
–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ SVD svd.

##### 1. –ï—Å–ª–∏ –∑–∞–¥–∞—á–∞ —Å—Ç–∞–≤–∏—Ç—Å—è –æ–±—â–∞—è –∑–∞–¥–∞—á–∞, —Ç–æ:
- —Å–æ–∑–¥–∞—é—Ç—Å—è 2 –≤–µ–∫—Ç–æ—Ä–∞ –Ω—É–∂–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–¥ –º–∞—Ç–∏—Ä—Ü—ã A, B
- –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è: –ò–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è i-–π —Å—Ç–æ–ª–±–µ—Ü –∏–∑ –º–∞—Ç—Ä–∏—Ü—ã V, —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ x –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–µ –µ–º—É —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ lambda. –ó–∞—Ç–µ–º –≤—ã–ø–æ–ª–Ω—è–µ–º —Ä–∞–≤–µ–Ω—Å—Ç–≤–∞ u = A * x. v = B * x.
- –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä—ã u, v.
- –í—ã—á–∏—Å–ª—è–µ–º –°–∫–∞–ª—è—Ä alpha –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è –º–µ–∂–¥—É —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –∏ –Ω–æ—Ä–º–∞–º–∏ –≤–µ–∫—Ç–æ—Ä–æ–≤.
- –°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –≤–µ–∫—Ç–æ—Ä x –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –≤–µ–ª–∏—á–∏–Ω—É alpha.
- –í–µ–∫—Ç–æ—Ä x –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –æ–±—Ä–∞—Ç–Ω–æ –≤ –º–∞—Ç—Ä–∏—Ü—É V
- –î–∞–ª–µ–µ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –≤–µ–∫—Ç–æ—Ä uv = (u,v), –∫–æ—Ç–æ—Ä—ã–π —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤ u, v –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —à–∞–≥–∞—Ö. –û—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç—Å—è –ø–∞–º—è—Ç—å –æ—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö.
##### 2. –ï—Å–ª–∏ –∑–∞–¥–∞—á–∞ –≥–∏–ø–µ—Ä–±–æ–ª–∏—á–µ—Å–∫–æ–≥–æ —Ç–∏–ø–∞, Swapped = true, 
- —Ç–æ –ø–æ–ª—É—á–∞–µ–º –æ–ø–µ—Ä–∞—Ç–æ—Ä Omega –∏–∑ EPS, —Å–æ–∑–¥–∞–µ—Ç—Å—è –≤–µ–∫—Ç–æ—Ä w –ø–æ–¥—Ö–æ–¥—è—â–µ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –¥–ª—è –º–∞—Ç—Ä–∏—Ü—ã Omega, –Ω–æ–≤—ã–π –≤–µ–∫—Ç–æ—Ä –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–∏–≥–Ω–∞—Ç—É—Ä—ã.
- –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –≤–µ–∫—Ç–æ—Ä–∞: –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ i-–≥–æ —Å—Ç–æ–ª–±—Ü–∞ –∏–∑ –º–∞—Ç—Ä–∏—Ü—ã V –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –Ω–µ–≥–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –≤–µ–∫—Ç–æ—Ä. 
- –£–º–Ω–æ–∂–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü—ã Omega –Ω–∞ –≤–µ–∫—Ç–æ—Ä v, —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ w
- –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å–∫–∞–ª—è—Ä–Ω–æ–≥–æ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –≤–µ–∫—Ç–æ—Ä–æ–≤ v –∏ w, —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤ alpha.
- –í—ã—á–∏—Å–ª—è–µ—Ç—Å—è —Å–∏–≥–Ω–∞—Ç—É—Ä–∞ –æ—Ç –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–π —á–∞—Å—Ç–∏ alpha.
- –ó–∞—Ç–µ–º $\alpha = \frac{1}{\sqrt{|\alpha|}}$
- –í–µ–∫—Ç–æ—Ä w –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è —Å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–º alpha, —á—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –Ω–æ—Ä–º—É. –ò –∫–æ–ø–∏—Ä—É–µ—Ç—Å—è –≤ –≤–µ–∫—Ç–æ—Ä v.
- –ó–Ω–∞—á–µ–Ω–∏–µ —Å–∏–≥–Ω–∞—Ç—É—Ä—ã —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –≤–µ–∫—Ç–æ—Ä–µ omega2, –∞ –∏–Ω–¥–µ–∫—Å –≤–µ–∫—Ç–æ—Ä–∞ –≤ –º–∞—Å—Å–∏–≤–µ varray –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è.
- –ü—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è –≤–µ–∫—Ç–æ—Ä–æ–≤ —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏ SVDComputeVectors_Left
##### 3. –ï—Å–ª–∏ –∑–∞–¥–∞—á–∞ –Ω–µ–≥–∏–ø–µ—Ä–±–æ–ª–∏—á–µ—Å–∫–æ–≥–æ —Ç–∏–ø–∞, Swapped = false,
- –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –≤–µ–∫—Ç–æ—Ä–∞: –ò–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è i-–π —Å—Ç–æ–ª–±–µ—Ü –∏–∑ –º–∞—Ç—Ä–∏—Ü—ã V –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ v.
- –ò–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è i-–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –≤–µ–∫—Ç–æ—Ä –∏–∑ –æ–±—ä–µ–∫—Ç–∞ EPS –∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ v.
- –í–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ –≤–µ–∫—Ç–æ—Ä–∞ v –æ–±—Ä–∞—Ç–Ω–æ –≤ –º–∞—Ç—Ä–∏—Ü—É V
- –í—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –ª–µ–≤—ã—Ö —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤.
```
static PetscErrorCode SVDComputeVectors_Cross(SVD svd)
{
  SVD_CROSS         *cross = (SVD_CROSS*)svd->data;
  PetscInt          i,mloc,ploc;
  Vec               u,v,x,uv,w,omega2=NULL;
  Mat               Omega;
  PetscScalar       *dst,alpha,lambda,*varray;
  const PetscScalar *src;
  PetscReal         nrm;
  PetscFunctionBegin;
  if (svd->isgeneralized) {
    PetscCall(MatCreateVecs(svd->A,NULL,&u));
    PetscCall(VecGetLocalSize(u,&mloc));
    PetscCall(MatCreateVecs(svd->B,NULL,&v));
    PetscCall(VecGetLocalSize(v,&ploc));
    for (i=0;i<svd->nconv;i++) {
      PetscCall(BVGetColumn(svd->V,i,&x));
      PetscCall(EPSGetEigenpair(cross->eps,i,&lambda,NULL,x,NULL));
      PetscCall(MatMult(svd->A,x,u));     /* u_i*c_i/alpha = A*x_i */
      PetscCall(VecNormalize(u,NULL));
      PetscCall(MatMult(svd->B,x,v));     /* v_i*s_i/alpha = B*x_i */
      PetscCall(VecNormalize(v,&nrm));    /* ||v||_2 = s_i/alpha   */
      alpha = 1.0/(PetscSqrtReal(1.0+PetscRealPart(lambda))*nrm);    /* alpha=s_i/||v||_2 */
      PetscCall(VecScale(x,alpha));
      PetscCall(BVRestoreColumn(svd->V,i,&x));
      /* copy [u;v] to U[i] */
      PetscCall(BVGetColumn(svd->U,i,&uv));
      PetscCall(VecGetArrayWrite(uv,&dst));
      PetscCall(VecGetArrayRead(u,&src));
      PetscCall(PetscArraycpy(dst,src,mloc));
      PetscCall(VecRestoreArrayRead(u,&src));
      PetscCall(VecGetArrayRead(v,&src));
      PetscCall(PetscArraycpy(dst+mloc,src,ploc));
      PetscCall(VecRestoreArrayRead(v,&src));
      PetscCall(VecRestoreArrayWrite(uv,&dst));
      PetscCall(BVRestoreColumn(svd->U,i,&uv));
    }
    PetscCall(VecDestroy(&v));
    PetscCall(VecDestroy(&u));
  } else if (svd->ishyperbolic && svd->swapped) {  /* was solved as GHIEP, set u=Omega*u and normalize */
    PetscCall(EPSGetOperators(cross->eps,NULL,&Omega));
    PetscCall(MatCreateVecs(Omega,&w,NULL));
    PetscCall(VecCreateSeq(PETSC_COMM_SELF,svd->ncv,&omega2));
    PetscCall(VecGetArrayWrite(omega2,&varray));
    for (i=0;i<svd->nconv;i++) {
      PetscCall(BVGetColumn(svd->V,i,&v));
      PetscCall(EPSGetEigenvector(cross->eps,i,v,NULL));
      PetscCall(MatMult(Omega,v,w));
      PetscCall(VecDot(v,w,&alpha));
      svd->sign[i] = PetscSign(PetscRealPart(alpha));
      varray[i] = svd->sign[i];
      alpha = 1.0/PetscSqrtScalar(PetscAbsScalar(alpha));
      PetscCall(VecScale(w,alpha));
      PetscCall(VecCopy(w,v));
      PetscCall(BVRestoreColumn(svd->V,i,&v));
    }
    PetscCall(BVSetSignature(svd->V,omega2));
    PetscCall(VecRestoreArrayWrite(omega2,&varray));
    PetscCall(VecDestroy(&omega2));
    PetscCall(VecDestroy(&w));
    PetscCall(SVDComputeVectors_Left(svd));
  } else {
    for (i=0;i<svd->nconv;i++) {
      PetscCall(BVGetColumn(svd->V,i,&v));
      PetscCall(EPSGetEigenvector(cross->eps,i,v,NULL));
      PetscCall(BVRestoreColumn(svd->V,i,&v));
    }
    PetscCall(SVDComputeVectors_Left(svd));
  }
  PetscFunctionReturn(PETSC_SUCCESS);
}
```

## 3. –ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è.

#### –ò–º–ø–æ—Ä—Ç–∏—Ç—Å—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫:
``` #include <slepc/private/svdimpl.h> ``` 

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ SVD_CROSS [1]
```
typedef struct {
  PetscBool explicitmatrix;
  EPS       eps;
  PetscBool usereps;
  Mat       C,D;
} SVD_CROSS;
```

–ö–æ—Ç–æ—Ä–∞—è —Å–æ—Å—Ç–æ–∏—Ç: 
 - explicitmatrix - –ø–∞—Ä–∞–º–µ—Ç—Ä, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–≤–µ—á–∞–µ—Ç —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –º–∞—Ç—Ä–∏—Ü–∞ —è–≤–Ω–æ–π –∏–ª–∏ –Ω–µ—è–≤–Ω–æ–π, —Ç.–µ. –∑–∞–¥–∞–Ω–∞ –æ–Ω–∞ –≤ —è–≤–Ω–æ–º –≤–∏–¥–µ –∏–ª–∏ –Ω–µ—Ç. –ß—Ç–æ —Ç–∞–∫–æ–µ –Ω–µ—è–≤–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –¥–∞–ª—å—à–µ.
 - eps - –†–µ—à–∞—Ç–µ–ª—å –∑–∞–¥–∞—á –Ω–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (EPS) ‚Äî —ç—Ç–æ –æ—Å–Ω–æ–≤–Ω–æ–π –æ–±—ä–µ–∫—Ç, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º—ã–π slepc. –û–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∑–∞–¥–∞–Ω–∏—è –ª–∏–Ω–µ–π–Ω–æ–π –∑–∞–¥–∞—á–∏ –Ω–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –∏–ª–∏ –æ–±–æ–±—â–µ–Ω–Ω–æ–π —Ñ–æ—Ä–º–µ –∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –µ–¥–∏–Ω—ã–π –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º –ª–∏–Ω–µ–π–Ω—ã–º —Ä–µ—à–∞—Ç–µ–ª—è–º —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π, –≤–∫–ª—é—á–µ–Ω–Ω—ã–º –≤ –ø–∞–∫–µ—Ç. –ö–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω–æ —É—Ä–æ–≤–µ–Ω—å –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏, –∑–∞–Ω–∏–º–∞–µ–º—ã–π EPS, –∞–Ω–∞–ª–æ–≥–∏—á–µ–Ω –¥—Ä—É–≥–∏–º —Ä–µ—à–∞—Ç–µ–ª—è–º –≤ petsc, —Ç–∞–∫–∏–º –∫–∞–∫ KSP, –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –ª–∏–Ω–µ–π–Ω—ã—Ö —Å–∏—Å—Ç–µ–º —É—Ä–∞–≤–Ω–µ–Ω–∏–π. –ú–æ–¥—É–ª—å EPS –≤ slepc –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –º–æ–¥—É–ª—è–º petsc, —Ç–∞–∫–∏–º –∫–∞–∫ KSP. –í—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, —Å–≤—è–∑–∞–Ω–Ω–∞—è —Å –∑–∞–¥–∞—á–µ–π –Ω–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é. –î–æ—Å—Ç—É–ø–Ω—ã –æ–±—ã—á–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞–º–∏ (EPSCreate, EPSDestroy, EPSView, EPSSetFromOptions). –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –æ–±—ä–µ–∫—Ç EPS –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, —Ç–∞–∫–∏—Ö –∫–∞–∫ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã—á–∏—Å–ª—è–µ–º—ã—Ö —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π, —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –ø–æ–¥–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞, —á–∞—Å—Ç—å –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–µ–≥–æ —Å–ø–µ–∫—Ç—Ä–∞, –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã–π –¥–æ–ø—É—Å–∫ –∏–ª–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã—Ö –∏—Ç–µ—Ä–∞—Ü–∏–π. [1]

- usereps - –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è —Ç–∏–ø–∞ bool, –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∫–∞–∫–æ–≥–æ-—Ç–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞.
- C,D - –∫–∞–∫–∏–µ-—Ç–æ –º–∞—Ç—Ä–∏—Ü—ã.


### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ SVD_CROSS_SHELL[1]
```
typedef struct {
  Mat       A,AT;
  Vec       w,diag,omega;
  PetscBool swapped;
} SVD_CROSS_SHELL;
```
–ö–æ—Ç–æ—Ä–∞—è —Å–æ—Å—Ç–æ–∏—Ç –∏–∑: 
- A - –ø—Ä–æ–±–ª–µ–º–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞
- AT - —Ç—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞;
- w -- –≤–µ–∫—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏–∏ –∑–∞–¥–∞—á–∏ —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.,
- diag - –¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –º–∞—Ç—Ä–∏—Ü—ã,
- omega - —Å–∏–≥–Ω–∞—Ç—É—Ä–∞ –¥–ª—è –≥–∏–ø–µ—Ä–±–æ–ª–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞—á;
- swapped - U –∏ V –ø–æ–º–µ–Ω—è–ª–∏—Å—å –º–µ—Å—Ç–∞–º–∏ (M<N). U,V - –ª–µ–≤—ã–π –∏ –ø—Ä–∞–≤—ã–π —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä—ã;

### PetscErrorCode MatMult_Cross - —Ñ—É–Ω–∫—Ü–∏—è –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –Ω–∞ –≤—Ö–æ–¥ –ø—Ä–∏–º–∞–µ—Ç –≤—Ö–æ–¥–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É, –≤—Ö–æ–¥–Ω–æ–π –≤–µ–∫—Ç–æ—Ä, –≤—ã—Ö–æ–¥–Ω–æ–π –≤–µ–∫—Ç–æ—Ä. –ö–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª—è–µ—Ç —É–º–Ω–æ–∂–∏—Ç—å –º–∞—Ç—Ä–∏—Ü—É B –Ω–∞ –≤–µ–∫—Ç–æ—Ä x.

–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: –ú–∞—Ç—Ä–∏—Ü–∞ B –∏ –≤–µ–∫—Ç–æ—Ä x.\
–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: –í–µ–∫—Ç–æ—Ä $y = B*x$

```
static  PetscErrorCode MatMult_Cross(Mat B,Vec x,Vec y)
{
  SVD_CROSS_SHELL *ctx; 
  
  PetscFunctionBegin;
  PetscCall(MatShellGetContext(B,&ctx));
  PetscCall(MatMult(ctx->A,x,ctx->w));
  if (ctx->omega && !ctx->swapped) PetscCall(VecPointwiseMult(ctx->w,ctx->w,ctx->omega));
  PetscCall(MatMult(ctx->AT,ctx->w,y));
  PetscFunctionReturn(PETSC_SUCCESS);
}
```
 
### –§—É–Ω–∫—Ü–∏—è MatGetDiagonal_Cross, –∫–æ—Ç–æ—Ä–∞—è –≤—ã—á–∏—Å–ª—è–µ—Ç –¥–∏–∞–≥–æ–Ω–∞–ª—å –º–∞—Ç—Ä–∏—Ü—ã –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –µ—ë –≤ –≤–µ–∫—Ç–æ—Ä. Mat B - –≤—Ö–æ–¥–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞, –≤—ã—Ö–æ–¥–Ω–æ–π –≤–µ–∫—Ç–æ—Ä d (–¥–∏–∞–≥–æ–Ω–∞–ª—å –º–∞—Ç—Ä–∏—Ü—ã)

–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: –º–∞—Ç—Ä–∏—Ü–∞ B.\
–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: –≤–µ–∫—Ç–æ—Ä d, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –¥–∏–∞–≥–æ–Ω–∞–ª—å –º–∞—Ç—Ä–∏—Ü—ã B.


1. –û–±—ä—è–≤–ª–µ–Ω–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤: 
2.
```
PetscCall(MatShellGetContext(B,&ctx))
``` 
–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç, —Å–≤—è–∑–∞–Ω–Ω—ã–π —Å –º–∞—Ç—Ä–∏—Ü–µ–π –æ–±–æ–ª–æ—á–∫–∏ MATSHELL. –í—Ö–æ–¥–Ω–æ–π –ø–∞—Ä–∞–º–µ—Ç—Ä: B - –º–∞—Ç—Ä–∏—Ü–∞, –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å–æ–∑–¥–∞–Ω–∞ —Å –ø–æ–º–æ—â—å—é MatCreateShell() –í—ã—Ö–æ–¥–Ω–æ–π –ø–∞—Ä–∞–º–µ—Ç—Ä: ctx - –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç.
3.
```
if (!ctx->diag) 
``` 
–ü—Ä–æ–≤–µ—Ä—è–µ–º –µ—Å—Ç—å –ª–∏ –≤—ã—á–∏—Å–ª–µ–Ω–Ω–∞—è –¥–∏–∞–≥–æ–Ω–∞–ª—å –º–∞—Ç—Ä–∏—Ü—ã –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ. –¢–æ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ø—É–Ω–∫—Ç 4-6.
4.1
```
PetscCall(VecDuplicate(d,&ctx->diag));
``` 
 –°–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π –≤–µ–∫—Ç–æ—Ä —Ç–æ–≥–æ –∂–µ —Ç–∏–ø–∞, —á—Ç–æ –∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –≤–µ–∫—Ç–æ—Ä.
4.2
```
    PetscCall(MatGetSize(ctx->A,NULL,&N));
``` 
–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç–æ–ª–±—Ü–æ–≤ –≤ –º–∞—Ç—Ä–∏—Ü–µ.
4.3 
```
PetscCall(MatGetLocalSize(ctx->A,NULL,&n)); 
``` 
–ü–æ–ª—É—á–∞–µ—Ç —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –º–∞—Ç—Ä–∏—Ü—ã ctx->A –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π n
4.3 
```
PetscCall(PetscCalloc2(N,&work1,N,&work2)); 
```
–í—ã–¥–µ–ª—è–µ—Ç –ø–∞–º—è—Ç–∏ –¥–ª—è 2 –±–ª–æ–∫–æ–≤ —Ä–∞–∑–º–µ—Ä–∞ .
5) 
```
if (ctx->swapped)
``` 
–≤—ã–±–æ—Ä –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –≤–∑–∞–≤–∏–∑–∏–º–æ—Å—Ç–∏ –æ—Ç swapped.
5.1) 
```
PetscCall(MatGetOwnershipRange(ctx->AT,&start,&end));
``` 
–ó–¥–µ—Å—å –±–µ—Ä–µ—Ç—Å—è —Ç—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞. - –î–ª—è –º–∞—Ç—Ä–∏—Ü, –≤–ª–∞–¥–µ—é—â–∏—Ö –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –ø–æ —Å—Ç—Ä–æ–∫–∞–º, –∏—Å–∫–ª—é—á–∞—è MATELEMENTAL –∏ MATSCALAPACK, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∏–∞–ø–∞–∑–æ–Ω —Å—Ç—Ä–æ–∫ –º–∞—Ç—Ä–∏—Ü—ã, –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—â–∏—Ö —ç—Ç–æ–º—É –ø—Ä–æ—Ü–µ—Å—Å—É MPI.
```
      for (i=start;i<end;i++) {
```
```
PetscCall(MatGetRow(ctx->AT,i,&ncols,NULL,&vals));
``` 
–ü–æ–ª—É—á–∞–µ—Ç —Å—Ç—Ä–æ–∫—É –º–∞—Ç—Ä–∏—Ü—ã.
```
for (j=0;j<ncols;j++) work1[i] += vals[j]*vals[j];
``` 
–î–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏ –º–∞—Ç—Ä–∏—Ü—ã –∏–∑–≤–ª–µ–∫–∞—é—Ç—Å—è –Ω–µ–Ω—É–ª–µ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –∏ –∏—Ö –∏–Ω–¥–µ–∫—Å—ã (–≤ —Å–ª—É—á–∞–µ –æ–±—ã—á–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã), –∑–∞—Ç–µ–º –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç –≤–æ–∑–≤–æ–¥–∏—Ç—Å—è –≤ –∫–≤–∞–¥—Ä–∞—Ç –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∫ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–º—É –∏–Ω–¥–µ–∫—Å—É –≤ —Ä–∞–±–æ—á–µ–º –º–∞—Å—Å–∏–≤–µ work1.
```
PetscCall(MatRestoreRow(ctx->AT,i,&ncols,NULL,&vals));
``` 
–û—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç –ª—é–±–æ–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ, –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–µ MatGetRow()

5.2) –î–µ–ª–∞–µ—Ç—Å—è –≤—Å–µ —Ç–æ–∂–µ —Å–∞–º–æ–µ –∫–∞–∫ –≤ –ø—É–Ω–∫—Ç–µ 5.1) –¢–æ–ª—å–∫–æ –¥–ª—è –æ–±—ã—á–Ω–æ–π –º–∞—Ç—Ä–∏—Ü–∞ A, –∞ –Ω–µ —Ç—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–π.
```
      PetscCall(MatGetOwnershipRange(ctx->A,&start,&end));
      for (i=start;i<end;i++) {
        PetscCall(MatGetRow(ctx->A,i,&ncols,&cols,&vals));
        for (j=0;j<ncols;j++) work1[cols[j]] += vals[j]*vals[j];
        PetscCall(MatRestoreRow(ctx->A,i,&ncols,&cols,&vals));
      }
```
6.1) 
``` 
PetscCall(PetscMPIIntCast(N,&len));
``` 
–ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç MPI_Count, PetscInt, PetscCount –∏–ª–∏ PetscInt64 –≤ PetscMPIInt (–∫–æ—Ç–æ—Ä—ã–π –≤—Å–µ–≥–¥–∞ –∏–º–µ–µ—Ç —Ä–∞–∑–º–µ—Ä 32 –±–∏—Ç–∞), –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ—à–∏–±–∫—É, –µ—Å–ª–∏ PetscMPIInt –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤–µ–ª–∏–∫ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —á–∏—Å–ª–∞.
6.2) 
```
PetscCallMPI(MPIU_Allreduce(work1,work2,len,MPIU_SCALAR,MPIU_SUM,PetscObjectComm((PetscObject)B)));
``` 
–ó–∞–º–µ–Ω–∞ –¥–ª—è MPI_Allreduce(), –∫–æ—Ç–æ—Ä–∞—è (1) –≤—ã–ø–æ–ª–Ω—è–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏–∏ MPIU_INT —Å –æ–¥–Ω–∏–º —Å—á–µ—Ç—á–∏–∫–æ–º –≤ PetscInt64 –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–π —Ü–µ–ª—ã—Ö —á–∏—Å–µ–ª –∏ (2) –ø—ã—Ç–∞–µ—Ç—Å—è –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ª–∏ –≤—ã–∑–æ–≤ –∏–∑ –≤—Å–µ—Ö —Ä–∞–Ω–≥–æ–≤ MPI –≤ –æ–¥–Ω–æ–º –∏ —Ç–æ–º –∂–µ –º–µ—Å—Ç–µ –≤ –∫–æ–¥–µ PETSc. –≠—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å –æ—à–∏–±–∫–∏, –∫–æ–≥–¥–∞ —Ä–∞–∑–Ω—ã–µ —Ä–∞–Ω–≥–∏ MPI —Å–ª–µ–¥—É—é—Ç —Ä–∞–∑–Ω—ã–º –ø—É—Ç—è–º –∫–æ–¥–∞, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –Ω–µ–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–º –∏ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º –≤—ã–∑–æ–≤–∞–º.
```
PetscMPIInt MPIU_Allreduce(void *indata,void *outdata,PetscCount count,MPI_Datatype dtype, MPI_Op op, MPI_Comm comm);
```
–í—Ö–æ–¥–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
a - —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∫—Ä–∞—Ç–∏—Ç—å;
count - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–∞–Ω–Ω—ã—Ö MPI –≤ a –∏ b;
dtype - —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö MPI, –Ω–∞–ø—Ä–∏–º–µ—Ä MPI_INT;
op - –æ–ø–µ—Ä–∞—Ü–∏—è MPI, –Ω–∞–ø—Ä–∏–º–µ—Ä MPI_SUM;
comm - –∫–æ–º–º—É–Ω–∏–∫–∞—Ç–æ—Ä MPI, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –æ–ø–µ—Ä–∞—Ü–∏—è.
–í—ã—Ö–æ–¥–Ω–æ–π –ø–∞—Ä–∞–º–µ—Ç—Ä:
b - —Å–æ–∫—Ä–∞—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è;
6.3) 
```PetscCall(VecGetOwnershipRange(ctx->diag,&start,&end));
``` 
–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∏–∞–ø–∞–∑–æ–Ω –∏–Ω–¥–µ–∫—Å–æ–≤, –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—â–∏—Ö —ç—Ç–æ–º—É –ø—Ä–æ—Ü–µ—Å—Å—É. –í–µ–∫—Ç–æ—Ä —Ä–∞–∑–º–µ—â–∞–µ—Ç—Å—è —Å –ø–µ—Ä–≤—ã–º–∏ n1 —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ –Ω–∞ –ø–µ—Ä–≤–æ–º –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–µ, —Å–ª–µ–¥—É—é—â–∏–º–∏ n2 —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ –Ω–∞ –≤—Ç–æ—Ä–æ–º –∏ —Ç. –¥. –î–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –º–∞–∫–µ—Ç–æ–≤ —ç—Ç–æ—Ç –¥–∏–∞–ø–∞–∑–æ–Ω –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º.
6.4)
```
PetscCall(VecGetArrayWrite(ctx->diag,&diag));
```
–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π –º–∞—Å—Å–∏–≤, –∫–æ—Ç–æ—Ä—ã–π –ë–£–î–ï–¢ —Å–æ–¥–µ—Ä–∂–∞—Ç—å —á–∞—Å—Ç—å –≤–µ–∫—Ç–æ—Ä–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —ç—Ç–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ MPI.
6.5)
```
for (i=start;i<end;i++) diag[i-start] = work2[i];
PetscCall(VecRestoreArrayWrite(ctx->diag,&diag));
``` 
–î–∏–∞–≥–æ–Ω–∞–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –∫–æ–ø–∏—Ä—É—é—Ç—Å—è –∏–∑ –º–∞—Å—Å–∏–≤–∞ work2 –≤ –≤–µ–∫—Ç–æ—Ä ctx->diag.
6.7)
```
PetscCall(PetscFree2(work1,work2));
``` 
–û—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç—Å—è –≤—ã–¥–µ–ª–µ–Ω–Ω–∞—è —Ä–∞–Ω–µ–µ –ø–∞–º—è—Ç—å –¥–ª—è —Ä–∞–±–æ—á–∏—Ö –º–∞—Å—Å–∏–≤–æ–≤.
7) 
```
PetscCall(VecCopy(ctx->diag,d));
PetscFunctionReturn(PETSC_SUCCESS);
```
–î–µ–ª–∞–µ—Ç—Å—è –∫–æ–ø–∏—è –≤–µ–∫—Ç–æ—Ä–∞.

### MatDestroy_Cross(Mat B) - –î–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä –º–∞—Ç—Ä–∏—Ü—ã B.

–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: –º–∞—Ç—Ä–∏—Ü–∞ B, –¥–ª—è –µ–µ —É–Ω–∏—á—Ç–æ–∂–µ–Ω–∏—è.\
```
static PetscErrorCode MatDestroy_Cross(Mat B)
{
  SVD_CROSS_SHELL *ctx;

  PetscFunctionBegin;
  PetscCall(MatShellGetContext(B,&ctx));
  PetscCall(VecDestroy(&ctx->w));
  PetscCall(VecDestroy(&ctx->diag));
  PetscCall(PetscFree(ctx));
  PetscFunctionReturn(PETSC_SUCCESS);
}
```

### SVDSetUp_Cross(SVD svd) - –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≤—Å–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ä–µ—à–∞—Ç–µ–ª—è —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.

–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É SVD svd, —Å–æ–¥–µ—Ä–∂–∞—â—É—é –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.\
–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ SVD svd –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –≤ —Ä–µ—à–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.

1) –û–±—å—è–≤–ª–µ–Ω–∏–µ –Ω—É–∂–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
2) 
```
if (!cross->eps) PetscCall(SVDCrossGetEPS(svd,&cross->eps));
```
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∞–ª–∏—á–∏–µ –æ–±—ä–µ–∫—Ç–∞ EPS –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ cross. –ï—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç, –æ–Ω —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é SVDCrossGetEPS.
```
PetscCall(MatDestroy(&cross->C));
PetscCall(MatDestroy(&cross->D));
```
–£–Ω–∏—á—Ç–æ–∂–µ–Ω–∏–µ –ø–æ–¥–º–∞—Ç—Ä–∏—Ü C –∏ D –æ—Ç–Ω–æ—Å—è—â–∏–µ—Å—è –∫ cross.
```
PetscCall(SVDCrossGetProductMat(svd,svd->A,svd->AT,&cross->C));
```
–û–±—ä—è–≤–ª–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü–µ cross->–°, —á—Ç–æ –æ–Ω–∞ —Ä–∞–≤–Ω–∞ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü—ã A –Ω–∞ –µ–µ —Ç—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É AT.
3) 
```
if (svd->isgeneralized) {
    PetscCall(SVDCrossGetProductMat(svd,svd->B,svd->BT,&cross->D));
    PetscCall(EPSSetOperators(cross->eps,cross->C,cross->D));
    PetscCall(EPSGetProblemType(cross->eps,&ptype));
    if (!ptype) PetscCall(EPSSetProblemType(cross->eps,EPS_GHEP));
```
–ï—Å–ª–∏ –∑–∞–¥–∞—á–∞ —è–≤–ª—è–µ—Ç—Å—è –æ–±–æ–±—â–µ–Ω–Ω–æ–π, —Ç–æ 
```
PetscCall(SVDCrossGetProductMat(svd,svd->B,svd->BT,&cross->D));
```
–ú–∞—Ç—Ä–∏—Ü–∞ cross->D —Ä–∞–≤–Ω–∞ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—é –º–∞—Ç—Ä–∏—Ü—ã B –Ω–∞ –µ–µ —Ç—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É BT.

```
 PetscCall(EPSSetOperators(cross->eps,cross->C,cross->D));
 ```
–≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã –¥–ª—è –∑–∞–¥–∞—á–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—É—é —Ä–µ—à–∞–µ—Ç –æ–±—ä–µ–∫—Ç —Ç–∏–ø–∞ EPS.
–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
cross->eps: –û–±—ä–µ–∫—Ç —Ç–∏–ø–∞ EPS, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–≥–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã.
cross->C: –ú–∞—Ç—Ä–∏—Ü–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –¥–ª—è –ª–µ–≤–æ–π —á–∞—Å—Ç–∏ —É—Ä–∞–≤–Ω–µ–Ω–∏—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.
cross->D: –ú–∞—Ç—Ä–∏—Ü–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –¥–ª—è –ø—Ä–∞–≤–æ–π —á–∞—Å—Ç–∏ —É—Ä–∞–≤–Ω–µ–Ω–∏—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π (–¥–ª—è –æ–±–æ–±—â—ë–Ω–Ω—ã—Ö –∑–∞–¥–∞—á —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π)

```
PetscCall(EPSGetProblemType(cross->eps,&ptype));
```
–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ –ø—Ä–æ–±–ª–µ–º—ã.
```
if (!ptype) PetscCall(EPSSetProblemType(cross->eps,EPS_GHEP));
```
–ï—Å–ª–∏ —Ç–∏–ø –ø—Ä–æ–±–ª–µ–º—ã –Ω–µ –±—ã–ª –∑–∞–¥–∞–Ω, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —Ç–∏–ø EPS_GHEP (–û–±–æ–±—â—ë–Ω–Ω–∞—è –∑–∞–¥–∞—á–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è —ç—Ä–º–∏—Ç–æ–≤—ã—Ö –º–∞—Ç—Ä–∏—Ü).
4) 
```
else if (svd->ishyperbolic && svd->swapped) {

    PetscCall(MatGetType(svd->OP,&Atype));
    PetscCall(MatGetSize(svd->A,NULL,&N));
    PetscCall(MatGetLocalSize(svd->A,NULL,&n));
    PetscCall(MatCreate(PetscObjectComm((PetscObject)svd),&Omega));
    PetscCall(MatSetSizes(Omega,n,n,N,N));
    PetscCall(MatSetType(Omega,Atype));
    PetscCall(MatDiagonalSet(Omega,svd->omega,INSERT_VALUES));
    PetscCall(EPSSetOperators(cross->eps,cross->C,Omega));
    PetscCall(EPSSetProblemType(cross->eps,EPS_GHIEP));
    PetscCall(MatDestroy(&Omega));
  } else {
    PetscCall(EPSSetOperators(cross->eps,cross->C,NULL));
    PetscCall(EPSSetProblemType(cross->eps,EPS_HEP));
  }
  if (!cross->usereps) {
    PetscCall(EPSGetST(cross->eps,&st));
    PetscCall(PetscObjectTypeCompare((PetscObject)st,STSINVERT,&issinv));
    PetscCall(PetscObjectTypeCompare((PetscObject)cross->eps,EPSKRYLOVSCHUR,&isks));
    if (svd->isgeneralized && svd->which==SVD_SMALLEST) {

```
–ï—Å–ª–∏ –∑–∞–¥–∞—á–∞ —è–≤–ª—è–µ—Ç—Å—è –æ–±–æ–±—â—ë–Ω–Ω–æ–π (isgeneralized == true) –∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞–π—Ç–∏ –Ω–∞–∏–º–µ–Ω—å—à–∏–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (which == SVD_SMALLEST),
```
      if (cross->explicitmatrix && isks && !issinv) {  
```
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è, —è–≤–Ω–∞—è –ª–∏ –º–∞—Ç—Ä–∏—Ü–∞ —è–≤–Ω–æ–π –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–∏ –º–µ—Ç–æ–¥ –ö—Ä—ã–ª–æ–≤–∞-–®—É—Ä–∞ (isks), –∏ –ø—Ä–∏ —ç—Ç–æ–º –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∏–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ (!issinv).
```
        PetscCall(STSetType(st,STSINVERT));
        PetscCall(EPSSetTarget(cross->eps,0.0));
        which = EPS_TARGET_REAL;
      } else which = issinv?EPS_TARGET_REAL:EPS_SMALLEST_REAL;
    } else {
      if (issinv) which = EPS_TARGET_MAGNITUDE;
      else if (svd->ishyperbolic) which = svd->which==SVD_LARGEST?EPS_LARGEST_MAGNITUDE:EPS_SMALLEST_MAGNITUDE;
      else which = svd->which==SVD_LARGEST?EPS_LARGEST_REAL:EPS_SMALLEST_REAL;
    }
    PetscCall(EPSSetWhichEigenpairs(cross->eps,which));
    PetscCall(EPSSetDimensions(cross->eps,svd->nsv,svd->ncv,svd->mpd));
    PetscCall(EPSSetTolerances(cross->eps,svd->tol==(PetscReal)PETSC_DETERMINE?SLEPC_DEFAULT_TOL/10.0:svd->tol,svd->max_it));
    switch (svd->conv) {
    case SVD_CONV_ABS:
      PetscCall(EPSSetConvergenceTest(cross->eps,EPS_CONV_ABS));break;
    case SVD_CONV_REL:
      PetscCall(EPSSetConvergenceTest(cross->eps,EPS_CONV_REL));break;
    case SVD_CONV_NORM:
      if (svd->isgeneralized) {
        if (!svd->nrma) PetscCall(MatNorm(svd->OP,NORM_INFINITY,&svd->nrma));
        if (!svd->nrmb) PetscCall(MatNorm(svd->OPb,NORM_INFINITY,&svd->nrmb));
        PetscCall(EPSSetConvergenceTestFunction(cross->eps,EPSConv_Cross,svd,NULL));
      } else {
        PetscCall(EPSSetConvergenceTest(cross->eps,EPS_CONV_NORM));break;
      }
      break;
    case SVD_CONV_MAXIT:
      SETERRQ(PetscObjectComm((PetscObject)svd),PETSC_ERR_SUP,"Maxit convergence test not supported in this solver");
    case SVD_CONV_USER:
      SETERRQ(PetscObjectComm((PetscObject)svd),PETSC_ERR_SUP,"User-defined convergence test not supported in this solver");
    }
  }
  SVDCheckUnsupported(svd,SVD_FEATURE_STOPPING);
  /* Transfer the trackall option from svd to eps */
  PetscCall(SVDGetTrackAll(svd,&trackall));
  PetscCall(EPSSetTrackAll(cross->eps,trackall));
  /* Transfer the initial space from svd to eps */
  if (svd->nini<0) {
    PetscCall(EPSSetInitialSpace(cross->eps,-svd->nini,svd->IS));
    PetscCall(SlepcBasisDestroy_Private(&svd->nini,&svd->IS));
  }

```
–ï—Å–ª–∏ svd->nini –º–µ–Ω—å—à–µ –Ω—É–ª—è, —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —É –Ω–∞—Å –µ—Å—Ç—å –∑–∞—Ä–∞–Ω–µ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ –Ω–∞—á–∞–ª—å–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –¥–ª—è –∑–∞–¥–∞—á–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.
–§—É–Ω–∫—Ü–∏—è EPSSetInitialSpace –ø–µ—Ä–µ–¥–∞–µ—Ç —ç—Ç–æ –Ω–∞—á–∞–ª—å–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –æ–±—ä–µ–∫—Ç—É EPS –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Ä–µ—à–µ–Ω–∏—è.
–ü–æ—Å–ª–µ –ø–µ—Ä–µ–¥–∞—á–∏ –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞, –æ–Ω–æ —É–Ω–∏—á—Ç–æ–∂–∞–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –≤—ã–∑–æ–≤–∞ SlepcBasisDestroy_Private, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å —É—Ç–µ—á–µ–∫ –ø–∞–º—è—Ç–∏.
```
  PetscCall(EPSSetUp(cross->eps));
```
–í—ã–∑–æ–≤ EPSSetUp –∑–∞–≤–µ—Ä—à–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫—É –æ–±—ä–µ–∫—Ç–∞ EPS, –∏—Å–ø–æ–ª—å–∑—É—è –≤—Å–µ —Ä–∞–Ω–µ–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –æ–±—ä–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ —Ä–µ—à–µ–Ω–∏—é –∑–∞–¥–∞—á–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.
```
  PetscCall(EPSGetDimensions(cross->eps,NULL,&svd->ncv,&svd->mpd));
```
–û–±–Ω–æ–≤–ª—è–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è ncv (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞—á–∞–ª—å–Ω—ã—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤) –∏ mpd (–º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤) –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —Ç–µ–º, —á—Ç–æ –±—ã–ª–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ –≤ —Ö–æ–¥–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–±—ä–µ–∫—Ç–∞ EPS.
```
  PetscCall(EPSGetTolerances(cross->eps,NULL,&svd->max_it));
```
–û–±–Ω–æ–≤–ª—è–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ max_it (–º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Ç–µ—Ä–∞—Ü–∏–π) –¥–ª—è –æ–±—ä–µ–∫—Ç–∞ EPS.
```
  if (svd->tol==(PetscReal)PETSC_DETERMINE) svd->tol = SLEPC_DEFAULT_TOL;
```
–ï—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ svd->tol –±—ã–ª–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –∫–∞–∫ PETSC_DETERMINE, —Ç–æ –æ–Ω–æ –∑–∞–º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é SLEPC_DEFAULT_TOL
```
  svd->leftbasis = PETSC_FALSE;
```
–ü–æ–ª–µ leftbasis –æ–±—ä–µ–∫—Ç–∞ svd —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤ PETSC_FALSE, —á—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç –æ —Ç–æ–º, —á—Ç–æ –ª–µ–≤–æ–µ –±–∞–∑–∏—Å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –Ω–µ –Ω—É–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å.
```
  PetscCall(SVDAllocateSolution(svd,0));
```
–í—ã–∑–æ–≤ SVDAllocateSolution –≤—ã–¥–µ–ª—è–µ—Ç –ø–∞–º—è—Ç—å –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.
  PetscFunctionReturn(PETSC_SUCCESS);

### –§—É–∫–Ω—Ü–∏—è EPSMonitor_Cross(EPS eps,PetscInt its,PetscInt nconv,PetscScalar *eigr,PetscScalar *eigi,PetscReal *errest,PetscInt nest,void *ctx) - –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –ø—É—Ç–µ–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –æ—à–∏–±–æ–∫ –Ω–∞ –∫–∞–∂–¥–æ–º —É—Ä–æ–≤–Ω–µ –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –º–µ—Ç—Ä–∏–∫, —Ç–∞–∫–∏—Ö –∫–∞–∫ —Ç–æ—á–Ω–æ—Å—Ç—å –∏ –æ—à–∏–±–∫–∞.

–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: 
- —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É EPS eps, —Å–æ–¥–µ—Ä–∂–∞—â—É—é –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.
- PetscInt its, –Ω–æ–º–µ—Ä —Ç–µ–∫—É—â–µ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞.
- PetscInt nconv, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ —É—Å–ø–µ—à–Ω–æ —Å–æ—à–ª–∏—Å—å –∫ —Ç–µ–∫—É—â–µ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏.
- PetscScalar *eigr, –º–∞—Å—Å–∏–≤ –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —á–∞—Å—Ç–µ–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π, –≤—ã—á–∏—Å–ª–µ–Ω–Ω—ã—Ö –Ω–∞ —Ç–µ–∫—É—â–µ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏.
- PetscScalar *eigi, –º–∞—Å—Å–∏–≤ –º–Ω–∏–º—ã—Ö —á–∞—Å—Ç–µ–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π, –≤—ã—á–∏—Å–ª–µ–Ω–Ω—ã—Ö –Ω–∞ —Ç–µ–∫—É—â–µ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏.
- PetscReal *errest, –º–∞—Å—Å–∏–≤ –æ—Ü–µ–Ω–æ–∫ –æ—à–∏–±–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≤—ã—á–∏—Å–ª–µ–Ω–Ω–æ–≥–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è.
- PetscInt nest, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π, –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞. –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–Ω—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–º—É –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –∑–Ω–∞—á–µ–Ω–∏–π, –¥–æ–ø—É—Å—Ç–∏–º–æ–º—É –º–µ—Ç–æ–¥–æ–º (svd->ncv).
- void *ctx, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç, –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–π –≤ —Ñ—É–Ω–∫—Ü–∏—é. –í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ —ç—Ç–æ —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –æ–±—ä–µ–∫—Ç SVD, —Å–≤—è–∑–∞–Ω–Ω—ã–π —Å –∑–∞–¥–∞—á–µ–π —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.\
–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ SVD svd.

1) 
```
PetscCall(EPSGetST(eps,&st));
```
–í—ã–∑—ã–≤–∞–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è EPSGetST, –∫–æ—Ç–æ—Ä–∞—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±—ä–µ–∫—Ç ST, –æ—Ç–≤–µ—á–∞—é—â–∏–π –∑–∞ —Ç–∏–ø –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è, –∏—Å–ø–æ–ª—å–∑—É–µ–º—É—é –≤ —Ä–µ—à–µ–Ω–∏–∏ –∑–∞–¥–∞—á–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.
```
for (i=0;i<PetscMin(nest,svd->ncv);i++) {
    er = eigr[i]; ei = eigi[i];
```
–î–ª—è –∫–∞–∂–¥–æ–≥–æ —É—Ä–æ–≤–Ω—è –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –æ–±—Ä–∞—Ç–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫:

```
PetscCall(STBackTransform(st,1,&er,&ei));
```
–§—É–Ω–∫—Ü–∏—è STBackTransform –≤—ã–ø–æ–ª–Ω—è–µ—Ç –æ–±—Ä–∞—Ç–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ –æ—Ç —É—Ä–æ–≤–Ω—è –≤–ª–æ–∂–µ–Ω–∏—è –¥–æ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è.

```
svd->sigma[i] = PetscSqrtReal(PetscAbsReal(PetscRealPart(er)));
svd->errest[i] = errest[i];

```
–í–µ–∫—Ç–æ—Ä–∞ sigma –∏ errest –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è —Å–æ–≥–ª–∞—Å–Ω–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –æ—à–∏–±–æ–∫
```
PetscCall(SVDMonitor(svd,its,nconv,svd->sigma,svd->errest,nest));
```
–í—ã–∑—ã–≤–∞–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è SVDMonitor, –∫–æ—Ç–æ—Ä–∞—è –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ —Å —É—á–µ—Ç–æ–º –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –æ—à–∏–±–æ–∫.

### SVDSetFromOptions_Cross(SVD svd,PetscOptionItems *PetscOptionsObject) - —Ñ—É–Ω–∫—Ü–∏—è –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫—É –æ–±—ä–µ–∫—Ç–∞ SVD —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –æ–ø—Ü–∏–π, –ø–æ–∑–≤–æ–ª—è—é—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –≤—ã–±–∏—Ä–∞—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ —Å–∏–Ω–≥—É–ª—è—Ä–Ω–æ–≥–æ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏—è –º–µ—Ç–æ–¥–æ–º cross SVD.

–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: 
- —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É SVD svd, —Å–æ–¥–µ—Ä–∂–∞—â—É—é –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.
- –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –æ–±—ä–µ–∫—Ç, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π —Å–ø–∏—Å–æ–∫ –¥–ª—è —á—Ç–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤.\
–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ SVD svd.

1) 
```
PetscOptionsHeadBegin(PetscOptionsObject,"SVD Cross Options");

    PetscCall(PetscOptionsBool("-svd_cross_explicitmatrix","Use cross explicit matrix","SVDCrossSetExplicitMatrix",cross->explicitmatrix,&val,&set));
    if (set) PetscCall(SVDCrossSetExplicitMatrix(svd,val));

  PetscOptionsHeadEnd();
```
–ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤—ã–±—Ä–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —è–≤–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã –≤–º–µ—Å—Ç–æ –Ω–µ—è–≤–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –æ–ø—Ü–∏–π. –ï—Å–ª–∏ –≤—ã–±—Ä–∞–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —è–≤–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã, —Ç–æ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è SVDCrossSetExplicitMatrix, –∫–æ—Ç–æ—Ä–∞—è —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã —Å —è–≤–Ω–æ–π –º–∞—Ç—Ä–∏—Ü–µ–π.
```
if (!cross->eps) PetscCall(SVDCrossGetEPS(svd,&cross->eps));
  if (!cross->explicitmatrix && !cross->usereps) {
    /* use as default an ST with shell matrix and Jacobi */
    PetscCall(EPSGetST(cross->eps,&st));
    PetscCall(STSetMatMode(st,ST_MATMODE_SHELL));
  }
```
–ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –≤—ã–±—Ä–∞–ª —è–≤–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É –∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π EPS, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Ç–∏–ø –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ä–µ–∂–∏–º–∞ Shell Matrix. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ ST –Ω–∞–Ω–æ—Å–∏—Ç —É—â–µ—Ä–± —Ä–∞–±–æ—Ç–µ —Å –º–∞—Ç—Ä–∏—Ü–∞–º–∏ –≤ —Ä–µ–∂–∏–º–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –¥–ª—è –º–Ω–æ–≥–∏—Ö –∑–∞–¥–∞—á —Å–∏–Ω–≥—É–ª—è—Ä–Ω–æ–≥–æ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏—è.

### –§—É–Ω–∫—Ü–∏—è SVDCrossSetExplicitMatrix_Cross(SVD svd,PetscBool explicitmatrix) - –∏–∑–º–µ–Ω—è–µ—Ç –ø–æ–≤–µ–¥–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ SVDCross —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —á—Ç–æ –æ–Ω –Ω–∞—á–∏–Ω–∞–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —è–≤–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É –≤–º–µ—Å—Ç–æ –º–∞—Ç—Ä–∏—Ü–∏ SHELL. –≠—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ–≤–µ–¥–µ–Ω–∏—è –≤–æ–∑–º–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ –≤ —Ç–æ–º —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ —Ç–µ–∫—É—â–∏–π —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–∂–∏–¥–∞–µ–º–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ explicitmatrix

–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: 
- —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É SVD svd, —Å–æ–¥–µ—Ä–∂–∞—â—É—é –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.
- –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è explicitmatrix —Ç–∏–ø–∞ bool, –∫–æ—Ç–æ—Ä–∞—è –≥–æ–≤–æ—Ä–∏—Ç –±—É–¥–µ—Ç –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —è–≤–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –≤ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è—Ö.\
–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ SVD svd.

```
static PetscErrorCode SVDCrossSetExplicitMatrix_Cross(SVD svd,PetscBool explicitmatrix)
{
  SVD_CROSS *cross = (SVD_CROSS*)svd->data;

  PetscFunctionBegin;
  if (cross->explicitmatrix != explicitmatrix) {
    cross->explicitmatrix = explicitmatrix;
    svd->state = SVD_STATE_INITIAL;
  }
  PetscFunctionReturn(PETSC_SUCCESS);
}
```
```
if (cross->explicitmatrix != explicitmatrix) {
    cross->explicitmatrix = explicitmatrix;
    svd->state = SVD_STATE_INITIAL;
  }
```
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–µ–∫—É—â–∏–π —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ cross –∏ –µ—Å–ª–∏ —Ñ–ª–∞–≥ explicitmatrix –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç –∂–µ–ª–∞–µ–º–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è, —Ç–æ –æ–Ω —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —Ä–∞–≤–Ω—ã–º –∂–µ–ª–∞–µ–º–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é, –∞ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ svd —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤ –Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ.

### –§—É–Ω–∫—Ü–∏—è SVDCrossSetExplicitMatrix(SVD svd,PetscBool explicitmat) - –§—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –æ–±—ä–µ–∫—Ç–æ–≤ –∏ –ø—ã—Ç–∞–µ—Ç—Å—è –ø—Ä–∏–º–µ–Ω–∏—Ç—å –º–µ—Ç–æ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–µ–∂–∏–º–∞ —Ä–∞–±–æ—Ç—ã –æ–±—ä–µ–∫—Ç–∞ SVD –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —è–≤–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã

–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: 
- —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É SVD svd, —Å–æ–¥–µ—Ä–∂–∞—â—É—é –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.
- –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è explicitmatrix —Ç–∏–ø–∞ bool, –∫–æ—Ç–æ—Ä–∞—è –≥–æ–≤–æ—Ä–∏—Ç –±—É–¥–µ—Ç –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —è–≤–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –≤ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è—Ö.\
–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ SVD svd.

```
PetscErrorCode SVDCrossSetExplicitMatrix(SVD svd,PetscBool explicitmat)
{
  PetscFunctionBegin;
  PetscValidHeaderSpecific(svd,SVD_CLASSID,1);
  PetscValidLogicalCollectiveBool(svd,explicitmat,2);
  PetscTryMethod(svd,"SVDCrossSetExplicitMatrix_C",(SVD,PetscBool),(svd,explicitmat));
  PetscFunctionReturn(PETSC_SUCCESS);
}
```
–ö–ª–∞—Å—Å SVD –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∫–ª–∞—Å—Å—É –∏ –Ω–∞–ª–∏—á–∏–µ –Ω—É–∂–Ω—ã—Ö —Ñ–ª–∞–≥–æ–≤.
–ü–∞—Ä–∞–º–µ—Ç—Ä explicitmat –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è.

### –§—É–Ω–∫—Ü–∏—è SVDCrossGetExplicitMatrix_Cross(SVD svd,PetscBool *explicitmat) - —Ñ—É–Ω–∫—Ü–∏—è —Ñ–ª–∞–≥ explicitmatrix, –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —è–≤–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.

–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: 
- —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É SVD svd, —Å–æ–¥–µ—Ä–∂–∞—â—É—é –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.
- –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é explicitmatrix —Ç–∏–ø–∞ bool, –∫–æ—Ç–æ—Ä–∞—è –≥–æ–≤–æ—Ä–∏—Ç –±—É–¥–µ—Ç –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —è–≤–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –≤ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è—Ö.\
–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ SVD svd.
```
static PetscErrorCode SVDCrossGetExplicitMatrix_Cross(SVD svd,PetscBool *explicitmat)
{
  SVD_CROSS *cross = (SVD_CROSS*)svd->data;

  PetscFunctionBegin;
  *explicitmat = cross->explicitmatrix;
  PetscFunctionReturn(PETSC_SUCCESS);
}
```
### –§—É–Ω–∫—Ü–∏—è SVDCrossGetExplicitMatrix(SVD svd,PetscBool *explicitmat) - —Ñ—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —è–≤–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É, –µ—Å–ª–∏ —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã –æ–±—ä–µ–∫—Ç–∞ SVD —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —è–≤–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã. 

–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: 
- —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É SVD svd, —Å–æ–¥–µ—Ä–∂–∞—â—É—é –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.
- –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é explicitmatrix —Ç–∏–ø–∞ bool, –∫–æ—Ç–æ—Ä–∞—è –≥–æ–≤–æ—Ä–∏—Ç –±—É–¥–µ—Ç –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —è–≤–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –≤ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è—Ö.\
–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ SVD svd.

```
PetscErrorCode SVDCrossGetExplicitMatrix(SVD svd,PetscBool *explicitmat)
{
  PetscFunctionBegin;
  PetscValidHeaderSpecific(svd,SVD_CLASSID,1);
  PetscAssertPointer(explicitmat,2);
  PetscUseMethod(svd,"SVDCrossGetExplicitMatrix_C",(SVD,PetscBool*),(svd,explicitmat));
  PetscFunctionReturn(PETSC_SUCCESS);
}
```
### –§—É–Ω–∫—Ü–∏—è = PetscErrorCode SVDCrossSetEPS_Cross(SVD svd,EPS eps) - —Ñ—É–Ω–∫—Ü–∏—è —Ä–µ–∞–ª–∏–∑—É–µ—Ç –∑–∞–º–µ–Ω—É –æ–±—ä–µ–∫—Ç–∞ eps –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ SVD_Cross –Ω–∞ –Ω–æ–≤—ã–π –æ–±—ä–µ–∫—Ç eps

–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: 
- —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É SVD svd, —Å–æ–¥–µ—Ä–∂–∞—â—É—é –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.
- —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É EPS eps, —Å–æ–¥–µ—Ä–∂–∞—â—É—é –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.\
–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ SVD_CROSS, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–¥–µ—Ä–∂–∏–∏—Ç –¥–∞–Ω–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—Ä SVD –∏ EPS. 

```
static PetscErrorCode SVDCrossSetEPS_Cross(SVD svd,EPS eps)
{
  SVD_CROSS      *cross = (SVD_CROSS*)svd->data;

  PetscFunctionBegin;
  PetscCall(PetscObjectReference((PetscObject)eps));
  PetscCall(EPSDestroy(&cross->eps));
  cross->eps     = eps;
  cross->usereps = PETSC_TRUE;
  svd->state     = SVD_STATE_INITIAL;
  PetscFunctionReturn(PETSC_SUCCESS);
}
```
### –§—É–Ω–∫—Ü–∏—è SVDCrossSetEPS(SVD svd,EPS eps) - —Ñ—É–Ω–∫—Ü–∏—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–≤—è–∑—å –º–µ–∂–¥—É –æ–±—ä–µ–∫—Ç–∞–º–∏ SVD –∏ EPS –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –º–µ–∂–¥—É —ç—Ç–∏–º–∏ –æ–±—ä–µ–∫—Ç–∞–º–∏.


–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: 
- —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É SVD svd, —Å–æ–¥–µ—Ä–∂–∞—â—É—é –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.
- —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É EPS eps, —Å–æ–¥–µ—Ä–∂–∞—â—É—é –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.\
–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ SVD, –µ—Å–ª–∏ –≤—ã–∑–æ–≤ –ø—Ä–æ—Ö–æ–¥–∏—Ç —É—Å–ø–µ—à–Ω–æ, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–±—ä–µ–∫—Ç EPS —Å–≤—è–∑—ã–≤–∞–µ—Ç—Å—è —Å SVD, –∞ –≤—Å–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ EPS. 

```
PetscErrorCode SVDCrossSetEPS(SVD svd,EPS eps)
{
  PetscFunctionBegin;
  PetscValidHeaderSpecific(svd,SVD_CLASSID,1);
  PetscValidHeaderSpecific(eps,EPS_CLASSID,2);
  PetscCheckSameComm(svd,1,eps,2);
  PetscTryMethod(svd,"SVDCrossSetEPS_C",(SVD,EPS),(svd,eps));
  PetscFunctionReturn(PETSC_SUCCESS);
}
```
–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–æ–≤–Ω–æ—Å—Ç–∏ –æ–±—ä–µ–∫—Ç–æ–≤ svd –∏ eps: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–ª–∞—Å—Å–∞ SVD, –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∫–ª–∞—Å—Å–∞ –∏ –Ω–∞–ª–∏—á–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö —Ñ–ª–∞–≥–æ–≤. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–ª–∞—Å—Å–æ–≤ –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ –¥–ª—è –æ–±—ä–µ–∫—Ç–æ–≤ eps.
–ï—Å–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ, –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –º–µ—Ç–æ–¥ SVDCrossSetEPS_C –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–≤—è–∑–∏ –º–µ–∂–¥—É –æ–±—ä–µ–∫—Ç–∞–º–∏ SVD –∏ EPS.


### –§—É–Ω–∫—Ü–∏—è SVDCrossGetEPS_Cross(SVD svd,EPS *eps) - —Ñ—É–Ω–∫—Ü–∏—è —Ä–µ–∞–ª–∏–∑—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫—É –º–µ—Ç–æ–¥–∞ SVDCross –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö —á–∏—Å–µ–ª —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –æ–±—ä–µ–∫—Ç–∞ EPS.

–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: 
- —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É SVD svd, —Å–æ–¥–µ—Ä–∂–∞—â—É—é –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.
- —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É EPS eps, —Å–æ–¥–µ—Ä–∂–∞—â—É—é –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.\
–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ SVD, –µ—Å–ª–∏ –≤—ã–∑–æ–≤ –ø—Ä–æ—Ö–æ–¥–∏—Ç —É—Å–ø–µ—à–Ω–æ, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–±—ä–µ–∫—Ç EPS —Å–≤—è–∑—ã–≤–∞–µ—Ç—Å—è —Å SVD, –∞ –≤—Å–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ EPS.

1)
```
SVD_CROSS      *cross = (SVD_CROSS*)svd->data;
``` 
C–æ–∑–¥–∞–µ—Ç—Å—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è cross —Ç–∏–ø–∞ SVD_CROSS*, –∫–æ—Ç–æ—Ä–∞—è —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –¥–∞–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç–∞ svd. –¢–∏–ø –¥–∞–Ω–Ω—ã—Ö svd –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç—Å—è –∫ —Ç–∏–ø—É SVD_CROSS*.
```
 if (!cross->eps) {
```
C—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –æ–±—ä–µ–∫—Ç eps –≤–Ω—É—Ç—Ä–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã cross
```
PetscCall(EPSCreate(PetscObjectComm((PetscObject)svd),&cross->eps));
```
–°–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π –æ–±—ä–µ–∫—Ç —Ç–∏–ø–∞ EPS –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ cross
```
PetscCall(PetscObjectIncrementTabLevel((PetscObject)cross->eps,(PetscObject)svd,1));
```
–£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–∫–ª–∞–¥–æ–∫, –∫–æ—Ç–æ—Ä—ã–µ PETSCVIEWERASCII –≤—ã–≤–æ–¥–∏—Ç –¥–ª—è —ç—Ç–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞, –∏—Å–ø–æ–ª—å–∑—É—è tablevel –¥—Ä—É–≥–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞. –≠—Ç–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤—ã–∑–≤–∞–Ω–æ —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞.
–í—Ö–æ–¥–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
PetscObjectIncrementTabLevel((PetscObject)cross->ep - –ª—é–±–æ–π –æ–±—ä–µ–∫—Ç PETSc, –≤ –∫–æ—Ç–æ—Ä–æ–º –º—ã –º–µ–Ω—è–µ–º –≤–∫–ª–∞–¥–∫—É
(PetscObject)svd - –æ–±—ä–µ–∫—Ç, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—â–∏–π –≤–∫–ª–∞–¥–∫—É, –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–µ–¥–∞–π—Ç–µ NULL, —á—Ç–æ–±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å 0 –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ tablevel –¥–ª—è obj
1 - –ø—Ä–∏—Ä–∞—â–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∫ –≤–∫–ª–∞–¥–∫–µ —Å—Ç–∞—Ä—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤
```
    PetscCall(EPSSetOptionsPrefix(cross->eps,((PetscObject)svd)->prefix));
```
–§—É–Ω–∫—Ü–∏—è EPSAppendOptionsPrefix –¥–æ–±–∞–≤–ª—è–µ—Ç —É–∫–∞–∑–∞–Ω–Ω—ã–π –ø—Ä–µ—Ñ–∏–∫—Å ("svd_cross_") –∫ —Ç–µ–∫—É—â–µ–º—É —Å–ø–∏—Å–∫—É –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –æ–±—ä–µ–∫—Ç–∞ cross->eps.
```
PetscCall(EPSAppendOptionsPrefix(cross->eps,"svd_cross_"));
```
–î–æ–±–∞–≤–ª—è–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–µ—Ñ–∏–∫—Å "svd_cross_" –∫  cross->eps
```
PetscCall(PetscObjectSetOptions((PetscObject)cross->eps,((PetscObject)svd)->options));
```
–ü–µ—Ä–µ–¥–∞—é—Ç—Å—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –æ—Ç —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ svd –Ω–æ–≤–æ–º—É –æ–±—ä–µ–∫—Ç—É cross->eps.
```
PetscCall(EPSSetWhichEigenpairs(cross->eps,EPS_LARGEST_REAL));
```
–†–µ–∂–∏–º –ø–æ–∏—Å–∫–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –æ–±—ä–µ–∫—Ç–∞ EPS: –±—É–¥—É—Ç –Ω–∞–π–¥–µ–Ω—ã –Ω–∞–∏–±–æ–ª—å—à–∏–µ –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è.
```
    PetscCall(EPSMonitorSet(cross->eps,EPSMonitor_Cross,svd,NULL));
```
–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –º–æ–Ω–∏—Ç–æ—Ä –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.

### –§—É–Ω–∫—Ü–∏—è SVDCrossGetEPS(SVD svd,EPS *eps) - —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–º–æ–≥–∞–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –æ–±—ä–µ–∫—Ç EPS –∏–∑ –æ–±—ä–µ–∫—Ç–∞ SVD.

–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: 
- —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É SVD svd, —Å–æ–¥–µ—Ä–∂–∞—â—É—é –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.
- —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É EPS eps, —Å–æ–¥–µ—Ä–∂–∞—â—É—é –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.\
–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ SVD, –µ—Å–ª–∏ –≤—ã–∑–æ–≤ –ø—Ä–æ—Ö–æ–¥–∏—Ç —É—Å–ø–µ—à–Ω–æ, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–±—ä–µ–∫—Ç EPS —Å–≤—è–∑—ã–≤–∞–µ—Ç—Å—è —Å SVD, –∞ –≤—Å–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ EPS.

```
PetscErrorCode SVDCrossGetEPS(SVD svd,EPS *eps)
{
  PetscFunctionBegin;
  PetscValidHeaderSpecific(svd,SVD_CLASSID,1);
  PetscAssertPointer(eps,2);
  PetscUseMethod(svd,"SVDCrossGetEPS_C",(SVD,EPS*),(svd,eps));
  PetscFunctionReturn(PETSC_SUCCESS);
}
```
```
PetscFunctionBegin;
```
```
  PetscValidHeaderSpecific(svd,SVD_CLASSID,1);
```
–ü—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –ª–∏ —É–∫–∞–∑–∞–Ω–Ω–æ–º—É –∫–ª–∞—Å—Å—É 1 —ç–ª–µ–º–µ–Ω—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—ã svd 
```
  PetscAssertPointer(eps,2);
```
–ù–µ —Ä–∞–≤–µ–Ω –ª–∏ 2-–æ–π —ç–ª–µ–º–µ–Ω—Ç eps, NULL
```
  PetscUseMethod(svd,"SVDCrossGetEPS_C",(SVD,EPS*),(svd,eps));
```
–ó–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç PetscObject –¥–ª—è –º–µ—Ç–æ–¥–∞, –¥–æ–±–∞–≤–ª–µ–Ω–Ω–æ–≥–æ —Å –ø–æ–º–æ—â—å—é PetscObjectComposeFunction(), –µ—Å–ª–∏ –æ–Ω —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, —Ç–æ –≤—ã–∑—ã–≤–∞–µ—Ç –µ–≥–æ, –≤ –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ—à–∏–±–∫—É.
–í—Ö–æ–¥–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
svd - –æ–±—ä–µ–∫—Ç, –Ω–∞–ø—Ä–∏–º–µ—Ä Mat, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ –Ω—É–∂–Ω–æ –ø—Ä–∏–≤–æ–¥–∏—Ç—å –∫ PetscObject
"SVDCrossGetEPS_C" - –∏–º—è –º–µ—Ç–æ–¥–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä, ¬´KSPGMRESSetRestart_C¬ª –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–∏ KSPGMRESSetRestart()
(SVD,EPS*) - —Ç–∏–ø—ã –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è –º–µ—Ç–æ–¥–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä, (KSP,PetscInt)
(svd,eps) - –∞—Ä–≥—É–º–µ–Ω—Ç—ã –¥–ª—è –º–µ—Ç–æ–¥–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä, (ksp,restart))

### –§—É–Ω–∫—Ü–∏—è SVDView_Cross(SVD svd,PetscViewer viewer) - —Ñ—É–Ω–∫—Ü–∏—è –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –≤—ã–≤–æ–¥ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–∏–Ω–≥—É–ª—è—Ä–Ω–æ–º —Ä–∞–∑–ª–æ–∂–µ–Ω–∏–∏ (SVD) –≤ —Ñ–æ—Ä–º–∞—Ç–µ ASCII —á–µ—Ä–µ–∑ –æ–±—ä–µ–∫—Ç PetscViewer.

–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: 
- —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É SVD svd, —Å–æ–¥–µ—Ä–∂–∞—â—É—é –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.
- –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –æ–±—ä–µ–∫—Ç –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ (PetscViewer), –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤—ã–≤–æ–¥–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.\
–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
 - –í—ã–≤–æ–¥ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, –µ—Å–ª–∏ viewer –∏–º–µ–µ—Ç —Ç–∏–ø PETSCVIEWERASCII, –≤—ã–≤–æ–¥–∏—Ç—Å—è: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —è–≤–Ω–æ–π –∏–ª–∏ –Ω–µ—è–≤–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã (explicit –∏–ª–∏ implicit). –ü–æ–¥—Ä–æ–±–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–±—ä–µ–∫—Ç–∞ EPS, —Å–≤—è–∑–∞–Ω–Ω–æ–≥–æ —Å –º–µ—Ç–æ–¥–æ–º "Cross".
 - –í–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è PetscErrorCode: –∫–æ–¥ –æ—à–∏–±–∫–∏ (–æ–±—ã—á–Ω–æ PETSC_SUCCESS, –µ—Å–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ).

```
PetscCall(PetscObjectTypeCompare((PetscObject)viewer,PETSCVIEWERASCII,&isascii));
```
–§—É–Ω–∫—Ü–∏—è PetscObjectTypeCompare –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –æ–±—ä–µ–∫—Ç viewer —Ç–∏–ø–æ–º PETSCVIEWERASCII. –†–µ–∑—É–ª—å—Ç–∞—Ç —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é isascii
```
if (isascii) {
    if (!cross->eps) PetscCall(SVDCrossGetEPS(svd,&cross->eps));
    PetscCall(PetscViewerASCIIPrintf(viewer,"  %s matrix\n",cross->explicitmatrix?"explicit":"implicit"));
    PetscCall(PetscViewerASCIIPushTab(viewer));
    PetscCall(EPSView(cross->eps,viewer));
    PetscCall(PetscViewerASCIIPopTab(viewer));
  }
```
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∞–ª–∏—á–∏–µ –æ–±—ä–µ–∫—Ç–∞ EPS –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ cross. –ï—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç, –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è SVDCrossGetEPS –¥–ª—è –µ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è.
–í—ã–∑—ã–≤–∞–µ—Ç—Å—è PetscViewerASCIIPrintf –¥–ª—è –≤—ã–≤–æ–¥–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –º–∞—Ç—Ä–∏—Ü–µ (—è–≤–Ω–æ–π –∏–ª–∏ –Ω–µ—è–≤–Ω–æ–π).
–° –ø–æ–º–æ—â—å—é PetscViewerASCIIPushTab —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —É—Ä–æ–≤–µ–Ω—å —Ç–∞–±—É–ª—è—Ü–∏–∏ –¥–ª—è –≤—ã–≤–æ–¥–∞.
–í—ã–∑—ã–≤–∞–µ—Ç—Å—è EPSView –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ EPS.
–° –ø–æ–º–æ—â—å—é PetscViewerASCIIPopTab –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –ø—Ä–µ–¥—ã–¥—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å —Ç–∞–±—É–ª—è—Ü–∏–∏.

### –§—É–Ω–∫—Ü–∏—è SVDReset_Cross(SVD svd) - —Ñ—É–Ω–∫—Ü–∏—è —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ SVD, —É–¥–∞–ª—è—è –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–∞—Ç—Ä–∏—Ü—ã –∏ –ø–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞—è –æ–±—ä–µ–∫—Ç –∫ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é.

–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É SVD svd, —Å–æ–¥–µ—Ä–∂–∞—â—É—é –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.\
–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: –∏–∑–º–µ–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ SVD svd.

```
 PetscCall(EPSReset(cross->eps));
```
–≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ EPS —Ç–∞–∫, —á—Ç–æ–±—ã –µ–≥–æ –º–æ–∂–Ω–æ –±—ã–ª–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–∞–Ω–æ–≤–æ.
```
  PetscCall(MatDestroy(&cross->C));
  PetscCall(MatDestroy(&cross->D));
```
–£–¥–∞–ª—è—é—Ç—Å—è –¥–≤–µ –º–∞—Ç—Ä–∏—Ü—ã, —Ö—Ä–∞–Ω–∏–º—ã–µ –≤ –ø–æ–ª—è—Ö C –∏ D —Å—Ç—Ä—É–∫—Ç—É—Ä—ã cross. –≠—Ç–∏ –º–∞—Ç—Ä–∏—Ü—ã –º–æ–≥—É—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—ã—á–∏—Å–ª–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–Ω—ã –ø–æ—Å–ª–µ —Å–±—Ä–æ—Å–∞.

### –§—É–Ω–∫—Ü–∏—è SVDDestroy_Cross(SVD svd) - —Ñ—É–Ω–∫—Ü–∏—è —É–¥–∞–ª—è–µ—Ç —Ä–µ—Å—É—Ä—Å—ã, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –æ–±—ä–µ–∫—Ç–æ–º SVD, –≤–∫–ª—é—á–∞—è —É–Ω–∏—á—Ç–æ–∂–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ EPS.

–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É SVD svd, —Å–æ–¥–µ—Ä–∂–∞—â—É—é –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.\
–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: -.

```
PetscCall(EPSDestroy(&cross->eps));
```
–£–¥–∞–ª—è—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç–∞ cross->eps.
```
  PetscCall(PetscFree(svd->data));
```
–û—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç—Å—è –ø–∞–º—è—Ç—å –∑–∞–Ω–∏–º–∞–µ–º–∞—è svd->data
```
  PetscCall(PetscObjectComposeFunction((PetscObject)svd,"SVDCrossSetEPS_C",NULL));
  PetscCall(PetscObjectComposeFunction((PetscObject)svd,"SVDCrossGetEPS_C",NULL));
  PetscCall(PetscObjectComposeFunction((PetscObject)svd,"SVDCrossSetExplicitMatrix_C",NULL));
  PetscCall(PetscObjectComposeFunction((PetscObject)svd,"SVDCrossGetExplicitMatrix_C",NULL));
```
–≠—Ç–∏ —Å—Ç—Ä–æ–∫–∏ –æ—á–∏—â–∞—é—Ç —Å–æ—Å—Ç–∞–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –æ–±—ä–µ–∫—Ç–æ–º svd, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—è –∏—Ö –≤ NULL.
–¢–∞–∫ –∫–∞–∫ —Ñ—É–Ω–∫—Ü–∏—è —Å–≤—è–∑—ã–≤–∞–µ—Ç —Å –∑–∞–¥–∞–Ω–Ω—ã–º –æ–±—ä–µ–∫—Ç–æ–º PETSc - NULL.
PetscObjectComposeFunction(PetscObject obj, const char name[], void (*fptr)(void))
–í—Ö–æ–¥–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
obj - –æ–±—ä–µ–∫—Ç PETSc; –æ–Ω –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø—Ä–∏–≤–µ–¥–µ–Ω –∫ (PetscObject), –Ω–∞–ø—Ä–∏–º–µ—Ä, PetscObjectCompose((PetscObject)mat,‚Ä¶);
name - –∏–º—è, —Å–≤—è–∑–∞–Ω–Ω–æ–µ —Å –¥–æ—á–µ—Ä–Ω–µ–π —Ñ—É–Ω–∫—Ü–∏–µ–π
fptr - —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—é


### –§—É–Ω–∫—Ü–∏—è PetscErrorCode SVDCreate_Cross(SVD svd) - —Ñ—É–Ω–∫—Ü–∏—è SVDCreate_Cross —Å–æ–∑–¥–∞–µ—Ç –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –æ–±—ä–µ–∫—Ç SVD –¥–ª—è –∫—Ä–æ—Å—Å-—Å–∏–Ω–≥—É–ª—è—Ä–Ω–æ–≥–æ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏—è. –û–Ω–∞ –≤—ã–¥–µ–ª—è–µ—Ç –ø–∞–º—è—Ç—å –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –æ–±—ä–µ–∫—Ç–æ–º.

–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É SVD svd, —Å–æ–¥–µ—Ä–∂–∞—â—É—é –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.\
–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ SVD svd.

```
svd->ops->solve          = SVDSolve_Cross;
  svd->ops->solveg         = SVDSolve_Cross;
  svd->ops->solveh         = SVDSolve_Cross;
  svd->ops->setup          = SVDSetUp_Cross;
  svd->ops->setfromoptions = SVDSetFromOptions_Cross;
  svd->ops->destroy        = SVDDestroy_Cross;
  svd->ops->reset          = SVDReset_Cross;
  svd->ops->view           = SVDView_Cross;
  svd->ops->computevectors = SVDComputeVectors_Cross;
```
–ó–∞–¥–∞—é—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–∞–¥ –æ–±—ä–µ–∫—Ç–æ–º SVD. 
```
  PetscCall(PetscObjectComposeFunction((PetscObject)svd,"SVDCrossSetEPS_C",SVDCrossSetEPS_Cross));
  PetscCall(PetscObjectComposeFunction((PetscObject)svd,"SVDCrossGetEPS_C",SVDCrossGetEPS_Cross));
  PetscCall(PetscObjectComposeFunction((PetscObject)svd,"SVDCrossSetExplicitMatrix_C",SVDCrossSetExplicitMatrix_Cross));
  PetscCall(PetscObjectComposeFunction((PetscObject)svd,"SVDCrossGetExplicitMatrix_C",SVDCrossGetExplicitMatrix_Cross));
```
–°–≤—è–∑—ã–≤–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é —Å –∑–∞–¥–∞–Ω–Ω—ã–º –æ–±—ä–µ–∫—Ç–æ–º PETSc.
–û–±—â–∏–π –≤–∏–¥:
```
PetscObjectComposeFunction(PetscObject obj, const char name[], void (*fptr)(void))
```
–í—Ö–æ–¥–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
obj - –æ–±—ä–µ–∫—Ç PETSc; –æ–Ω –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø—Ä–∏–≤–µ–¥–µ–Ω –∫ (PetscObject), –Ω–∞–ø—Ä–∏–º–µ—Ä, PetscObjectCompose((PetscObject)mat,‚Ä¶);
name - –∏–º—è, —Å–≤—è–∑–∞–Ω–Ω–æ–µ —Å –¥–æ—á–µ—Ä–Ω–µ–π —Ñ—É–Ω–∫—Ü–∏–µ–π
fptr - —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—é

## 4. References.

1. SLEPc Users Manual Scalable Library for Eigenvalue Problem Computations, Carmen Campos Jose E. Roman, Eloy Romero Andres Tomas. –†–∞–∑–¥–µ–ª EPS: Eigenvalue Problem Solver, —Å—Ç—Ä–∞–Ω–∏—Ü–∞ 17.  
2. http://www.grycap.upv.es/slepc.  
3. https://petsc.org/release/  
4. https://slepc.upv.es/slepc-main/include/slepc/private/

