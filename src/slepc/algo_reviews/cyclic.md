???

## –í–≤–µ–¥–µ–Ω–∏–µ

* shell == –æ–±–æ–ª–æ—á–Ω–∞—è == –Ω–µ—è–≤–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ ???
* *–ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã –º–∞—Ç—Ä–∏—Ü—ã* ùëÄ√óùëÅ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç –æ–±—â–µ–µ —á–∏—Å–ª–æ —Å—Ç—Ä–æ–∫ (M) –∏ —Å—Ç–æ–ª–±—Ü–æ–≤ (N) –≤ –º–∞—Ç—Ä–∏—Ü–µ. –≠—Ç–∏ —Ä–∞–∑–º–µ—Ä—ã –æ—Ç–Ω–æ—Å—è—Ç—Å—è –∫–æ –≤—Å–µ–π –º–∞—Ç—Ä–∏—Ü–µ, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ç–æ–≥–æ, –∫–∞–∫ –æ–Ω–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –º–µ–∂–¥—É –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏.
* *–õ–æ–∫–∞–ª—å–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã –º–∞—Ç—Ä–∏—Ü—ã* (ùëö√óùëõ) –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ (m) –∏ —Å—Ç–æ–ª–±—Ü–æ–≤ (n), –∫–æ—Ç–æ—Ä—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —Ç–µ–∫—É—â–∏–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º MPI. –≠—Ç–∏ —Ä–∞–∑–º–µ—Ä—ã –∑–∞–≤–∏—Å—è—Ç –æ—Ç —á–∏—Å–ª–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –∏ —Å–ø–æ—Å–æ–±–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –º–∞—Ç—Ä–∏—Ü—ã.
* –¶–∏–∫–ª–∏—á–µ—Å–∫–∞—è –º–∞—Ç—Ä–∏—Ü–∞ - —ç—Ç–æ —Ç–∞–∫–∞—è –±–ª–æ—á–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ C, –∫–æ—Ç–æ—Ä–∞—è —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ A –∏ $A^T$, –∏ –∏–º–µ–µ—Ç –≤–∏–¥:

$$
C = \begin{bmatrix}
0 & A \\
A^T & 0
\end{bmatrix}
$$

* –ù–µ—è–≤–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ - —ç—Ç–æ –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü—ã, –≤ –∫–æ—Ç–æ—Ä–æ–º –µ—ë –∑–Ω–∞—á–µ–Ω–∏—è –∏–ª–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏–∑–≤–µ—Å—Ç–Ω—ã, –Ω–æ –Ω–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –≤ –ø–∞–º—è—Ç–∏ –∫–∞–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.

| **–ü—Ä–∏–º–µ—Ä—ã –Ω–µ—è–≤–Ω—ã—Ö –º–∞—Ç—Ä–∏—Ü:**
1. –†–∞–∑—Ä–µ–∂–µ–Ω–Ω—ã–µ –º–∞—Ç—Ä–∏—Ü—ã - —Ç–∞–∫–∏–µ, —É –∫–æ—Ç–æ—Ä—ã—Ö –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Ä–∞–≤–Ω—ã –Ω—É–ª—é. –í–º–µ—Å—Ç–æ —Ç–æ–≥–æ —á—Ç–æ–±—ã —Ö—Ä–∞–Ω–∏—Ç—å –≤—Å—é –º–∞—Ç—Ä–∏—Ü—É —Ü–µ–ª–∏–∫–æ–º, –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö, —Ç–∞–∫–∏–µ –∫–∞–∫ —Å–ø–∏—Å–∫–∏ —Å–º–µ–∂–Ω–æ—Å—Ç–µ–π –∏–ª–∏ —Ñ–æ—Ä–º–∞—Ç COO (–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç), –∫–æ—Ç–æ—Ä—ã–µ —Ö—Ä–∞–Ω—è—Ç —Ç–æ–ª—å–∫–æ –Ω–µ–Ω—É–ª–µ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –≤–º–µ—Å—Ç–µ —Å –∏—Ö –∏–Ω–¥–µ–∫—Å–∞–º–∏. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –º–∞—Ç—Ä–∏—Ü–∞ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–µ—è–≤–Ω–æ–π, –ø–æ—Å–∫–æ–ª—å–∫—É –±–æ–ª—å—à–∞—è —á–∞—Å—Ç—å –µ—ë –¥–∞–Ω–Ω—ã—Ö –Ω–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è —è–≤–Ω–æ.

2. –ö–≤–∞–Ω—Ç–æ–≤–∞–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü - –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –º–µ—Ç–æ–¥—ã –∫–≤–∞–Ω—Ç–æ–≤–∞–Ω–∏—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç –º–∞—Ç—Ä–∏—Ü—ã –≤ —Å–∂–∞—Ç–æ–º –≤–∏–¥–µ, –∏—Å–ø–æ–ª—å–∑—É—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∏—Ç –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —É–º–µ–Ω—å—à–∏—Ç—å —Ä–∞–∑–º–µ—Ä –º–∞—Ç—Ä–∏—Ü—ã –∑–∞ —Å—á—ë—Ç —Ç–æ—á–Ω–æ—Å—Ç–∏, –∏ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –º—ã –ø–æ–ª—É—á–∞–µ–º –Ω–µ—è–≤–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü—ã.

3. –ê–ª–≥–æ—Ä–∏—Ç–º–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü.
–ò–Ω–æ–≥–¥–∞ –º–∞—Ç—Ä–∏—Ü—ã –º–æ–≥—É—Ç –∑–∞–¥–∞–≤–∞—Ç—å—Å—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç —ç–ª–µ–º–µ–Ω—Ç—ã –ø–æ –º–µ—Ä–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏. –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –º–∞—Ç—Ä–∏—Ü–∞ —è–≤–ª—è–µ—Ç—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –Ω–µ–∫–æ—Ç–æ—Ä–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞, –µ—ë —ç–ª–µ–º–µ–Ω—Ç—ã –º–æ–≥—É—Ç –≤—ã—á–∏—Å–ª—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏, –∞ –Ω–µ —Ö—Ä–∞–Ω–∏—Ç—å—Å—è –≤ –ø–∞–º—è—Ç–∏ –∑–∞—Ä–∞–Ω–µ–µ.

4. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —ç–ª–µ–º–µ–Ω—Ç–æ–≤.
–í –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–ª—É—á–∞—è—Ö —ç–ª–µ–º–µ–Ω—Ç—ã –º–∞—Ç—Ä–∏—Ü—ã –º–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–µ–π, –∫–æ—Ç–æ—Ä–∞—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ –ø–æ –µ–≥–æ –∏–Ω–¥–µ–∫—Å—É. –¢–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ –æ—Å–æ–±–µ–Ω–Ω–æ –ø–æ–ª–µ–∑–µ–Ω, –∫–æ–≥–¥–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –æ—á–µ–Ω—å –±–æ–ª—å—à–∏–º–∏ –º–∞—Ç—Ä–∏—Ü–∞–º–∏ –∏–ª–∏ —Å –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–º–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—è–º–∏.

–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–µ—è–≤–Ω–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –º–∞—Ç—Ä–∏—Ü:
 - –≠–∫–æ–Ω–æ–º–∏—è –ø–∞–º—è—Ç–∏: –î–ª—è –±–æ–ª—å—à–∏—Ö –º–∞—Ç—Ä–∏—Ü —Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤, —Ç–æ–≥–¥–∞ –∫–∞–∫ –Ω–µ—è–≤–Ω–∞—è —Ñ–æ—Ä–º–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–∑–±–µ–∂–∞—Ç—å —ç—Ç–æ–≥–æ.
 - –ë–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π: –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–∞–¥ –º–∞—Ç—Ä–∏—Ü–∞–º–∏ –º–æ–≥—É—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –±—ã—Å—Ç—Ä–µ–µ, –µ—Å–ª–∏ –æ–Ω–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü–∏–∏, –∞ –Ω–µ —á–µ—Ä–µ–∑ –ø—Ä—è–º–æ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ –∫–∞–∂–¥–æ–º—É —ç–ª–µ–º–µ–Ω—Ç—É.

–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:
 - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –≤–∏–¥—ã –æ–ø–µ—Ä–∞—Ü–∏–π: –ù–µ –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –º–æ–∂–Ω–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å —Å –Ω–µ—è–≤–Ω–æ –∑–∞–¥–∞–Ω–Ω—ã–º–∏ –º–∞—Ç—Ä–∏—Ü–∞–º–∏. –ù–∞–ø—Ä–∏–º–µ—Ä, —Å–ª–æ–∂–µ–Ω–∏–µ –¥–≤—É—Ö –Ω–µ—è–≤–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö –º–∞—Ç—Ä–∏—Ü –º–æ–∂–µ—Ç —Ç—Ä–µ–±–æ–≤–∞—Ç—å –∏—Ö –ø–æ–ª–Ω–æ–≥–æ —Ä–∞—Å–∫—Ä—ã—Ç–∏—è.
 - –°–ª–æ–∂–Ω–æ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: –†–∞–±–æ—Ç–∞ —Å –Ω–µ—è–≤–Ω—ã–º –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ–º —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —É—Å–∏–ª–∏–π –ø—Ä–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤.
---
### –Ω–µ–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ: –ø—Ä–æ SVD_CYCLIC –∏ SVD_CYCLIC_SHELL ???

–í –∫–æ–¥–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ SLEPc —Å—Ç—Ä—É–∫—Ç—É—Ä—ã SVD_CYCLIC –∏ SVD_CYCLIC_SHELL –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –¥–ª—è —Ä–µ—à–µ–Ω–∏—è —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö –∑–∞–¥–∞—á (SVD, Singular Value Decomposition) –º–µ—Ç–æ–¥–æ–º —Ü–∏–∫–ª–∏—á–µ—Å–∫–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã. –û–Ω–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Å–æ–±–æ–π –¥–≤–∞ —É—Ä–æ–≤–Ω—è –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã—Ö –¥–ª—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π, —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å –º–∞—Ç—Ä–∏—Ü–∞–º–∏ –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è—Ö (–≤–∫–ª—é—á–∞—è GPU).
1. SVD_CYCLIC: –æ–±—â–∏–π —É—Ä–æ–≤–µ–Ω—å –¥–∞–Ω–Ω—ã—Ö

–≠—Ç–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –æ–±—â–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏ –æ–±—ä–µ–∫—Ç–æ–≤, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏–º –º–µ—Ç–æ–¥–æ–º SVD.

–ü–æ–ª–µ explicitmatrix (bool) –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ SVD_CYCLIC –∑–∞–¥–∞—ë—Ç, –∫–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω–∞ –º–∞—Ç—Ä–∏—Ü–∞ CC:

–ï—Å–ª–∏ *explicitmatrix = PETSC_TRUE*:
–ú–∞—Ç—Ä–∏—Ü–∞ —Å–æ–∑–¥–∞—ë—Ç—Å—è —è–≤–Ω–æ, –∫–∞–∫ –ø–æ–ª–Ω—ã–π –æ–±—ä–µ–∫—Ç –≤ –ø–∞–º—è—Ç–∏. –í—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã CC –≤—ã—á–∏—Å–ª—è—é—Ç—Å—è –∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –≤–∏–¥–µ –≥–æ—Ç–æ–≤–æ–π –º–∞—Ç—Ä–∏—Ü—ã.  
–ï—Å–ª–∏ *explicitmatrix = PETSC_FALSE*:
–ú–∞—Ç—Ä–∏—Ü–∞ CC –Ω–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è —è–≤–Ω–æ. –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è shell-–º–∞—Ç—Ä–∏—Ü–∞, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –¥–æ—Å—Ç—É–ø –∫ –æ–ø–µ—Ä–∞—Ü–∏—è–º –Ω–∞–¥ CC (–Ω–∞–ø—Ä–∏–º–µ—Ä, –º–∞—Ç—Ä–∏—á–Ω–æ-–≤–µ–∫—Ç–æ—Ä–Ω–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ) –±–µ–∑ –ø–æ–ª–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å—ç–∫–æ–Ω–æ–º–∏—Ç—å –ø–∞–º—è—Ç—å.

2. SVD_CYCLIC_SHELL: –¥–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

–≠—Ç–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ shell-–º–∞—Ç—Ä–∏—Ü—ã (—Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–π –∫—Ä–æ—Å—Å-–º–∞—Ç—Ä–∏—Ü—ã) –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –º–µ—Ç–æ–¥–æ–º. –û–Ω–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–∞–¥ –º–∞—Ç—Ä–∏—Ü–µ–π "–Ω–∞ –ª–µ—Ç—É", —ç–∫–æ–Ω–æ–º—è –ø–∞–º—è—Ç—å.
–ü–æ–ª—è:

–ó–∞—á–µ–º –Ω—É–∂–Ω—ã —ç—Ç–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã?
–î–ª—è —á–µ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **SVD_CYCLIC**?

–•—Ä–∞–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏ –æ–±—ä–µ–∫—Ç–æ–≤, —É–ø—Ä–∞–≤–ª—è—é—â–∏—Ö —Ä–∞–±–æ—Ç–æ–π –º–µ—Ç–æ–¥–∞.
–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–∏ —è–≤–Ω–æ–µ –∏–ª–∏ –Ω–µ—è–≤–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü—ã CC.
–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ä–µ—à–∞—Ç–µ–ª–µ–º —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π EPS –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö –∑–∞–¥–∞—á.

–î–ª—è —á–µ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **SVD_CYCLIC_SHELL**?

–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–∞—Ç—Ä–∏—Ü—ã CC –∫–∞–∫ shell-–æ–±—ä–µ–∫—Ç–∞ (–≤—ã—á–∏—Å–ª–µ–Ω–∏—è "–Ω–∞ –ª–µ—Ç—É"), —á—Ç–æ–±—ã —É–º–µ–Ω—å—à–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏.
–•—Ä–∞–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π —Å –º–∞—Ç—Ä–∏—Ü–µ–π CC, –≤–∫–ª—é—á–∞—è:
–í–µ–∫—Ç–æ—Ä—ã –¥–ª—è –º–∞—Ç—Ä–∏—á–Ω–æ-–≤–µ–∫—Ç–æ—Ä–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π.
–§–ª–∞–≥–∏ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ GPU.
–†–∞–±–æ—á–∏–µ –≤–µ–∫—Ç–æ—Ä—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è–º–∏ –ø–∞–º—è—Ç–∏ –Ω–∞ GPU.



### Generalized singular value decomposition ???
–í –ª–∏–Ω–µ–π–Ω–æ–π –∞–ª–≥–µ–±—Ä–µ –æ–±–æ–±—â–µ–Ω–Ω–∞—è —Å–∏–Ω–≥—É–ª—è—Ä–Ω–∞—è –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è (GSVD) - —ç—Ç–æ –Ω–∞–∑–≤–∞–Ω–∏–µ –¥–≤—É—Ö —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã—Ö –Ω–∞ —Å–∏–Ω–≥—É–ª—è—Ä–Ω–æ–π –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏–∏ (SVD). –≠—Ç–∏ –¥–≤–µ –≤–µ—Ä—Å–∏–∏ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è —Ç–µ–º, —á—Ç–æ –æ–¥–Ω–∞ –≤–µ—Ä—Å–∏—è —Ä–∞–∑–ª–∞–≥–∞–µ—Ç –¥–≤–µ –º–∞—Ç—Ä–∏—Ü—ã (—á—Ç–æ-—Ç–æ –≤—Ä–æ–¥–µ SVD –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–æ–≥–æ –ø–æ—Ä—è–¥–∫–∞ –∏–ª–∏ —Ç–µ–Ω–∑–æ—Ä–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã), –∞ –¥—Ä—É–≥–∞—è –≤–µ—Ä—Å–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–∞–±–æ—Ä –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π, –Ω–∞–ª–æ–∂–µ–Ω–Ω—ã—Ö –Ω–∞ –ª–µ–≤—ã–π –∏ –ø—Ä–∞–≤—ã–π —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä—ã SVD —Å –æ–¥–Ω–æ–π –º–∞—Ç—Ä–∏—Ü–µ–π.

**–ü—Ä–æ –æ–±–æ–±—â–µ–Ω–Ω—É—é –∑–∞–¥–∞—á—É:** –í —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –∑–∞–¥–∞—á–µ —Å–∏–Ω–≥—É–ª—è—Ä–Ω–æ–≥–æ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏—è –∏—â—É—Ç—Å—è —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏ –≤–µ–∫—Ç–æ—Ä—ã –º–∞—Ç—Ä–∏—Ü—ã A, —Ç–∞–∫–∏–µ —á—Ç–æ: 
$A = U * \Sigma * V$
#### –í –æ–±–æ–±—â—ë–Ω–Ω–æ–π –∑–∞–¥–∞—á–µ —Å–∏–Ω–≥—É–ª—è—Ä–Ω–æ–≥–æ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏—è —Ä–µ—à–∞–µ—Ç—Å—è –ø—Ä–æ–±–ª–µ–º–∞ –≤–∏–¥–∞:
$A x = \sigma B y, \quad A^T y = \sigma B^T x$   
–≥–¥–µ:
- $A$ –∏ $B$ ‚Äî –º–∞—Ç—Ä–∏—Ü—ã, –∑–∞–¥–∞—é—â–∏–µ –æ–±–æ–±—â—ë–Ω–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∑–∞–¥–∞—á–∏;
- $\sigma$ ‚Äî —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è;
- $x$ –∏ $y$ ‚Äî –æ–±–æ–±—â—ë–Ω–Ω—ã–µ —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä—ã.
---
* cross product (–ö—Ä–æ—Å—Å-–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ) == –≤–µ–∫—Ç–æ—Ä–Ω–æ–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ  

–í —ç—Ç–æ–º —Ñ–∞–π–ª–µ (–ø—Ä–∏–º–µ—Ä SVDCyclicGetECrossMat) –º–∞—Ç—Ä–∏—Ü–∞ –∫—Ä–æ—Å—Å –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è —ç—Ç–æ $A^T A$, –≥–¥–µ —ç–ª–µ–º–µ–Ω—Ç—ã –≤—ã—á–∏—Å–ª—è—é—Ç—Å—è –ø—Ä–æ—Å—Ç—ã–º –ø–µ—Ä–µ–º–Ω–æ–∂–µ–Ω–∏–µ–º —ç—Ç–∏—Ö –¥–≤—É—Ö –º–∞—Ç—Ä–∏—Ü. –ü—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å —ç—Ç–æ –≤ –∫—Ä–∞—Ç–∫–æ–π —Ñ–æ—Ä–º–µ –º–æ–∂–Ω–æ –∫–∞–∫:

$$ [A^T A]_{ij} = \sum_{k=1}^M A_{ki} \cdot A_{kj} $$

* extended (–†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è) –º–∞—Ç—Ä–∏—Ü–∞ –° –∑–∞–¥–∞—ë—Ç—Å—è –∫–∞–∫: 

$$
C = \begin{bmatrix}
I_m & 0 \\
0 & A^T A
\end{bmatrix}
$$

–≥–¥–µ $I_m$ - –µ–¥–∏–Ω–∏—á–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ —Ä–∞–∑–º–µ—Ä–∞ m –Ω–∞ m

## –û–ø–∏—Å–∞–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ 

### ```SVDCyclicGetCyclicMat(SVD svd,Mat A,Mat AT,Mat *C)``` 
—Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Ü–∏–∫–ª–∏—á–µ—Å–∫–æ–π –º–∞—Ç—Ä–∏—Ü—ã ùê∂ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ A –∏ $A^T$. –ü–æ–¥–¥–µ—Ä–∏–∂–≤–∞–µ—Ç—Å—è –∫–∞–∫ CUDA –∏ HIP (–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤), —Ç–∞–∫ CUDA –∏ HIP –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.

1. –ü—Ä–∏–≤–æ–¥–∏—Ç —É–∫–∞–∑–∞—Ç–µ–ª—å svd->data –∫ —Ç–∏–ø—É SVD_CYCLIC –∏ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö:
* ctx ‚Äî –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –Ω–µ—è–≤–Ω–æ–π-–º–∞—Ç—Ä–∏—Ü–µ–π.
* i ‚Äî –∏–Ω–¥–µ–∫—Å.
* M, N ‚Äî –≥–ª–æ–±–∞–ª—å–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã –º–∞—Ç—Ä–∏—Ü—ã ùê¥.
* m, n ‚Äî –ª–æ–∫–∞–ª—å–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã –º–∞—Ç—Ä–∏—Ü—ã ùê¥ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.
* Istart, Iend ‚Äî –Ω–∞—á–∞–ª–æ –∏ –∫–æ–Ω–µ—Ü –¥–∏–∞–ø–∞–∑–æ–Ω–∞ –∏–Ω–¥–µ–∫—Å–æ–≤ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.
* vtype ‚Äî —Ç–∏–ø –≤–µ–∫—Ç–æ—Ä–æ–≤, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –≤ –º–∞—Ç—Ä–∏—Ü–µ.
* Zm, Zn ‚Äî –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç—Ä–∏—Ü—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ü–∏–∫–ª–∏—á–µ—Å–∫–æ–π –º–∞—Ç—Ä–∏—Ü—ã.

2. –ü—Ä–æ–≤–µ—Ä–µ—è—Ç—Å—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–∏ CUDA –∏–ª–∏ HIP, —Ç–∞–∫ –∂–µ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–¥–∏–∞–ø–æ–∑–æ–Ω—ã –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤).
3. –û–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –∏ –ª–æ–∫–∞–ª—å–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã –º–∞—Ç—Ä–∏—Ü—ã A.
4. –ï—Å–ª–∏ –º–∞—Ç—Ä–∏—Ü–∞ –∑–∞–¥–∞–Ω–∞ —è–≤–Ω—ã–º –≤–∏–¥–æ–º, —Ç–æ:
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –¥–ª—è –æ–±—ä–µ–∫—Ç–∞ SVD: —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –æ–ø—Ü–∏—è —è–≤–Ω–æ–≥–æ —Ç—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –º–∞—Ç—Ä–∏—Ü—ã, –∏–Ω–∞—á–µ –≤—ã–¥–∞–µ—Ç—Å—è –æ—à–∏–±–∫–∞.
- –°–æ–∑–¥–∞–Ω–∏–µ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã $Z_m$, –≥–¥–µ –∑–∞–¥–∞—é—Ç—Å—è –µ—ë –ª–æ–∫–∞–ª—å–Ω—ã–µ –∏ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã.
- –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –¥–∏–∞–ø–∞–∑–æ–Ω —Å—Ç—Ä–æ–∫, –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—â–∏—Ö —Ç–µ–∫—É—â–µ–º—É –ø—Ä–æ—Ü–µ—Å—Å—É. –ó–∞—Ç–µ–º –¶–∏–∫–ª –ø—Ä–æ—Ö–æ–¥–∏—Ç –ø–æ —Å—Ç—Ä–æ–∫–∞–º –≤ —ç—Ç–æ–º –¥–∏–∞–ø–∞–∑–æ–Ω–µ –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –≤ 0.
‚Äã- –ü—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å–±–æ—Ä–∫–∞ –º–∞—Ç—Ä–∏—Ü–∞ –∏ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è.
- –ê–Ω–∞–ª–æ–≥–∏—á–Ω–∞—è –∏–Ω–∏—Ü–∏–ª–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–∞—Ç—Ä–∏—Ü—ã $Z_n$.
- –ó–∞—Ç–µ–º —Å—Ç—Ä–æ–∏—Ç—Å—è –º–∞—Ç—Ä–∏—Ü–∞ —Ü–∏–∫–ª–∏—á–µ—Å–∫–∞—è –º–∞—Ç—Ä–∏—Ü–∞ C.
- –£–¥–∞–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–∞—Ç—Ä–∏—Ü $Z_n$ –∏ $Z_m$
5. –ò–Ω–∞—á–µ, –µ—Å–ª–∏ –º–∞—Ç—Ä–∏—Ü–∞ –∑–∞–¥–∞–Ω—ã –Ω–µ—è–≤–Ω—ã–º –≤–∏–¥–æ–º, —Ç–æ:
- –°–æ–∑–¥–∞–µ—Ç—Å—è –æ–±—ä–µ–∫—Ç ctx, –∫–æ—Ç–æ—Ä—ã–π —Ö—Ä–∞–Ω–∏—Ç—Å—è —Ö—Ä–∞–Ω—è—â–∞—è —É–∫–∞–∑–∞—Ç–µ–ª–∏ –º–∞—Ç—Ä–∏—Ü—É –Ω–∞ A, $A^T$ –∏ —Ñ–ª–∞–≥ swapped.
- –°–æ–∑–¥–∞–Ω–∏–µ shell-–Ω–µ—è–≤–Ω–æ–π –º–∞—Ç—Ä–∏—Ü–∞ —Å–æ–≥–ª–∞—Å–Ω–æ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É.
- –°–æ–∑–¥–∞—é—Ç—Å—è –ø—É—Å—Ç—ã–µ –≤–µ–∫—Ç–æ—Ä—ã, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ –º–∞—Ç—Ä–∏—Ü—ã A, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è, –Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –æ–ø–µ—Ä–∞—Ü–∏–π —Å –º–∞—Ç—Ä–∏—Ü–µ–π A.
- –°–æ–∑–¥–∞–Ω–∏–µ –Ω–µ—è–≤–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–µ–π –∏ –º–∞—Ç—Ä–∏—Ü A –∏ $A^T$, —É—á–∏—Ç—ã–≤–∞—è —Ä–∞—Å–ø–∞—Ä–∞–ª–ª–µ–ª–∏–≤–∞–Ω–∏–µ.
- –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–∑–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –¥–ª—è –º–∞—Ç—Ä–∏—Ü—ã C.
6. –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ CUDA(GPU), HIP –∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞.
 
```
static PetscErrorCode SVDCyclicGetCyclicMat(SVD svd,Mat A,Mat AT,Mat *C)
{
  SVD_CYCLIC       *cyclic = (SVD_CYCLIC*)svd->data;
  SVD_CYCLIC_SHELL *ctx;
  PetscInt         i,M,N,m,n,Istart,Iend;
  VecType          vtype;
  Mat              Zm,Zn;
#if defined(PETSC_HAVE_CUDA) || defined(PETSC_HAVE_HIP)
  PetscBool        gpu;
  const PetscInt   *ranges;
  PetscMPIInt      size;
#endif

  PetscFunctionBegin;
  PetscCall(MatGetSize(A,&M,&N));
  PetscCall(MatGetLocalSize(A,&m,&n));

  if (cyclic->explicitmatrix) {
    PetscCheck(svd->expltrans,PetscObjectComm((PetscObject)svd),PETSC_ERR_SUP,"Cannot use explicit cyclic matrix with implicit transpose");
    PetscCall(MatCreate(PetscObjectComm((PetscObject)svd),&Zm));
    PetscCall(MatSetSizes(Zm,m,m,M,M));
    PetscCall(MatSetFromOptions(Zm));
    PetscCall(MatGetOwnershipRange(Zm,&Istart,&Iend));
    for (i=Istart;i<Iend;i++) PetscCall(MatSetValue(Zm,i,i,0.0,INSERT_VALUES));
    PetscCall(MatAssemblyBegin(Zm,MAT_FINAL_ASSEMBLY));
    PetscCall(MatAssemblyEnd(Zm,MAT_FINAL_ASSEMBLY));
    PetscCall(MatCreate(PetscObjectComm((PetscObject)svd),&Zn));
    PetscCall(MatSetSizes(Zn,n,n,N,N));
    PetscCall(MatSetFromOptions(Zn));
    PetscCall(MatGetOwnershipRange(Zn,&Istart,&Iend));
    for (i=Istart;i<Iend;i++) PetscCall(MatSetValue(Zn,i,i,0.0,INSERT_VALUES));
    PetscCall(MatAssemblyBegin(Zn,MAT_FINAL_ASSEMBLY));
    PetscCall(MatAssemblyEnd(Zn,MAT_FINAL_ASSEMBLY));
    PetscCall(MatCreateTile(1.0,Zm,1.0,A,1.0,AT,1.0,Zn,C));
    PetscCall(MatDestroy(&Zm));
    PetscCall(MatDestroy(&Zn));
  } else {
    PetscCall(PetscNew(&ctx));
    ctx->A       = A;
    ctx->AT      = AT;
    ctx->swapped = svd->swapped;
    PetscCall(MatCreateVecsEmpty(A,&ctx->x2,&ctx->x1));
    PetscCall(MatCreateVecsEmpty(A,&ctx->y2,&ctx->y1));
    PetscCall(MatCreateShell(PetscObjectComm((PetscObject)svd),m+n,m+n,M+N,M+N,ctx,C));
    PetscCall(MatShellSetOperation(*C,MATOP_GET_DIAGONAL,(void(*)(void))MatGetDiagonal_Cyclic));
    PetscCall(MatShellSetOperation(*C,MATOP_DESTROY,(void(*)(void))MatDestroy_Cyclic));
#if defined(PETSC_HAVE_CUDA)
    PetscCall(PetscObjectTypeCompareAny((PetscObject)(svd->swapped?AT:A),&gpu,MATSEQAIJCUSPARSE,MATMPIAIJCUSPARSE,""));
    if (gpu) PetscCall(MatShellSetOperation(*C,MATOP_MULT,(void(*)(void))MatMult_Cyclic_CUDA));
    else
#elif defined(PETSC_HAVE_HIP)
    PetscCall(PetscObjectTypeCompareAny((PetscObject)(svd->swapped?AT:A),&gpu,MATSEQAIJHIPSPARSE,MATMPIAIJHIPSPARSE,""));
    if (gpu) PetscCall(MatShellSetOperation(*C,MATOP_MULT,(void(*)(void))MatMult_Cyclic_HIP));
    else
#endif
      PetscCall(MatShellSetOperation(*C,MATOP_MULT,(void(*)(void))MatMult_Cyclic));
    PetscCall(MatGetVecType(A,&vtype));
    PetscCall(MatSetVecType(*C,vtype));
#if defined(PETSC_HAVE_CUDA) || defined(PETSC_HAVE_HIP)
    if (gpu) {
      /* check alignment of bottom block */
      PetscCallMPI(MPI_Comm_size(PetscObjectComm((PetscObject)ctx->x1),&size));
      PetscCall(VecGetOwnershipRanges(ctx->x1,&ranges));
      for (i=0;i<size;i++) {
        ctx->misaligned = (((ranges[i+1]-ranges[i])*sizeof(PetscScalar))%16)? PETSC_TRUE: PETSC_FALSE;
        if (ctx->misaligned) break;
      }
      if (ctx->misaligned) {  /* create work vectors for MatMult */
        PetscCall(VecDuplicate(ctx->x2,&ctx->wx2));
        PetscCall(VecDuplicate(ctx->y2,&ctx->wy2));
      }
    }
#endif
  }
  PetscFunctionReturn(PETSC_SUCCESS);
}
```

### MatGetDiagonal_ECross(Mat B,Vec d) - —Ñ—É–∫–Ω—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –≥–ª–∞–≤–Ω–æ–π –¥–∏–∞–≥–æ–Ω–∞–ª–∏ –º–∞—Ç—Ä–∏—Ü—ã B, –∑–∞–¥–∞–Ω–Ω–∞—è –Ω–µ—è–≤–Ω—ã–º –æ–±—Ä–∞–∑–æ–º.
1. –û–±—ä—è–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö:
* ctx: –∫–æ–Ω—Ç–µ–∫—Å—Ç shell-–º–∞—Ç—Ä–∏—Ü—ã, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –¥–∞–Ω–Ω—ã–µ –¥–ª—è –µ—ë –æ–±—Ä–∞–±–æ—Ç–∫–∏.
* pd: —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –º–∞—Å—Å–∏–≤ –¥–∞–Ω–Ω—ã—Ö –≤–µ–∫—Ç–æ—Ä–∞ d.
* len: –¥–ª–∏–Ω–∞ –º–∞—Å—Å–∏–≤–æ–≤ (–≤ —Ñ–æ—Ä–º–∞—Ç–µ MPI).
* mn, m, n, N: —Ä–∞–∑–º–µ—Ä—ã –ª–æ–∫–∞–ª—å–Ω—ã—Ö –∏ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –º–∞—Ç—Ä–∏—Ü –∏ –≤–µ–∫—Ç–æ—Ä–æ–≤.
* start, end: –¥–∏–∞–ø–∞–∑–æ–Ω —Å—Ç—Ä–æ–∫, –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—â–∏—Ö —Ç–µ–∫—É—â–µ–º—É –ø—Ä–æ—Ü–µ—Å—Å—É.
* ncols: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç–æ–ª–±—Ü–æ–≤.
* work1, work2: –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–∞—Å—Å–∏–≤—ã –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π.
* diag: —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –º–∞—Å—Å–∏–≤ –¥–∞–Ω–Ω—ã—Ö –¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω–æ–≥–æ –≤–µ–∫—Ç–æ—Ä–∞.
2. –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –Ω–µ—è–≤–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã A ($A^T$, –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä–∞ –∏ —Ç –¥) –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä ctx. –ü–æ–ª—É—á–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ n —Å—Ç–æ–ª–±—Ü–æ–≤ –º–∞—Ç—Ä–∏—Ü—ã –ê, –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ mn –≤–µ–∫—Ç–æ—Ä–∞ d. –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —á–∏—Å–ª–∞ —Å—Ç—Ä–æ–∫: m=mn-n.
3. –ü–æ–ª—É—á–µ–Ω–∏–µ —É–∫–∞–∑–∞—Ç–µ–ª—è –Ω–∞ –≤–µ–∫—Ç–æ—Ä pd –∏ –ø—Ä–∏–≤—è–∑–∫–∞ –µ–≥–æ –∫ –≤–µ—Ç–∫–æ—Ä—É ctx->y1. –ò–Ω–∏—Ü–∏–ª–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤–µ—Ç–æ—Ä–∞ *pd = ctx->y1 (–≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤–µ–∫—Ç–æ—Ä–∞ —Ä–∞–≤–Ω—ã 1). –ó–∞—Ç–µ–º –æ—Ç–º–µ–Ω–∞ –ø—Ä–∏–≤—è–∑–∫–∏.
4. –ü—Ä–∏–≤—è–∑–∫–∞ –≤—Ç–æ—Ä–æ–π —á–∞—Å—Ç–∏ –º–∞—Å—Å–∏–≤–∞ pd –∫ –≤–µ–∫—Ç–æ—Ä—É ctx->y2.
5. –ï—Å–ª–∏ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω–æ–π:
6. –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –¥—É–±–ª–∏–∫–∞—Ç–∞ –¥–ª—è ctx->y2.
7. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–∞—Å—Å–∏–≤–æ–≤ work1 –∏ work2
8. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –º–∞—Ç—Ä–∏—Ü–∞ —Ç—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–π, —Ç–æ –º—ã –ø–æ–ª—É—á–∞–µ–º –¥–∏–∞–ø–æ–∑–æ–Ω –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ HIP(MPI) –¥–ª—è —Ç—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –º–∞—Ç—Ä–∏—Ü–∞ $A^T$.
- –¶–∏–∫–ª, –∫–æ—Ç–æ—Ä–æ—ã–π –ø—Ä–æ—Ö–æ–¥–∏—Ç –ø–æ –≤—Å–µ–º —Å—Ç—Ä–æ–∫–∞–º –º–∞—Ç—Ä–∏—Ü—ã $A^T$, –≤—Ö–æ–¥—è—â–∏—Ö –≤ –¥–∏–∞–ø–æ–∑–æ–Ω —Ç–µ–∫—É—â–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞, MatGetRow –∏–∑–≤–ª–µ–∫–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–æ–∫–∏: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç–æ–ª–±—Ü–æ–≤ (ncols) –∏ –∑–Ω–∞—á–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å—Ç—Ä–æ–∫–∏ (vals).
- –ö–≤–∞–¥—Ä–∞—Ç—ã –∑–Ω–∞—á–µ–Ω–∏–π —Å—Ç—Ä–æ–∫–∏ vals[j] —Å—É–º–º–∏—Ä—É—é—Ç—Å—è –≤ work1[i]. –ü–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å—Ç—Ä–æ–∫–∏ –¥–∞–Ω–Ω—ã–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ MatRestoreRow.
9. –ï—Å–ª–∏ —è–≤—Ç—è–µ—Ç—Å—è —è–≤–ª—è–µ—Ç—Å—è —Ç—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –º–∞—Ç—Ä–∏—Ü–µ–π, —Ç–æ –º—ã –¥–µ–ª–∞–µ–º –≤—Å–µ —Ç–æ –∂–µ —Å–∞–º–æ–µ –∏–∑ –ø—É–Ω–∫—Ç–∞ 8, —Ç–æ–ª—å–∫–æ –¥–ª—è –º–∞—Ç—Ä–∏—Ü—ã A, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∞ —É–∂–µ —è–≤–ª—è–µ—Ç—Å—è —Ç—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–π.
10. –ó–∞—Ç–µ–º –∏–¥–µ—Ç —Ä–∞–±–æ—Ç—ã –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ HIP(MPI): –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–æ–≤ –≤ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã, –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤—ã—á–∏—Å–ª–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –≤ –º–∞—Å—Å–∏–≤ wokr2.
11. –ò–¥–µ—Ç –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ HIP(MPI), –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ü–∏–∫–ª –≤ –¥–∏–∞–ø–æ–∑–æ–Ω–µ, –ø–æ–ª—É—á–µ–Ω–Ω—ã–º –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞, –∫–æ—Ç–æ—Ä—ã–π –¥–µ–ª–∞–µ—Ç –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω—É—é —á–∞—Å—Ç—å –≤–µ–∫—Ç–æ—Ä–∞ work2 –≤ –ª–æ–∫–∞–ª—å–Ω—É—é —á–∞—Å—Ç—å –≤–µ–∫—Ç–æ—Ä–∞ diag. 
12. –ó–∞—Ç–µ–º –∏–¥–µ—Ç —É–¥–∞–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ work2.
13. –ö–æ–ø–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ ctx->diag –≤ –≤–µ–∫—Ç–æ—Ä ctx->y2. VecResetArray –æ—Ç–º–µ–Ω—è–µ—Ç —Å–≤—è–∑—å –º–∞—Å—Å–∏–≤–∞ –¥–∞–Ω–Ω—ã—Ö —Å –≤–µ–∫—Ç–æ—Ä–æ–º ctx->y2. VecRestoreArrayWrite –∑–∞–≤–µ—Ä—à–∞–µ—Ç –∑–∞–ø–∏—Å—å
```
static PetscErrorCode MatGetDiagonal_ECross(Mat B,Vec d)
{
  SVD_CYCLIC_SHELL  *ctx;
  PetscScalar       *pd;
  PetscMPIInt       len;
  PetscInt          mn,m,n,N,i,j,start,end,ncols;
  PetscScalar       *work1,*work2,*diag;
  const PetscInt    *cols;
  const PetscScalar *vals;

  PetscFunctionBegin;
  PetscCall(MatShellGetContext(B,&ctx));
  PetscCall(MatGetLocalSize(ctx->A,NULL,&n));
  PetscCall(VecGetLocalSize(d,&mn));
  m = mn-n;
  PetscCall(VecGetArrayWrite(d,&pd));
  PetscCall(VecPlaceArray(ctx->y1,pd));
  PetscCall(VecSet(ctx->y1,1.0));
  PetscCall(VecResetArray(ctx->y1));
  PetscCall(VecPlaceArray(ctx->y2,pd+m));
  if (!ctx->diag) {
    /* compute diagonal from rows and store in ctx->diag */
    PetscCall(VecDuplicate(ctx->y2,&ctx->diag));
    PetscCall(MatGetSize(ctx->A,NULL,&N));
    PetscCall(PetscCalloc2(N,&work1,N,&work2));
    if (ctx->swapped) {
      PetscCall(MatGetOwnershipRange(ctx->AT,&start,&end));
      for (i=start;i<end;i++) {
        PetscCall(MatGetRow(ctx->AT,i,&ncols,NULL,&vals));
        for (j=0;j<ncols;j++) work1[i] += vals[j]*vals[j];
        PetscCall(MatRestoreRow(ctx->AT,i,&ncols,NULL,&vals));
      }
    } else {
      PetscCall(MatGetOwnershipRange(ctx->A,&start,&end));
      for (i=start;i<end;i++) {
        PetscCall(MatGetRow(ctx->A,i,&ncols,&cols,&vals));
        for (j=0;j<ncols;j++) work1[cols[j]] += vals[j]*vals[j];
        PetscCall(MatRestoreRow(ctx->A,i,&ncols,&cols,&vals));
      }
    }
    PetscCall(PetscMPIIntCast(N,&len));
    PetscCallMPI(MPIU_Allreduce(work1,work2,len,MPIU_SCALAR,MPIU_SUM,PetscObjectComm((PetscObject)B)));
    PetscCall(VecGetOwnershipRange(ctx->diag,&start,&end));
    PetscCall(VecGetArrayWrite(ctx->diag,&diag));
    for (i=start;i<end;i++) diag[i-start] = work2[i];
    PetscCall(VecRestoreArrayWrite(ctx->diag,&diag));
    PetscCall(PetscFree2(work1,work2));
  }
  PetscCall(VecCopy(ctx->diag,ctx->y2));
  PetscCall(VecResetArray(ctx->y2));
  PetscCall(VecRestoreArrayWrite(d,&pd));
  PetscFunctionReturn(PETSC_SUCCESS);
}
```

### SVDSetUp_Cyclic(SVD svd) - —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫—É –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è —Å–∏–Ω–≥—É–ª—è—Ä–Ω–æ–≥–æ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏—è –≤ —Ü–∏–∫–ª–∏—á–µ—Å–∫–æ–º –º–µ—Ç–æ–¥–µ:
#### - –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∏ —Å–æ–∑–¥–∞—ë—Ç –º–∞—Ç—Ä–∏—Ü—ã, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞.
#### - –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã EPS.
#### - –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ç–æ—á–Ω–æ—Å—Ç–∏, —Ä–∞–∑–º–µ—Ä—ã –ø–æ–¥–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤ –∏ –∫—Ä–∏—Ç–µ—Ä–∏–∏ —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏.
#### - –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫—É –¥–ª—è –æ–±–æ–±—â–µ–Ω–Ω—ã—Ö (GSVD = Generalized singular value decomposition) –∏ –≥–∏–ø–µ—Ä–±–æ–ª–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞—á.

1. –ü—Ä–∏–≤–æ–¥–∏—Ç —É–∫–∞–∑–∞—Ç–µ–ª—å svd->data –∫ —Ç–∏–ø—É SVD_CYCLIC –∏ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö:
* ctx ‚Äî –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –Ω–µ—è–≤–Ω–æ–π-–º–∞—Ç—Ä–∏—Ü–µ–π.
* M, N ‚Äî –≥–ª–æ–±–∞–ª—å–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã –º–∞—Ç—Ä–∏—Ü—ã ùê¥.
* new - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è;
* ncv - –Ω–æ–º–µ—Ä –±–∞–∑–∏—Å–Ω–æ–≥–æ –≤–µ–∫—Ç–æ—Ä–∞;
* mpd - –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –ø—Ä–æ–µ–∫—Ç–∏—Ä—É–µ–º–æ–π –∑–∞–¥–∞—á–∏;
* m, n ‚Äî –ª–æ–∫–∞–ª—å–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã –º–∞—Ç—Ä–∏—Ü—ã ùê¥ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.
* nev, ncv, mpd - –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π (—á–∏—Å–ª–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π, —Ä–∞–∑–º–µ—Ä –ø–æ–¥–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞, –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –ø–æ–¥–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞).
* tol - —Ç–æ—á–Ω–æ—Å—Ç—å –≤—ã—á–∏—Å–ª–µ–Ω–∏–π.
* maxit - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ —á–∏—Å–ª–æ –∏—Ç–µ—Ä–∞—Ü–∏–π.
* *isa,*oa, *va - —É–∫–∞–∑–∞—Ç–µ–ª–∏ –Ω–∞ –º–∞—Å—Å–∏–≤—ã –¥–∞–Ω–Ω—ã—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, —ç–ª–µ–º–µ–Ω—Ç—ã –≤–µ–∫—Ç–æ—Ä–æ–≤).
* ptype - —Ç–∏–ø –∑–∞–¥–∞—á–∏ –¥–ª—è EPS;
* trackall - –¥–æ–ª–∂–Ω—ã –ª–∏ –±—ã—Ç—å –≤—ã—á–∏—Å–ª–µ–Ω—ã –≤—Å–µ –æ—Å—Ç–∞—Ç–∫–∏;
* issinv;
* v,t;
* st - –æ–±—ä–µ–∫—Ç —Å–ø–µ–∫—Ç—Ä–∞–ª—å–Ω–æ–≥–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è;
* Omega - –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –¥–ª—è –≥–∏–ø–µ—Ä–±–æ–ª–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞—á;
* Atype;

2. –ò–∑–≤–ª–µ–∫–∞—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –∏–∑ –æ–±—ä–µ–∫—Ç–∞ svd. –°—á–∏—Ç—ã–≤–∞—é—Ç—Å—è —Ä–∞–∑–º–µ—Ä—ã –≥–ª–æ–±–∞–ª—å–Ω–æ–π (M, N) –∏ –ª–æ–∫–∞–ª—å–Ω–æ–π (m, n) –º–∞—Ç—Ä–∏—Ü—ã svd->A.
3. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –æ–±—ä–µ–∫—Ç EPS –¥–ª—è —Ä–µ—à–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π, –µ—Å–ª–∏ –Ω–µ—Ç —Ç–æ —Å–æ–∑–¥–∞–µ—Ç—Å—è –æ–±—ä–µ–∫—Ç.
4. –ï—Å–ª–∏ —Ä–∞–Ω–µ–µ —Å–æ–∑–¥–∞–≤–∞–ª–∏—Å—å –º–∞—Ç—Ä–∏—Ü—ã cyclic->C –∏ cyclic->D, –æ–Ω–∏ —É–¥–∞–ª—è—é—Ç—Å—è.
5. –ï—Å–ª–∏ —è–≤–ª—è–µ—Ç—Å—è –∑–∞–¥–∞—á–∞ –æ–±–æ–±—â—ë–Ω–Ω—ã–º —Ç–∏–ø–æ–º —Å–∏–Ω–≥—É–ª—è—Ä–Ω–æ–≥–æ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏—è.
- 5.1 –ï—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞–π—Ç–∏ –Ω–∞–∏–º–µ–Ω—å—à–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è —Ç–æ —Å–æ–∑–¥–∞—é—Ç—Å—è –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç—Ä–∏—Ü—ã C (–Ω–∞ –æ—Å–Ω–æ–≤–µ B –∏ $B^T) –∏ D(–Ω–∞ –æ—Å–Ω–æ–≤–µ A –∏ $A^T).
- 5.2 –ò–Ω–∞—á–µ, —Ç–æ –∂–µ —Å–æ–∑–¥–∞—é—Ç—Å—è –º–∞—Ç—Ä–∏—Ü—ã C –∏ D, —Ç–æ–ª—å–∫–æ –º–µ—Å—Ç–∞–º–∏ –Ω–∞–æ–±–æ—Ä–æ—Ç.
- 5.3 –û–ø–µ—Ä–∞—Ç–æ—Ä C –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–æ–π, D ‚Äî –∫–∞–∫ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ª–∏ —Ç–∏–ø –∑–∞–¥–∞—á–∏ ptype. –ï—Å–ª–∏ –Ω–µ—Ç, —Ç–æ —Ç–∏–ø –∑–∞–¥–∞–µ—Ç—Å—è —ç—Ä–º–∏—Ç–æ–≤–æ–π —Ç–∏–ø –∑–∞–¥–∞—á–∏.
6. –ï—Å–ª–∏ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –æ–±–æ–±—â–µ–Ω–Ω—ã–º —Ç–∏–ø–æ–º. –ò —è–≤–ª—è–µ—Ç—Å—è –≥–∏–ø–µ—Ä–±–æ–ª–∏—á–µ—Å–∫–∏–º —Ç–∏–ø–æ–º:
- 6.1 –°—Ç—Ä–æ–∏—Ç —Ü–∏–∫–ª–∏—á–µ—Å–∫—É—é –º–∞—Ç—Ä–∏—Ü—É C —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º A –∏ –µ–µ —Ç—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–π $A^T$. –∏ –°–æ–∑–¥–∞–µ—Ç –≤–µ–∫—Ç–æ—Ä v, —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π —Å C, –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –µ–≥–æ –µ–¥–∏–Ω–∏—Ü–∞–º–∏.
- 6.2 –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –¥–æ—Å—Ç—É–ø –∫ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º –¥–∞–Ω–Ω—ã–º –≤–µ–∫—Ç–æ—Ä–∞ svd->omega –¥–ª—è —á—Ç–µ–Ω–∏—è. –ü–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ —ç–ª–µ–º–µ–Ω—Ç–∞–º –≤–µ–∫—Ç–æ—Ä–∞ œâ –≤ –≤–∏–¥–µ –º–∞—Å—Å–∏–≤–∞ oa
- 6.3 –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –º–∞—Ç—Ä–∏—Ü–∞ —Ç—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–π, —Ç–æ –∫–æ–ø–∏—Ä—É–µ—Ç n —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏–∑ oa –≤ va + m, –∏–Ω–∞—á–µ –∫–æ–ø–∏—Ä—É–µ—Ç m —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏–∑ oa –≤ va.
- 6.4 –£–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –º–∞—Å—Å–∏–≤–∞–º–∏ –∑–∞–≤–µ—Ä—à–µ–Ω—ã, –∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ.
- 6.5 –ü–æ–ª—É—á–∞–µ—Ç —Ç–∏–ø –º–∞—Ç—Ä–∏—Ü—ã –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ svd->OP. –°–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—É—é –º–∞—Ç—Ä–∏—Ü—É Omega —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º–∏ —Ä–∞–∑–º–µ—Ä–∞–º–∏ –∏ —Ç–∏–ø–æ–º. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã Omega, –∏—Å–ø–æ–ª—å–∑—É—è –≤–µ–∫—Ç–æ—Ä v.
- 6.6 –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç C –∏ Omega –∫–∞–∫ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã –¥–ª—è —Ä–µ—à–∞—Ç–µ–ª—è EPS. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ç–∏–ø –∑–∞–¥–∞—á–∏ –∫–∞–∫ EPS_GHIEP (–æ–±–æ–±—â–µ–Ω–Ω–∞—è –≥–∏–ø–µ—Ä–±–æ–ª–∏—á–µ—Å–∫–∞—è –∑–∞–¥–∞—á–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π). –ó–∞—Ç–µ–º —É–¥–∞–ª—è—é—Ç—Å—è –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–∞—Ç—Ä–∏—Ü–∞ Omega –∏ –≤–µ–∫—Ç–æ—Ä v.
- 6.7 –ï—Å–ª–∏ –Ω–µ –≥–∏–ø–µ—Ä–±–æ–ª–∏—á–µ—Å–∫–æ–≥–æ —Ç–∏–ø–∞ (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ —Ç–∏–ø–∞), —Ç–æ —Å—Ç—Ä–æ–∏—Ç C, –∏—Å–ø–æ–ª—å–∑—É—è A –∏ $A^T$. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç C –∫–∞–∫ –æ–ø–µ—Ä–∞—Ç–æ—Ä –¥–ª—è —Ä–µ—à–∞—Ç–µ–ª—è EPS. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ç–∏–ø –∑–∞–¥–∞—á–∏ –∫–∞–∫ EPS_HEP (—ç—Ä–º–∏—Ç–æ–≤–∞ –∑–∞–¥–∞—á–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π).
7. –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏–ª —Ç–∏–ø —Ä–µ—à–µ–Ω–∏—è EPS –¥–ª—è —Ä–µ—à–∞—Ç–µ–ª—è EPS, —Ç–æ:
- 7.1 –ï—Å–ª–∏ –≤—ã—á–∏—Å–ª—è—é—Ç—Å—è –Ω–∞–∏–±–æ–ª—å—à–∏–µ —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, —Ç–æ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Å–ø–µ–∫—Ç—Ä–∞–ª—å–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ç–∏–ø–∞ STSINVERT (–º–µ—Ç–æ–¥ —Å–¥–≤–∏–≥–∞-–∏–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (shift-invert)).
- 7.2 –ï—Å–ª–∏ –¥–∞, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ä–µ—à–∞—Ç–µ–ª—å EPS –¥–ª—è –ø–æ–∏—Å–∫–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤–±–ª–∏–∑–∏ –≤–µ–ª–∏—á–∏–Ω—ã EPS_TARGET_MAGNITUDE.
- 7.3 –ï—Å–ª–∏ –∑–∞–¥–∞—á–∞ –≥–∏–ø–µ—Ä–±–æ–ª–∏—á–µ—Å–∫–∞—è, —Ç–æ –∏—â—É—Ç—Å—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å –Ω–∞–∏–±–æ–ª—å—à–µ–π –≤–µ–ª–∏—á–∏–Ω–æ–π.
- 7.4 –ò–Ω–∞—á–µ –Ω–∞—Ü–µ–ª–∏–≤–∞–µ—Ç—Å—è –Ω–∞ –Ω–∞–∏–±–æ–ª—å—à–∏–µ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è.
- 7.5 –ï—Å–ª–∏ –Ω–µ –Ω–∞–∏–±–æ–ª—å—à–µ–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, —Ç–æ –î–ª—è –æ–±–æ–±—â–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ä–µ—à–∞—Ç–µ–ª—å EPS –¥–ª—è –ø–æ–∏—Å–∫–∞ –Ω–∞–∏–±–æ–ª—å—à–∏—Ö –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.
- 7.6 –î–ª—è –≥–∏–ø–µ—Ä–±–æ–ª–∏—á–µ—Å–∫–∏—Ö –∏–ª–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –∑–∞–¥–∞—á —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —Ä–µ—à–∞—Ç–µ–ª—å EPS –¥–ª—è –ø–æ–∏—Å–∫–∞ –Ω–∞–∏–º–µ–Ω—å—à–∏—Ö –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.
8. –ü–æ–ª—É—á–∞–µ—Ç —Ç–µ–∫—É—â–∏–µ —Ä–∞–∑–º–µ—Ä—ã (nev, ncv, mpd) –∏–∑ —Ä–µ—à–∞—Ç–µ–ª—è EPS. –£–±–µ–∂–¥–∞–µ—Ç—Å—è, —á—Ç–æ —á–∏—Å–ª–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π nev –Ω–µ –º–µ–Ω—å—à–µ –¥–≤–æ–π–Ω–æ–≥–æ —á–∏—Å–ª–∞ —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π svd->nsv. –û–±–Ω–æ–≤–ª—è–µ—Ç nev, ncv –∏ mpd, –µ—Å–ª–∏ –æ–Ω–∏ —Ä–∞–Ω–µ–µ –Ω–µ –±—ã–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã.
9. –ü–æ–ª—É—á–∞–µ—Ç —Ç–µ–∫—É—â—É—é —Ç–æ—á–Ω–æ—Å—Ç—å –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Ç–µ—Ä–∞—Ü–∏–π. –ï—Å–ª–∏ –æ–Ω–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∏–∑ svd –∏–ª–∏ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≤ —Ä–µ—à–∞—Ç–µ–ª–µ EPS.
10. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ç–µ—Å—Ç —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –¥–ª—è —Ä–µ—à–∞—Ç–µ–ª—è EPS –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫—Ä–∏—Ç–µ—Ä–∏—è —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏ SVD (svd->conv). 
11. –î–ª—è –∞–±—Å–æ–ª—é—Ç–Ω–æ–≥–æ, –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∏ –æ—Å–Ω–æ–≤–∞–Ω–Ω–æ–≥–æ –Ω–∞ –Ω–æ—Ä–º–µ —Ç–∏–ø–æ–≤ —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏.
12. –î–ª—è –æ–±–æ–±—â–µ–Ω–Ω–æ–≥–æ SVD —Å —Å—Ö–æ–¥–∏–º–æ—Å—Ç—å—é –ø–æ –Ω–æ—Ä–º–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏ EPSConv_Cyclic.
13. –í—ã–∑—ã–≤–∞–µ—Ç –æ—à–∏–±–∫—É –¥–ª—è –Ω–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö —Ç–∏–ø–æ–≤ —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏.
14. –ü–µ—Ä–µ–¥–∞–µ—Ç –æ–ø—Ü–∏—é trackall –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ SVD –≤ —Ä–µ—à–∞—Ç–µ–ª—å EPS, —É–∫–∞–∑—ã–≤–∞—è, —Å–ª–µ–¥—É–µ—Ç –ª–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –≤—Å–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤–æ –≤—Ä–µ–º—è –∏—Ç–µ—Ä–∞—Ü–∏–π.
15.  –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∑–∞–¥–∞–Ω–æ –ª–∏ –Ω–∞—á–∞–ª—å–Ω–æ–µ –ø–æ–¥–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –¥–ª—è –ª–µ–≤—ã—Ö (svd->ISL) –∏–ª–∏ –ø—Ä–∞–≤—ã—Ö (svd->IS) —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤, —Ç–æ
- 15.1 –ü–µ—Ä–µ–±–∏—Ä–∞–µ—Ç –Ω–∞—á–∞–ª—å–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä—ã, —á—Ç–æ–±—ã –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –∏—Ö –¥–ª—è —Ä–µ—à–∞—Ç–µ–ª—è EPS.
- 15.2 –°–æ–∑–¥–∞–µ—Ç –≤–µ–∫—Ç–æ—Ä v, —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π —Å –º–∞—Ç—Ä–∏—Ü–µ–π C. –ü–æ–ª—É—á–∞–µ—Ç –¥–æ—Å—Ç—É–ø –¥–ª—è –∑–∞–ø–∏—Å–∏ –∫ –¥–∞–Ω–Ω—ã–º –≤–µ–∫—Ç–æ—Ä–∞ v.
- 15.3 –†–∞–∑–º–µ—Ä k –≤–µ—Ä—Ö–Ω–µ–≥–æ –±–ª–æ—á–Ω–æ–≥–æ —Ä—è–¥–∞ –≤ –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω–æ–º –≤–µ–∫—Ç–æ—Ä–µ v, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–æ–≥–æ, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –∑–∞–¥–∞—á–∞ –æ–±–æ–±—â–µ–Ω–Ω–æ–π –∏ –≤—ã—á–∏—Å–ª—è—é—Ç—Å—è –ª–∏ –Ω–∞–∏–º–µ–Ω—å—à–∏–µ —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è.
- 15.4 –ï—Å–ª–∏ –∑–∞–¥–∞–Ω –ª–µ–≤—ã–π –Ω–∞—á–∞–ª—å–Ω—ã–π –≤–µ–∫—Ç–æ—Ä, –µ–≥–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∞—è —á–∞—Å—Ç—å –∫–æ–ø–∏—Ä—É–µ—Ç—Å—è –≤ va. –ü—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è —Ä–∞–∑–º–µ—Ä—ã. –ï—Å–ª–∏ –Ω–∞—á–∞–ª—å–Ω—ã–π –≤–µ–∫—Ç–æ—Ä –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∞—è —á–∞—Å—Ç—å –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω—É–ª—è–º–∏.
- 15.5 –ï—Å–ª–∏ –∑–∞–¥–∞–Ω –ø—Ä–∞–≤—ã–π –Ω–∞—á–∞–ª—å–Ω—ã–π –≤–µ–∫—Ç–æ—Ä, –æ–Ω –∫–æ–ø–∏—Ä—É–µ—Ç—Å—è –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –ø–æ–∑–∏—Ü–∏—é –≤ va. –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç—Å—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Ä–∞–∑–º–µ—Ä–æ–≤ –≤–µ–∫—Ç–æ—Ä–æ–≤ –∏ –º–∞—Ç—Ä–∏—Ü—ã. –ï—Å–ª–∏ –Ω–∞—á–∞–ª—å–Ω—ã–π –≤–µ–∫—Ç–æ—Ä –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∞—è —á–∞—Å—Ç—å –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω—É–ª—è–º–∏.
- 15.6 –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫ v. –ó–∞–º–µ–Ω—è–µ—Ç —Å—Ç–∞—Ä—ã–π –Ω–∞—á–∞–ª—å–Ω—ã–π –≤–µ–∫—Ç–æ—Ä –Ω–æ–≤—ã–º –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–º –≤–µ–∫—Ç–æ—Ä–æ–º v.
- 15.7 –û–±–Ω–æ–≤–ª—è–µ—Ç —á–∏—Å–ª–æ –Ω–∞—á–∞–ª—å–Ω—ã—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –Ω–∞—á–∞–ª—å–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –≤ —Ä–µ—à–∞—Ç–µ–ª–µ EPS. –£–¥–∞–ª—è—é—Ç—Å—è –Ω–∞—á–∞–ª—å–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä—ã.
- 15.8 –ó–∞–≤–µ—Ä—à–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫—É —Ä–µ—à–∞—Ç–µ–ª—è EPS –ø–æ—Å–ª–µ –≤—Å–µ—Ö —Ç–∏–ø–æ–≤.
- 15.9 –ü–æ–ª—É—á–∞–µ—Ç —Ä–∞–∑–º–µ—Ä –ø–æ–¥–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ ncv –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –ø—Ä–æ–µ–∫—Ü–∏–∏ mpd –∏–∑ —Ä–µ—à–∞—Ç–µ–ª—è EPS. svd->ncv = –º–∏–Ω–∏–º—É–º –∏–∑ M –∏ N. 
- 15.10 –ü–æ–ª—É—á–∞–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ —á–∏—Å–ª–æ –∏—Ç–µ—Ä–∞—Ü–∏–π –∏–∑ —Ä–µ—à–∞—Ç–µ–ª—è EPS. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —Ç–æ—á–Ω–æ—Å—Ç—å svd->tol, –µ—Å–ª–∏ –æ–Ω–∞ —Ä–∞–Ω–µ–µ –Ω–µ –±—ã–ª–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞.
- 15.11 –£–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –±—É–¥—É—Ç –≤—ã—á–∏—Å–ª–µ–Ω—ã –ª–µ–≤—ã–µ —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä—ã. –í—ã–¥–µ–ª—è–µ—Ç –ø–∞–º—è—Ç—å –¥–ª—è –≤–µ–∫—Ç–æ—Ä–æ–≤ —Ä–µ—à–µ–Ω–∏—è.
```
static PetscErrorCode SVDSetUp_Cyclic(SVD svd)
{
  SVD_CYCLIC        *cyclic = (SVD_CYCLIC*)svd->data;
  PetscInt          M,N,m,n,p,k,i,isl,offset,nev,ncv,mpd,maxit;
  PetscReal         tol;
  const PetscScalar *isa,*oa;
  PetscScalar       *va;
  EPSProblemType    ptype;
  PetscBool         trackall,issinv;
  Vec               v,t;
  ST                st;
  Mat               Omega;
  MatType           Atype;

  PetscFunctionBegin;
  PetscCall(MatGetSize(svd->A,&M,&N));
  PetscCall(MatGetLocalSize(svd->A,&m,&n));
  if (!cyclic->eps) PetscCall(SVDCyclicGetEPS(svd,&cyclic->eps));
  PetscCall(MatDestroy(&cyclic->C));
  PetscCall(MatDestroy(&cyclic->D));
  if (svd->isgeneralized) {
    if (svd->which==SVD_SMALLEST) {  /* alternative pencil */
      PetscCall(MatCreateVecs(svd->B,NULL,&t));
      PetscCall(SVDCyclicGetCyclicMat(svd,svd->B,svd->BT,&cyclic->C));
      PetscCall(SVDCyclicGetECrossMat(svd,svd->A,svd->AT,&cyclic->D,t));
    } else {
      PetscCall(MatCreateVecs(svd->A,NULL,&t));
      PetscCall(SVDCyclicGetCyclicMat(svd,svd->A,svd->AT,&cyclic->C));
      PetscCall(SVDCyclicGetECrossMat(svd,svd->B,svd->BT,&cyclic->D,t));
    }
    PetscCall(VecDestroy(&t));
    PetscCall(EPSSetOperators(cyclic->eps,cyclic->C,cyclic->D));
    PetscCall(EPSGetProblemType(cyclic->eps,&ptype));
    if (!ptype) PetscCall(EPSSetProblemType(cyclic->eps,EPS_GHEP));
  } else if (svd->ishyperbolic) {
    PetscCall(SVDCyclicGetCyclicMat(svd,svd->A,svd->AT,&cyclic->C));
    PetscCall(MatCreateVecs(cyclic->C,&v,NULL));
    PetscCall(VecSet(v,1.0));
    PetscCall(VecGetArrayRead(svd->omega,&oa));
    PetscCall(VecGetArray(v,&va));
    if (svd->swapped) PetscCall(PetscArraycpy(va+m,oa,n));
    else PetscCall(PetscArraycpy(va,oa,m));
    PetscCall(VecRestoreArrayRead(svd->omega,&oa));
    PetscCall(VecRestoreArray(v,&va));
    PetscCall(MatGetType(svd->OP,&Atype));
    PetscCall(MatCreate(PetscObjectComm((PetscObject)svd),&Omega));
    PetscCall(MatSetSizes(Omega,m+n,m+n,M+N,M+N));
    PetscCall(MatSetType(Omega,Atype));
    PetscCall(MatDiagonalSet(Omega,v,INSERT_VALUES));
    PetscCall(EPSSetOperators(cyclic->eps,cyclic->C,Omega));
    PetscCall(EPSSetProblemType(cyclic->eps,EPS_GHIEP));
    PetscCall(MatDestroy(&Omega));
    PetscCall(VecDestroy(&v));
  } else {
    PetscCall(SVDCyclicGetCyclicMat(svd,svd->A,svd->AT,&cyclic->C));
    PetscCall(EPSSetOperators(cyclic->eps,cyclic->C,NULL));
    PetscCall(EPSSetProblemType(cyclic->eps,EPS_HEP));
  }
  if (!cyclic->usereps) {
    if (svd->which == SVD_LARGEST) {
      PetscCall(EPSGetST(cyclic->eps,&st));
      PetscCall(PetscObjectTypeCompare((PetscObject)st,STSINVERT,&issinv));
      if (issinv) PetscCall(EPSSetWhichEigenpairs(cyclic->eps,EPS_TARGET_MAGNITUDE));
      else if (svd->ishyperbolic) PetscCall(EPSSetWhichEigenpairs(cyclic->eps,EPS_LARGEST_MAGNITUDE));
      else PetscCall(EPSSetWhichEigenpairs(cyclic->eps,EPS_LARGEST_REAL));
    } else {
      if (svd->isgeneralized) {  /* computes sigma^{-1} via alternative pencil */
        PetscCall(EPSSetWhichEigenpairs(cyclic->eps,EPS_LARGEST_REAL));
      } else {
        if (svd->ishyperbolic) PetscCall(EPSSetWhichEigenpairs(cyclic->eps,EPS_TARGET_MAGNITUDE));
        else PetscCall(EPSSetEigenvalueComparison(cyclic->eps,SlepcCompareSmallestPosReal,NULL));
        PetscCall(EPSSetTarget(cyclic->eps,0.0));
      }
    }
    PetscCall(EPSGetDimensions(cyclic->eps,&nev,&ncv,&mpd));
    PetscCheck(nev==1 || nev>=2*svd->nsv,PetscObjectComm((PetscObject)svd),PETSC_ERR_ARG_WRONG,"The number of requested eigenvalues %" PetscInt_FMT " must be at least 2*%" PetscInt_FMT,nev,svd->nsv);
    nev = PetscMax(nev,2*svd->nsv);
    if (ncv==PETSC_DETERMINE && svd->ncv!=PETSC_DETERMINE) ncv = PetscMax(3*svd->nsv,svd->ncv);
    if (mpd==PETSC_DETERMINE && svd->mpd!=PETSC_DETERMINE) mpd = svd->mpd;
    PetscCall(EPSSetDimensions(cyclic->eps,nev,ncv,mpd));
    PetscCall(EPSGetTolerances(cyclic->eps,&tol,&maxit));
    if (tol==(PetscReal)PETSC_DETERMINE) tol = svd->tol==(PetscReal)PETSC_DETERMINE? SLEPC_DEFAULT_TOL/10.0: svd->tol;
    if (maxit==PETSC_DETERMINE) maxit = svd->max_it;
    PetscCall(EPSSetTolerances(cyclic->eps,tol,maxit));
    switch (svd->conv) {
    case SVD_CONV_ABS:
      PetscCall(EPSSetConvergenceTest(cyclic->eps,EPS_CONV_ABS));break;
    case SVD_CONV_REL:
      PetscCall(EPSSetConvergenceTest(cyclic->eps,EPS_CONV_REL));break;
    case SVD_CONV_NORM:
      if (svd->isgeneralized) {
        if (!svd->nrma) PetscCall(MatNorm(svd->OP,NORM_INFINITY,&svd->nrma));
        if (!svd->nrmb) PetscCall(MatNorm(svd->OPb,NORM_INFINITY,&svd->nrmb));
        PetscCall(EPSSetConvergenceTestFunction(cyclic->eps,EPSConv_Cyclic,svd,NULL));
      } else {
        PetscCall(EPSSetConvergenceTest(cyclic->eps,EPS_CONV_NORM));break;
      }
      break;
    case SVD_CONV_MAXIT:
      SETERRQ(PetscObjectComm((PetscObject)svd),PETSC_ERR_SUP,"Maxit convergence test not supported in this solver");
    case SVD_CONV_USER:
      SETERRQ(PetscObjectComm((PetscObject)svd),PETSC_ERR_SUP,"User-defined convergence test not supported in this solver");
    }
  }
  SVDCheckUnsupported(svd,SVD_FEATURE_STOPPING);
  /* Transfer the trackall option from svd to eps */
  PetscCall(SVDGetTrackAll(svd,&trackall));
  PetscCall(EPSSetTrackAll(cyclic->eps,trackall));
  /* Transfer the initial subspace from svd to eps */
  if (svd->nini<0 || svd->ninil<0) {
    for (i=0;i<-PetscMin(svd->nini,svd->ninil);i++) {
      PetscCall(MatCreateVecs(cyclic->C,&v,NULL));
      PetscCall(VecGetArrayWrite(v,&va));
      if (svd->isgeneralized) PetscCall(MatGetLocalSize(svd->B,&p,NULL));
      k = (svd->isgeneralized && svd->which==SVD_SMALLEST)? p: m;  /* size of upper block row */
      if (i<-svd->ninil) {
        PetscCall(VecGetArrayRead(svd->ISL[i],&isa));
        if (svd->isgeneralized) {
          PetscCall(VecGetLocalSize(svd->ISL[i],&isl));
          PetscCheck(isl==m+p,PetscObjectComm((PetscObject)svd),PETSC_ERR_SUP,"Size mismatch for left initial vector");
          offset = (svd->which==SVD_SMALLEST)? m: 0;
          PetscCall(PetscArraycpy(va,isa+offset,k));
        } else {
          PetscCall(VecGetLocalSize(svd->ISL[i],&isl));
          PetscCheck(isl==k,PetscObjectComm((PetscObject)svd),PETSC_ERR_SUP,"Size mismatch for left initial vector");
          PetscCall(PetscArraycpy(va,isa,k));
        }
        PetscCall(VecRestoreArrayRead(svd->IS[i],&isa));
      } else PetscCall(PetscArrayzero(&va,k));
      if (i<-svd->nini) {
        PetscCall(VecGetLocalSize(svd->IS[i],&isl));
        PetscCheck(isl==n,PetscObjectComm((PetscObject)svd),PETSC_ERR_SUP,"Size mismatch for right initial vector");
        PetscCall(VecGetArrayRead(svd->IS[i],&isa));
        PetscCall(PetscArraycpy(va+k,isa,n));
        PetscCall(VecRestoreArrayRead(svd->IS[i],&isa));
      } else PetscCall(PetscArrayzero(va+k,n));
      PetscCall(VecRestoreArrayWrite(v,&va));
      PetscCall(VecDestroy(&svd->IS[i]));
      svd->IS[i] = v;
    }
    svd->nini = PetscMin(svd->nini,svd->ninil);
    PetscCall(EPSSetInitialSpace(cyclic->eps,-svd->nini,svd->IS));
    PetscCall(SlepcBasisDestroy_Private(&svd->nini,&svd->IS));
    PetscCall(SlepcBasisDestroy_Private(&svd->ninil,&svd->ISL));
  }
  PetscCall(EPSSetUp(cyclic->eps));
  PetscCall(EPSGetDimensions(cyclic->eps,NULL,&svd->ncv,&svd->mpd));
  svd->ncv = PetscMin(svd->ncv,PetscMin(M,N));
  PetscCall(EPSGetTolerances(cyclic->eps,NULL,&svd->max_it));
  if (svd->tol==(PetscReal)PETSC_DETERMINE) svd->tol = SLEPC_DEFAULT_TOL;

  svd->leftbasis = PETSC_TRUE;
  PetscCall(SVDAllocateSolution(svd,0));
  PetscFunctionReturn(PETSC_SUCCESS);
}
```

### ```SVDCyclicGetECrossMat```

#### –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—è?

–°–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É –∫—Ä–æ—Å—Å –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä–∞—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –∞–ª–≥–æ—Ä–∏—Ç–º–∞—Ö —Å–∏–Ω–≥—É–ª—è—Ä–Ω–æ–≥–æ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏—è (SVD) –≤ —Ü–∏–∫–ª–∏—á–µ—Å–∫–æ–º –º–µ—Ç–æ–¥–µ.

#### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:  
SVD svd - ???  
Mat A - –ú–∞—Ç—Ä–∏—Ü–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –±–ª–æ–∫–∞ $A^T*A$  
Mat AT - —Ç—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –±–ª–æ–∫–∞ $A^T*A$  
Mat *C - –ø–æ–ª—É—á–∞–µ–º–∞—è —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –∫—Ä–æ—Å—Å –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è (extended cross product matrix) 
Vec t - –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–π –≤–µ–∫—Ç–æ—Ä, –Ω—É–∂–Ω—ã–π –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–æ–≤ –µ–¥–∏–Ω–∏—á–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã $I_m$‚Äã - –∏ –¥–ª—è $M$ –∏ –¥–ª—è $m$.

#### –í–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
PetscErrorCode - –∫–æ–¥—ã –æ—à–∏–±–æ–∫

#### –î–µ—Ç–∞–ª–∏ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏–∏

1. –ü–µ—Ä–≤—ã–µ —Å—Ç—Ä–æ–∫–∏ - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
```
  SVD_CYCLIC       *cyclic = (SVD_CYCLIC*)svd->data;
  SVD_CYCLIC_SHELL *ctx;
  PetscInt         i,M,N,m,n,Istart,Iend;
  VecType          vtype;
  Mat              Id,Zm,Zn,ATA;
#if defined(PETSC_HAVE_CUDA) || defined(PETSC_HAVE_HIP)
  PetscBool        gpu;
  const PetscInt   *ranges;
  PetscMPIInt      size;
#endif
```
ctx ‚Äî –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –Ω–µ—è–≤–Ω–æ–π-–º–∞—Ç—Ä–∏—Ü–µ–π.  
i ‚Äî –∏–Ω–¥–µ–∫—Å ???  
M, N ‚Äî –≥–ª–æ–±–∞–ª—å–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã –º–∞—Ç—Ä–∏—Ü—ã ùê¥.  
m, n ‚Äî –ª–æ–∫–∞–ª—å–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã –º–∞—Ç—Ä–∏—Ü—ã ùê¥ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.  
Istart, Iend ‚Äî –Ω–∞—á–∞–ª–æ –∏ –∫–æ–Ω–µ—Ü –¥–∏–∞–ø–∞–∑–æ–Ω–∞ –∏–Ω–¥–µ–∫—Å–æ–≤ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.  
vtype ‚Äî —Ç–∏–ø –≤–µ–∫—Ç–æ—Ä–æ–≤, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –≤ –º–∞—Ç—Ä–∏—Ü–µ.  
Zm, Zn ‚Äî –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç—Ä–∏—Ü—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ü–∏–∫–ª–∏—á–µ—Å–∫–æ–π –º–∞—Ç—Ä–∏—Ü—ã.  
ATA - –≤—Ä–µ–º–µ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è $A^TA$  

–ü–æ—Å–ª–µ–¥—É—é—â–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫ –∑–∞–ø–æ–ª–Ω—è—é—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ.

2. –î–∞–ª–µ–µ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –º–∞—Ç—Ä–∏—Ü–∞ —è–≤–Ω–æ–π
```
  if (cyclic->explicitmatrix) {
```
–ï—Å–ª–∏ —É—Å–ª–æ–≤–∏–µ –∏—Å—Ç–∏–Ω–Ω–æ, —Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–∞
```
    PetscCheck(svd->expltrans,PetscObjectComm((PetscObject)svd),PETSC_ERR_SUP,"Cannot use explicit cyclic matrix with implicit transpose");
```

–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –ø—Ä–∏ –∏—Å–ø —è–≤–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã C —Ç–∞–∫–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —è–≤–Ω—ã–π –º–µ—Ç–æ–¥ –æ–±—Ä–∞—Ç–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–ª–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –¥–ª—è —Ç—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã A 
(svd->expltrans = PETSC_TRUE)

–¥–∞–ª–µ–µ –∏–¥–µ—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ C –¥–ª—è —è–≤–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã.   
–ü–µ—Ä–µ–º–Ω–æ–∂–µ–Ω–∏–µ –æ–±—ã—á–Ω–æ–π –∏ —Ç—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã
```
    PetscCall(MatAssemblyEnd(Zn,MAT_FINAL_ASSEMBLY));
    PetscCall(MatProductCreate(AT,A,NULL,&ATA));
```
–°–æ–∑–¥–∞–Ω–∏–µ –±–ª–æ—á–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã  
```
MatCreateTile(1.0, Id, 1.0, Zm, 1.0, Zn, 1.0, ATA, C);
```

3. –ï—Å–ª–∏ –º–∞—Ç—Ä–∏—Ü–∞ –Ω–µ—è–≤–Ω–∞—è, —Ç–æ 

–°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∏ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤???    

–°–æ–∑–¥–∞–Ω–∏–µ –Ω–µ—è–≤–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã
```
PetscCall(MatCreateShell(PetscObjectComm((PetscObject)svd),m+n,m+n,M+N,M+N,ctx,C));
```

–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ "–æ–ø–µ—Ä–∞—Ü–∏–π –Ω–∞ –º–∞—Ç—Ä–∏—Ü–µ"
```
    PetscCall(MatShellSetOperation(*C,MATOP_GET_DIAGONAL,(void(*)(void))MatGetDiagonal_ECross));
    PetscCall(MatShellSetOperation(*C,MATOP_DESTROY,(void(*)(void))MatDestroy_ECross));
```
–≥–¥–µ 

MATOP_GET_DIAGONAL: —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤.
MATOP_DESTROY: —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –ø–∞–º—è—Ç–∏.
MATOP_MULT: —É–º–Ω–æ–∂–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü—ã –Ω–∞ –≤–µ–∫—Ç–æ—Ä

–≠—Ç–æ—Ç –±–ª–æ–∫ –∑–∞–Ω–∏–º–∞–µ—Ç—Å—è —Å–æ–∑–¥–∞–Ω–∏–µ–º –æ–±–æ–ª–æ—á–µ—á–Ω–æ–π (shell) –º–∞—Ç—Ä–∏—Ü—ã –¥–ª—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è C, –∏—Å–ø–æ–ª—å–∑—É—è –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏ —Ñ—É–Ω–∫—Ü–∏–∏, –≤–º–µ—Å—Ç–æ —è–≤–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤—Å–µ—Ö –µ—ë —ç–ª–µ–º–µ–Ω—Ç–æ–≤.


–¢—É—Ç —á—Ç–æ —Ç–æ —Å—Ç—Ä–∞—à–Ω–æ–µ —Å –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ–º (–Ω–µ–ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω–∞—è –∏–Ω—Ñ–∞)
```
ctx->misaligned = (((ranges[i+1] - ranges[i]) * sizeof(PetscScalar)) % 16) ? PETSC_TRUE : PETSC_FALSE;
```


## –ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è.

### –§—É–Ω–∫—Ü–∏—è MatMult_Cyclic(Mat B,Vec x,Vec y) - —Ñ—É–Ω–∫—Ü–∏—è –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –Ω–∞ –≤—Ö–æ–¥ –ø—Ä–∏–º–∞–µ—Ç –≤—Ö–æ–¥–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É, –≤—Ö–æ–¥–Ω–æ–π –≤–µ–∫—Ç–æ—Ä, –≤—ã—Ö–æ–¥–Ω–æ–π –≤–µ–∫—Ç–æ—Ä. –ü–æ–∑–≤–æ–ª—è–µ—Ç —É–º–Ω–æ–∂–∏—Ç—å –º–∞—Ç—Ä–∏—Ü—É B –Ω–∞ –≤–µ–∫—Ç–æ—Ä x —Å –ø–æ–º–æ—â—å—é —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π.

–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: 
- –ú–∞—Ç—Ä–∏—Ü–∞ B;
- –í–µ–∫—Ç–æ—Ä x;
- –í–µ–∫—Ç–æ—Ä y.\
–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
- –í–µ–∫—Ç–æ—Ä y= B*x.\

```
static PetscErrorCode MatMult_Cyclic(Mat B,Vec x,Vec y)
{
  SVD_CYCLIC_SHELL  *ctx;
  const PetscScalar *px;
  PetscScalar       *py;
  PetscInt          m;

  PetscFunctionBegin;
  PetscCall(MatShellGetContext(B,&ctx));
  PetscCall(MatGetLocalSize(ctx->A,&m,NULL));
  PetscCall(VecGetArrayRead(x,&px));
  PetscCall(VecGetArrayWrite(y,&py));
  PetscCall(VecPlaceArray(ctx->x1,px));
  PetscCall(VecPlaceArray(ctx->x2,px+m));
  PetscCall(VecPlaceArray(ctx->y1,py));
  PetscCall(VecPlaceArray(ctx->y2,py+m));
  PetscCall(MatMult(ctx->A,ctx->x2,ctx->y1));
  PetscCall(MatMult(ctx->AT,ctx->x1,ctx->y2));
  PetscCall(VecResetArray(ctx->x1));
  PetscCall(VecResetArray(ctx->x2));
  PetscCall(VecResetArray(ctx->y1));
  PetscCall(VecResetArray(ctx->y2));
  PetscCall(VecRestoreArrayRead(x,&px));
  PetscCall(VecRestoreArrayWrite(y,&py));
  PetscFunctionReturn(PETSC_SUCCESS);
}
```

### –§—É–Ω–∫—Ü–∏—è MatGetDiagonal_Cyclic(Mat B,Vec diag) - —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω—É–ª–µ–≤–æ–π –≤–µ–∫—Ç–æ—Ä.

–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
- –ú–∞—Ç—Ä–∏—Ü–∞ B;
- –í–µ–∫—Ç–æ—Ä diag.\
–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
- –ù—É–ª–µ–≤–æ–π –≤–µ–∫—Ç–æ—Ä diag, —Å–æ–ø–æ—Å—Ç–∞–≤–∏–º—ã–π —Å —Ä–∞–∑–º–µ—Ä–∞–º–∏ –º–∞—Ç—Ä–∏—Ü–∞ B.\


```
static PetscErrorCode MatGetDiagonal_Cyclic(Mat B,Vec diag)
{
  PetscFunctionBegin;
  PetscCall(VecSet(diag,0.0));
  PetscFunctionReturn(PETSC_SUCCESS);
}
```

### –§—É–Ω–∫—Ü–∏—è MatDestroy_Cyclic(Mat B) - –¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä –º–∞—Ç—Ä–∏—Ü–∞ B.

–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
- –ú–∞—Ç—Ä–∏—Ü–∞ B.
–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: -.
```
static PetscErrorCode MatDestroy_Cyclic(Mat B)
{
  SVD_CYCLIC_SHELL *ctx;

  PetscFunctionBegin;
  PetscCall(MatShellGetContext(B,&ctx));
  PetscCall(VecDestroy(&ctx->x1));
  PetscCall(VecDestroy(&ctx->x2));
  PetscCall(VecDestroy(&ctx->y1));
  PetscCall(VecDestroy(&ctx->y2));
  if (ctx->misaligned) {
    PetscCall(VecDestroy(&ctx->wx2));
    PetscCall(VecDestroy(&ctx->wy2));
  }
  PetscCall(PetscFree(ctx));
  PetscFunctionReturn(PETSC_SUCCESS);
}
```

### –§—É–Ω–∫—Ü–∏—è MatMult_ECross(Mat B,Vec x,Vec y) - —Ñ—É–Ω–∫—Ü–∏—è –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –Ω–∞ –≤—Ö–æ–¥ –ø—Ä–∏–º–∞–µ—Ç –≤—Ö–æ–¥–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É, –≤—Ö–æ–¥–Ω–æ–π –≤–µ–∫—Ç–æ—Ä, –≤—ã—Ö–æ–¥–Ω–æ–π –≤–µ–∫—Ç–æ—Ä. –ü–æ–∑–≤–æ–ª—è–µ—Ç —É–º–Ω–æ–∂–∏—Ç—å –∫—Ä–æ—Å—Å-–º–∞—Ç—Ä–∏—Ü—É B –Ω–∞ –≤–µ–∫—Ç–æ—Ä x –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏ –∏–ª–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏.

–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: 
- –ú–∞—Ç—Ä–∏—Ü–∞ B;
- –í–µ–∫—Ç–æ—Ä x;
- –í–µ–∫—Ç–æ—Ä y.\
–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
- –í–µ–∫—Ç–æ—Ä y= B*x.\
```
static PetscErrorCode MatMult_ECross(Mat B,Vec x,Vec y)
{
  SVD_CYCLIC_SHELL  *ctx;
  const PetscScalar *px;
  PetscScalar       *py;
  PetscInt          mn,m,n;

  PetscFunctionBegin;
  PetscCall(MatShellGetContext(B,&ctx));
  PetscCall(MatGetLocalSize(ctx->A,NULL,&n));
  PetscCall(VecGetLocalSize(y,&mn));
  m = mn-n;
  PetscCall(VecGetArrayRead(x,&px));
  PetscCall(VecGetArrayWrite(y,&py));
  PetscCall(VecPlaceArray(ctx->x1,px));
  PetscCall(VecPlaceArray(ctx->x2,px+m));
  PetscCall(VecPlaceArray(ctx->y1,py));
  PetscCall(VecPlaceArray(ctx->y2,py+m));
  PetscCall(VecCopy(ctx->x1,ctx->y1));
  PetscCall(MatMult(ctx->A,ctx->x2,ctx->w));
  PetscCall(MatMult(ctx->AT,ctx->w,ctx->y2));
  PetscCall(VecResetArray(ctx->x1));
  PetscCall(VecResetArray(ctx->x2));
  PetscCall(VecResetArray(ctx->y1));
  PetscCall(VecResetArray(ctx->y2));
  PetscCall(VecRestoreArrayRead(x,&px));
  PetscCall(VecRestoreArrayWrite(y,&py));
  PetscFunctionReturn(PETSC_SUCCESS);
}
```

### –§—É–Ω–∫—Ü–∏—è MatDestroy_ECross(Mat B) - –¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä –∫—Ä–æ—Å—Å-–º–∞—Ç—Ä–∏—Ü—ã B.\
–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: 
- –ö—Ä–æ—Å—Å-–º–∞—Ç—Ä–∏—Ü–∞ B.\
–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: -. 
```
static PetscErrorCode MatDestroy_ECross(Mat B)
{
  SVD_CYCLIC_SHELL *ctx;

  PetscFunctionBegin;
  PetscCall(MatShellGetContext(B,&ctx));
  PetscCall(VecDestroy(&ctx->x1));
  PetscCall(VecDestroy(&ctx->x2));
  PetscCall(VecDestroy(&ctx->y1));
  PetscCall(VecDestroy(&ctx->y2));
  PetscCall(VecDestroy(&ctx->diag));
  PetscCall(VecDestroy(&ctx->w));
  if (ctx->misaligned) {
    PetscCall(VecDestroy(&ctx->wx2));
    PetscCall(VecDestroy(&ctx->wy2));
  }
  PetscCall(PetscFree(ctx));
  PetscFunctionReturn(PETSC_SUCCESS);
}
```

### –§—É–Ω–∫—Ü–∏—è EPSConv_Cyclic(EPS eps,PetscScalar eigr,PetscScalar eigi,PetscReal res,PetscReal *errest,void *ctx) - —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é –æ—Ü–µ–Ω–∫—É –æ—à–∏–±–∫–∏, –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞.\

–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
- EPS eps - –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –∑–∞–¥–∞—á–∏ –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.
- PetscScalar eigr —Ö—Ä–∞–Ω–∏—Ç —Ä–µ–∞–ª—å–Ω—É—é —á–∞—Å—Ç—å —Ç–µ–∫—É—â–µ–≥–æ –≤—ã—á–∏—Å–ª–µ–Ω–Ω–æ–≥–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è.
- PetscScalar eigi —Ö—Ä–∞–Ω–∏—Ç –º–Ω–∏–º—É—é —á–∞—Å—Ç—å —Ç–µ–∫—É—â–µ–≥–æ –≤—ã—á–∏—Å–ª–µ–Ω–Ω–æ–≥–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è.
- PetscReal res –æ—à–∏–±–∫–∞ –¥–ª—è –Ω–∞–π–¥–µ–Ω–Ω–æ–≥–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è.
- PetscReal *errest —É–∫–∞–∑—ã–≤–∞–µ—Ç, –∫—É–¥–∞ —Ñ—É–Ω–∫—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –∑–∞–ø–∏—Å–∞—Ç—å –≤—ã—á–∏—Å–ª–µ–Ω–Ω—É—é –æ—Ü–µ–Ω–∫—É –æ—à–∏–±–∫–∏.
- void *ctx –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –æ–±—ä–µ–∫—Ç —Ç–∏–ø–∞ SVD, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–∏–Ω–≥—É–ª—è—Ä–Ω–æ–≥–æ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏—è –º–∞—Ç—Ä–∏—Ü.\
–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
- PETSC_SUCCESS: –§—É–Ω–∫—Ü–∏—è –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å —É—Å–ø–µ—à–Ω–æ, –∏–Ω–∞—á–µ –∫–æ–¥ –æ—à–∏–±–∫–∏.
- PetscReal errest –≤—ã—á–∏—Å–ª–µ–Ω–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –æ—à–∏–±–∫–∏ —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏.
  
```
static PetscErrorCode EPSConv_Cyclic(EPS eps,PetscScalar eigr,PetscScalar eigi,PetscReal res,PetscReal *errest,void *ctx)
{
  SVD svd = (SVD)ctx;

  PetscFunctionBegin;
  *errest = res/PetscMax(svd->nrma,svd->nrmb);
  PetscFunctionReturn(PETSC_SUCCESS);
}
```

### –§—É–Ω–∫—Ü–∏—è  SVDSolve_Cyclic(SVD svd) - —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è —Ä–µ–∞–ª–∏–∑—É–µ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ —Å–∏–Ω–≥—É–ª—è—Ä–Ω–æ–≥–æ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ü–∏–∫–ª–∏—á–µ—Å–∫–æ–≥–æ –º–µ—Ç–æ–¥–∞.\

–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
- –æ–±—ä–µ–∫—Ç SVD (—Å–∏–Ω–≥—É–ª—è—Ä–Ω–æ–µ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏–µ), –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–¥–∞—á–∏.\
–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
- –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ SVD: svd->sigma: –ú–∞—Å—Å–∏–≤ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π; svd->nconv: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π; svd->its: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Ç–µ—Ä–∞—Ü–∏–π, –ø–æ—Ç—Ä–µ–±–æ–≤–∞–≤—à–∏—Ö—Å—è –¥–ª—è —Ä–µ—à–µ–Ω–∏—è; svd->reason: –ü—Ä–∏—á–∏–Ω–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π.\

1. –û–±—ä—è–≤–ª–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö.
2. –í—ã–∑—ã–≤–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é EPSSolve, –∫–æ—Ç–æ—Ä–∞—è —Ä–µ—à–∞–µ—Ç –∑–∞–¥–∞—á—É –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π, –∏—Å–ø–æ–ª—å–∑—É—è –æ–±—ä–µ–∫—Ç EPS.
3. –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç, —Å–∫–æ–ª—å–∫–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π —Å–æ—à–ª–æ—Å—å, –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ nconv.
4. –ò–∑–≤–ª–µ–∫–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Ç–µ—Ä–∞—Ü–∏–π, –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏, –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –µ–≥–æ –≤ –ø–æ–ª–µ svd->its.
5. –ü–æ–ª—É—á–∞–µ—Ç –ø—Ä–∏—á–∏–Ω—É –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –µ–µ –≤ svd->reason.
6. –¶–∏–∫–ª –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—Å–µ—Ö —Å–æ—à–µ–¥—à–∏—Ö—Å—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π:
- –ü–æ–ª—É—á–∞–µ—Ç i-–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ: er ‚Äî —Ä–µ–∞–ª—å–Ω–∞—è —á–∞—Å—Ç—å, ei ‚Äî –º–Ω–∏–º–∞—è —á–∞—Å—Ç—å.
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å Œª=er+ei‚ãÖi (—Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è) –¥–ª—è –∑–∞–¥–∞—á–∏ —Å–∏–Ω–≥—É–ª—è—Ä–Ω–æ–≥–æ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏—è. –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç—Å—è –≤ —Å–∏–Ω–≥—É–ª—è—Ä–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ œÉ.
- –ü—Ä–æ–≤–µ—Ä–∫–∞: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ œÉ, —Ç–∞–∫ –∫–∞–∫ —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—é –Ω–µ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã.
- –ï—Å–ª–∏ –∑–∞–¥–∞—á–∞ —è–≤–ª—è–µ—Ç—Å—è –æ–±–æ–±—â–µ–Ω–Ω–æ–π (svd->isgeneralized) –∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —Å–∏–Ω–≥—É–ª—è—Ä–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (svd->which == SVD_SMALLEST), –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–±—Ä–∞—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ $1/œÉ$.
- –í –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Å–ª—É—á–∞—è—Ö —Å–∏–Ω–≥—É–ª—è—Ä–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è.
7.–°–æ—Ö—Ä–∞–Ω—è–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤ svd->nconv.

```
static PetscErrorCode SVDSolve_Cyclic(SVD svd)
{
  SVD_CYCLIC     *cyclic = (SVD_CYCLIC*)svd->data;
  PetscInt       i,j,nconv;
  PetscScalar    er,ei;
  PetscReal      sigma;

  PetscFunctionBegin;
  PetscCall(EPSSolve(cyclic->eps));
  PetscCall(EPSGetConverged(cyclic->eps,&nconv));
  PetscCall(EPSGetIterationNumber(cyclic->eps,&svd->its));
  PetscCall(EPSGetConvergedReason(cyclic->eps,(EPSConvergedReason*)&svd->reason));
  for (i=0,j=0;i<nconv;i++) {
    PetscCall(EPSGetEigenvalue(cyclic->eps,i,&er,&ei));
    PetscCall(SVDCyclicCheckEigenvalue(svd,er,ei,&sigma,NULL));
    if (sigma>0.0) {
      if (svd->isgeneralized && svd->which==SVD_SMALLEST) svd->sigma[j] = 1.0/sigma;
      else svd->sigma[j] = sigma;
      j++;
    }
  }
  svd->nconv = j;
  PetscFunctionReturn(PETSC_SUCCESS);
}
```

### –§—É–Ω–∫—Ü–∏—è SVDComputeVectors_Cyclic(SVD svd) - –≤—ã–±–∏—Ä–∞–µ—Ç –ø–æ–¥—Ö–æ–¥—è—â—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤, –∏—Å—Ö–æ–¥—è –∏–∑ —Ç–∏–ø–∞ –∑–∞–¥–∞—á–∏, –∏ –≤—ã–∑—ã–≤–∞–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é.\

–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
- –æ–±—ä–µ–∫—Ç SVD (—Å–∏–Ω–≥—É–ª—è—Ä–Ω–æ–µ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏–µ), –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–¥–∞—á–∏.\
–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
- –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ SVD.
```
static PetscErrorCode SVDComputeVectors_Cyclic(SVD svd)
{
  PetscFunctionBegin;
  switch (svd->problem_type) {
    case SVD_STANDARD:
      PetscCall(SVDComputeVectors_Cyclic_Standard(svd));
      break;
    case SVD_GENERALIZED:
      PetscCall(SVDComputeVectors_Cyclic_Generalized(svd));
      break;
    case SVD_HYPERBOLIC:
      PetscCall(SVDComputeVectors_Cyclic_Hyperbolic(svd));
      break;
    default:
      SETERRQ(PetscObjectComm((PetscObject)svd),PETSC_ERR_ARG_WRONG,"Unknown singular value problem type");
  }
  PetscFunctionReturn(PETSC_SUCCESS);
}
```

### –§—É–Ω–∫—Ü–∏—è EPSMonitor_Cyclic(EPS eps,PetscInt its,PetscInt nconv,PetscScalar *eigr,PetscScalar *eigi,PetscReal *errest,PetscInt nest,void *ctx) - —Ä–µ–∞–ª–∏–∑—É–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ—Ü–µ—Å—Å–∞ –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤ —Ü–∏–∫–ª–∏—á–µ—Å–∫–æ–º –º–µ—Ç–æ–¥–µ, —Å–≤—è–∑–∞–Ω–Ω–æ–≥–æ —Å –∑–∞–¥–∞—á–µ–π —Å–∏–Ω–≥—É–ª—è—Ä–Ω–æ–≥–æ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏—è (SVD). –û–Ω–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–µ–∫—É—â–∏—Ö —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –∏ –æ—à–∏–±–æ–∫ –∏—Ö –æ—Ü–µ–Ω–∫–∏, –ø—Ä–µ–æ–±—Ä–∞–∑—É—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã–µ.

–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
- EPS eps - –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –∑–∞–¥–∞—á–∏ –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.
- PetscScalar eigr —Ö—Ä–∞–Ω–∏—Ç —Ä–µ–∞–ª—å–Ω—É—é —á–∞—Å—Ç—å —Ç–µ–∫—É—â–µ–≥–æ –≤—ã—á–∏—Å–ª–µ–Ω–Ω–æ–≥–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è.
- PetscScalar eigi —Ö—Ä–∞–Ω–∏—Ç –º–Ω–∏–º—É—é —á–∞—Å—Ç—å —Ç–µ–∫—É—â–µ–≥–æ –≤—ã—á–∏—Å–ª–µ–Ω–Ω–æ–≥–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è.
- PetscReal res –æ—à–∏–±–∫–∞ –¥–ª—è –Ω–∞–π–¥–µ–Ω–Ω–æ–≥–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è.
- PetscReal *errest —É–∫–∞–∑—ã–≤–∞–µ—Ç, –∫—É–¥–∞ —Ñ—É–Ω–∫—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –∑–∞–ø–∏—Å–∞—Ç—å –≤—ã—á–∏—Å–ª–µ–Ω–Ω—É—é –æ—Ü–µ–Ω–∫—É –æ—à–∏–±–∫–∏.
- void *ctx –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –æ–±—ä–µ–∫—Ç —Ç–∏–ø–∞ SVD, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–∏–Ω–≥—É–ª—è—Ä–Ω–æ–≥–æ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏—è –º–∞—Ç—Ä–∏—Ü.\
–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
- PETSC_SUCCESS: –§—É–Ω–∫—Ü–∏—è –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å —É—Å–ø–µ—à–Ω–æ, –∏–Ω–∞—á–µ –∫–æ–¥ –æ—à–∏–±–∫–∏.
- PetscReal errest –≤—ã—á–∏—Å–ª–µ–Ω–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –æ—à–∏–±–∫–∏ —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏.

```
static PetscErrorCode EPSMonitor_Cyclic(EPS eps,PetscInt its,PetscInt nconv,PetscScalar *eigr,PetscScalar *eigi,PetscReal *errest,PetscInt nest,void *ctx)
{
  PetscInt       i,j;
  SVD            svd = (SVD)ctx;
  PetscScalar    er,ei;
  PetscReal      sigma;
  ST             st;

  PetscFunctionBegin;
  nconv = 0;
  PetscCall(EPSGetST(eps,&st));
  for (i=0,j=0;i<PetscMin(nest,svd->ncv);i++) {
    er = eigr[i]; ei = eigi[i];
    PetscCall(STBackTransform(st,1,&er,&ei));
    PetscCall(SVDCyclicCheckEigenvalue(svd,er,ei,&sigma,NULL));
    if (sigma>0.0) {
      svd->sigma[j]  = sigma;
      svd->errest[j] = errest[i];
      if (errest[i] && errest[i] < svd->tol) nconv++;
      j++;
    }
  }
  nest = j;
  PetscCall(SVDMonitor(svd,its,nconv,svd->sigma,svd->errest,nest));
  PetscFunctionReturn(PETSC_SUCCESS);
}
```

### –§—É–∫–Ω—Ü–∏—è SVDSetFromOptions_Cyclic(SVD svd,PetscOptionItems *PetscOptionsObject) - –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∑–∞–¥–∞—á–∏ —Å–∏–Ω–≥—É–ª—è—Ä–Ω–æ–≥–æ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏—è (SVD) –º–µ—Ç–æ–¥–æ–º cyclic –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –æ–ø—Ü–∏–π. –û–Ω–∞: –ß–∏—Ç–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –∑–∞–¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É –∏–ª–∏ –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å. –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –æ–±—ä–µ–∫—Ç SVD –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —ç—Ç–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏. –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –º–µ—Ç–æ–¥–∞ —Å —É—á–µ—Ç–æ–º –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫.\

–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
- –æ–±—ä–µ–∫—Ç SVD (—Å–∏–Ω–≥—É–ª—è—Ä–Ω–æ–µ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏–µ), –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–¥–∞—á–∏.
- PetscOptionItems *PetscOptionsObject –ø–µ—Ä–µ–¥–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã.
–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
- –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ SVD.

```
static PetscErrorCode SVDSetFromOptions_Cyclic(SVD svd,PetscOptionItems *PetscOptionsObject)
{
  PetscBool      set,val;
  SVD_CYCLIC     *cyclic = (SVD_CYCLIC*)svd->data;
  ST             st;

  PetscFunctionBegin;
  PetscOptionsHeadBegin(PetscOptionsObject,"SVD Cyclic Options");

    PetscCall(PetscOptionsBool("-svd_cyclic_explicitmatrix","Use cyclic explicit matrix","SVDCyclicSetExplicitMatrix",cyclic->explicitmatrix,&val,&set));
    if (set) PetscCall(SVDCyclicSetExplicitMatrix(svd,val));

  PetscOptionsHeadEnd();

  if (!cyclic->eps) PetscCall(SVDCyclicGetEPS(svd,&cyclic->eps));
  if (!cyclic->explicitmatrix && !cyclic->usereps) {
    /* use as default an ST with shell matrix and Jacobi */
    PetscCall(EPSGetST(cyclic->eps,&st));
    PetscCall(STSetMatMode(st,ST_MATMODE_SHELL));
  }
  PetscCall(EPSSetFromOptions(cyclic->eps));
  PetscFunctionReturn(PETSC_SUCCESS);
}
```

### –§—É–∫–Ω—Ü–∏—è SVDCyclicSetExplicitMatrix_Cyclic(SVD svd,PetscBool explicitmat) - –æ–±–Ω–æ–≤–ª—è–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —è–≤–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã –≤ –º–µ—Ç–æ–¥–µ —Ü–∏–∫–ª–∏—á–µ—Å–∫–æ–≥–æ —Å–∏–Ω–≥—É–ª—è—Ä–Ω–æ–≥–æ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏—è (SVD).\ 

–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
- –æ–±—ä–µ–∫—Ç SVD (—Å–∏–Ω–≥—É–ª—è—Ä–Ω–æ–µ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏–µ), –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–¥–∞—á–∏.
- PetscBool explicitmat - –ª–æ–≥–∏—á–µ—Å–∫–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä, —É–∫–∞–∑—ã–≤–∞—é—â–∏–π, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–∏ —è–≤–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É –≤ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è—Ö.\
–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
- PetscBool explicitmat.
  
```
static PetscErrorCode SVDCyclicSetExplicitMatrix_Cyclic(SVD svd,PetscBool explicitmat)
{
  SVD_CYCLIC *cyclic = (SVD_CYCLIC*)svd->data;

  PetscFunctionBegin;
  if (cyclic->explicitmatrix != explicitmat) {
    cyclic->explicitmatrix = explicitmat;
    svd->state = SVD_STATE_INITIAL;
  }
  PetscFunctionReturn(PETSC_SUCCESS);
}
```

–§—É–Ω–∫—Ü–∏—è SVDCyclicSetExplicitMatrix(SVD svd,PetscBool explicitmat) - –æ–±–Ω–æ–≤–ª—è–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —è–≤–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã —Å–∏–Ω–≥—É–ª—è—Ä–Ω–æ–≥–æ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏—è (SVD).\ 

–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
- –æ–±—ä–µ–∫—Ç SVD (—Å–∏–Ω–≥—É–ª—è—Ä–Ω–æ–µ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏–µ), –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–¥–∞—á–∏.
- PetscBool explicitmat - –ª–æ–≥–∏—á–µ—Å–∫–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä, —É–∫–∞–∑—ã–≤–∞—é—â–∏–π, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–∏ —è–≤–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É –≤ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è—Ö.\
–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
- PetscBool explicitmat.

```
PetscErrorCode SVDCyclicSetExplicitMatrix(SVD svd,PetscBool explicitmat)
{
  PetscFunctionBegin;
  PetscValidHeaderSpecific(svd,SVD_CLASSID,1);
  PetscValidLogicalCollectiveBool(svd,explicitmat,2);
  PetscTryMethod(svd,"SVDCyclicSetExplicitMatrix_C",(SVD,PetscBool),(svd,explicitmat));
  PetscFunctionReturn(PETSC_SUCCESS);
}
```

### –§—É–∫–Ω—Ü–∏—è SVDCyclicGetExplicitMatrix_Cyclic(SVD svd,PetscBool *explicitmat) - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–æ–º, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–∏ —è–≤–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –≤ —Ä–∞—Å—á–µ—Ç–∞—Ö.\

–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
- –æ–±—ä–µ–∫—Ç SVD (—Å–∏–Ω–≥—É–ª—è—Ä–Ω–æ–µ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏–µ), –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–¥–∞—á–∏.
- —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ PetscBool explicitmat - –ª–æ–≥–∏—á–µ—Å–∫–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä, —É–∫–∞–∑—ã–≤–∞—é—â–∏–π, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–∏ —è–≤–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É –≤ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è—Ö.\
–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
- PetscBool explicitmat.

```
static PetscErrorCode SVDCyclicGetExplicitMatrix_Cyclic(SVD svd,PetscBool *explicitmat)
{
  SVD_CYCLIC *cyclic = (SVD_CYCLIC*)svd->data;

  PetscFunctionBegin;
  *explicitmat = cyclic->explicitmatrix;
  PetscFunctionReturn(PETSC_SUCCESS);
}
```

### –§—É–∫–Ω—Ü–∏—è SVDCyclicSetEPS(SVD svd,EPS eps) - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–±—ä–µ–∫—Ç–∞ EPS (eigensolver) –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –∑–∞–¥–∞—á–∏ —Å–∏–Ω–≥—É–ª—è—Ä–Ω–æ–≥–æ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏—è (SVD) –º–µ—Ç–æ–¥–æ–º cyclic. –û–±—ä–µ–∫—Ç EPS —è–≤–ª—è–µ—Ç—Å—è —Ä–µ—à–∞—Ç–µ–ª–µ–º —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ –º–µ—Ç–æ–¥–∞ cyclic –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π.\
–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
- –æ–±—ä–µ–∫—Ç SVD (—Å–∏–Ω–≥—É–ª—è—Ä–Ω–æ–µ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏–µ), –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–¥–∞—á–∏.
- –æ–±—ä–µ–∫—Ç EPS, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π. \
–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: -.

```
PetscErrorCode SVDCyclicSetEPS(SVD svd,EPS eps)
{
  PetscFunctionBegin;
  PetscValidHeaderSpecific(svd,SVD_CLASSID,1);
  PetscValidHeaderSpecific(eps,EPS_CLASSID,2);
  PetscCheckSameComm(svd,1,eps,2);
  PetscTryMethod(svd,"SVDCyclicSetEPS_C",(SVD,EPS),(svd,eps));
  PetscFunctionReturn(PETSC_SUCCESS);
}
```
### –§—É–∫–Ω—Ü–∏—è SVDCyclicSetEPS(SVD svd,EPS eps) - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞ —Ä–µ—à–∞—Ç–µ–ª—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π (EPS) –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –º–µ—Ç–æ–¥–∞ cyclic –¥–ª—è —Å–∏–Ω–≥—É–ª—è—Ä–Ω–æ–≥–æ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏—è (SVD). –ï—Å–ª–∏ –æ–±—ä–µ–∫—Ç EPS –µ—â–µ –Ω–µ —Å–æ–∑–¥–∞–Ω, —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç –µ–≥–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫—É.\
–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
- –æ–±—ä–µ–∫—Ç SVD (—Å–∏–Ω–≥—É–ª—è—Ä–Ω–æ–µ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏–µ), –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–¥–∞—á–∏.
- –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é, –≤ –∫–æ—Ç–æ—Ä—É—é –±—É–¥–µ—Ç –∑–∞–ø–∏—Å–∞–Ω –æ–±—ä–µ–∫—Ç EPS. \
–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
- –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –æ–±—ä–µ–∫—Ç EPS.

```
static PetscErrorCode SVDCyclicGetEPS_Cyclic(SVD svd,EPS *eps)
{
  SVD_CYCLIC     *cyclic = (SVD_CYCLIC*)svd->data;

  PetscFunctionBegin;
  if (!cyclic->eps) {
    PetscCall(EPSCreate(PetscObjectComm((PetscObject)svd),&cyclic->eps));
    PetscCall(PetscObjectIncrementTabLevel((PetscObject)cyclic->eps,(PetscObject)svd,1));
    PetscCall(EPSSetOptionsPrefix(cyclic->eps,((PetscObject)svd)->prefix));
    PetscCall(EPSAppendOptionsPrefix(cyclic->eps,"svd_cyclic_"));
    PetscCall(PetscObjectSetOptions((PetscObject)cyclic->eps,((PetscObject)svd)->options));
    PetscCall(EPSSetWhichEigenpairs(cyclic->eps,EPS_LARGEST_REAL));
    PetscCall(EPSMonitorSet(cyclic->eps,EPSMonitor_Cyclic,svd,NULL));
  }
  *eps = cyclic->eps;
  PetscFunctionReturn(PETSC_SUCCESS);
}
```

### –§—É–∫–Ω—Ü–∏—è SVDCyclicGetEPS(SVD svd,EPS *eps) - –≤—ã–∑—ã–≤–∞–µ—Ç –º–µ—Ç–æ–¥, —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–π –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ —Ç–∏–ø–∞ SVD.\
–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
- –æ–±—ä–µ–∫—Ç SVD (—Å–∏–Ω–≥—É–ª—è—Ä–Ω–æ–µ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏–µ), –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–¥–∞—á–∏.
- –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é, –≤ –∫–æ—Ç–æ—Ä—É—é –±—É–¥–µ—Ç –∑–∞–ø–∏—Å–∞–Ω –æ–±—ä–µ–∫—Ç EPS. \
–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:-.\

```
PetscErrorCode SVDCyclicGetEPS(SVD svd,EPS *eps)
{
  PetscFunctionBegin;
  PetscValidHeaderSpecific(svd,SVD_CLASSID,1);
  PetscAssertPointer(eps,2);
  PetscUseMethod(svd,"SVDCyclicGetEPS_C",(SVD,EPS*),(svd,eps));
  PetscFunctionReturn(PETSC_SUCCESS);
}
```

### –§—É–∫–Ω—Ü–∏—è SVDView_Cyclic(SVD svd,PetscViewer viewer) - –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –º–µ—Ç–æ–¥–∞ cyclic –¥–ª—è –∑–∞–¥–∞—á–∏ —Å–∏–Ω–≥—É–ª—è—Ä–Ω–æ–≥–æ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏—è (SVD). –û–Ω–∞ –≤—ã–≤–æ–¥–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –º–µ—Ç–æ–¥–∞ –≤ —É–∫–∞–∑–∞–Ω–Ω—ã–π PetscViewer. \
–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
- –æ–±—ä–µ–∫—Ç SVD (—Å–∏–Ω–≥—É–ª—è—Ä–Ω–æ–µ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏–µ), –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–¥–∞—á–∏.
- –û–±—ä–µ–∫—Ç PPetscViewer –¥–ª—è –≤—ã–≤–æ–¥–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏. \
–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
- PetscViewer viewer.\

```
static PetscErrorCode SVDView_Cyclic(SVD svd,PetscViewer viewer)
{
  SVD_CYCLIC     *cyclic = (SVD_CYCLIC*)svd->data;
  PetscBool      isascii;

  PetscFunctionBegin;
  PetscCall(PetscObjectTypeCompare((PetscObject)viewer,PETSCVIEWERASCII,&isascii));
  if (isascii) {
    if (!cyclic->eps) PetscCall(SVDCyclicGetEPS(svd,&cyclic->eps));
    PetscCall(PetscViewerASCIIPrintf(viewer,"  %s matrix\n",cyclic->explicitmatrix?"explicit":"implicit"));
    PetscCall(PetscViewerASCIIPushTab(viewer));
    PetscCall(EPSView(cyclic->eps,viewer));
    PetscCall(PetscViewerASCIIPopTab(viewer));
  }
  PetscFunctionReturn(PETSC_SUCCESS);
}
```

### –§—É–∫–Ω—Ü–∏—è SVDReset_Cyclic(SVD svd) - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–±—Ä–æ—Å–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –º–µ—Ç–æ–¥–∞ cyclic –≤ –∑–∞–¥–∞—á–µ —Å–∏–Ω–≥—É–ª—è—Ä–Ω–æ–≥–æ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏—è (SVD). –û–Ω–∞ –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç —Ä–µ—Å—É—Ä—Å—ã, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å —ç—Ç–∏–º –º–µ—Ç–æ–¥–æ–º, –≤–∫–ª—é—á–∞—è –æ–±—ä–µ–∫—Ç EPS –∏ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç—Ä–∏—Ü—ã. \
–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
- –æ–±—ä–µ–∫—Ç SVD (—Å–∏–Ω–≥—É–ª—è—Ä–Ω–æ–µ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏–µ), –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–¥–∞—á–∏.\
–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:-\
```
static PetscErrorCode SVDReset_Cyclic(SVD svd)
{
  SVD_CYCLIC     *cyclic = (SVD_CYCLIC*)svd->data;

  PetscFunctionBegin;
  PetscCall(EPSReset(cyclic->eps));
  PetscCall(MatDestroy(&cyclic->C));
  PetscCall(MatDestroy(&cyclic->D));
  PetscFunctionReturn(PETSC_SUCCESS);
}
```

### –§—É–∫–Ω—Ü–∏—è  SVDDestroy_Cyclic(SVD svd) - –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç –≤—Å–µ —Ä–µ—Å—É—Ä—Å—ã, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –º–µ—Ç–æ–¥–æ–º cyclic –¥–ª—è –∑–∞–¥–∞—á–∏ —Å–∏–Ω–≥—É–ª—è—Ä–Ω–æ–≥–æ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏—è (SVD). –û–Ω–∞ —É–Ω–∏—á—Ç–æ–∂–∞–µ—Ç –æ–±—ä–µ–∫—Ç EPS, –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç –ø–∞–º—è—Ç—å, –∏—Å–ø–æ–ª—å–∑—É–µ–º—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π –¥–∞–Ω–Ω—ã—Ö SVD_CYCLIC, –∏ —É–¥–∞–ª—è–µ—Ç —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –º–µ—Ç–æ–¥–æ–º cyclic —Ñ—É–Ω–∫—Ü–∏–∏. \
–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
- –æ–±—ä–µ–∫—Ç SVD (—Å–∏–Ω–≥—É–ª—è—Ä–Ω–æ–µ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏–µ), –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–¥–∞—á–∏.\
–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:-\

```
static PetscErrorCode SVDDestroy_Cyclic(SVD svd)
{
  SVD_CYCLIC     *cyclic = (SVD_CYCLIC*)svd->data;

  PetscFunctionBegin;
  PetscCall(EPSDestroy(&cyclic->eps));
  PetscCall(PetscFree(svd->data));
  PetscCall(PetscObjectComposeFunction((PetscObject)svd,"SVDCyclicSetEPS_C",NULL));
  PetscCall(PetscObjectComposeFunction((PetscObject)svd,"SVDCyclicGetEPS_C",NULL));
  PetscCall(PetscObjectComposeFunction((PetscObject)svd,"SVDCyclicSetExplicitMatrix_C",NULL));
  PetscCall(PetscObjectComposeFunction((PetscObject)svd,"SVDCyclicGetExplicitMatrix_C",NULL));
  PetscFunctionReturn(PETSC_SUCCESS);
}
```

### –§—É–∫–Ω—Ü–∏—è  SVDCreate_Cyclic - —Å–æ–∑–¥–∞–µ—Ç –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –æ–±—ä–µ–∫—Ç –¥–ª—è –∑–∞–¥–∞—á–∏ —Å–∏–Ω–≥—É–ª—è—Ä–Ω–æ–≥–æ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏—è (SVD) —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–µ—Ç–æ–¥–∞ cyclic. –û–Ω–∞ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö SVD –∏ –∑–∞–¥–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏–∏, —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –¥–ª—è –º–µ—Ç–æ–¥–∞ cyclic.. \

–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
- –æ–±—ä–µ–∫—Ç SVD (—Å–∏–Ω–≥—É–ª—è—Ä–Ω–æ–µ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏–µ), –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–¥–∞—á–∏.\
–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
- –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç SVD.

```
SLEPC_EXTERN PetscErrorCode SVDCreate_Cyclic(SVD svd)
{
  SVD_CYCLIC     *cyclic;

  PetscFunctionBegin;
  PetscCall(PetscNew(&cyclic));
  svd->data                = (void*)cyclic;
  svd->ops->solve          = SVDSolve_Cyclic;
  svd->ops->solveg         = SVDSolve_Cyclic;
  svd->ops->solveh         = SVDSolve_Cyclic;
  svd->ops->setup          = SVDSetUp_Cyclic;
  svd->ops->setfromoptions = SVDSetFromOptions_Cyclic;
  svd->ops->destroy        = SVDDestroy_Cyclic;
  svd->ops->reset          = SVDReset_Cyclic;
  svd->ops->view           = SVDView_Cyclic;
  svd->ops->computevectors = SVDComputeVectors_Cyclic;
  PetscCall(PetscObjectComposeFunction((PetscObject)svd,"SVDCyclicSetEPS_C",SVDCyclicSetEPS_Cyclic));
  PetscCall(PetscObjectComposeFunction((PetscObject)svd,"SVDCyclicGetEPS_C",SVDCyclicGetEPS_Cyclic));
  PetscCall(PetscObjectComposeFunction((PetscObject)svd,"SVDCyclicSetExplicitMatrix_C",SVDCyclicSetExplicitMatrix_Cyclic));
  PetscCall(PetscObjectComposeFunction((PetscObject)svd,"SVDCyclicGetExplicitMatrix_C",SVDCyclicGetExplicitMatrix_Cyclic));
  PetscFunctionReturn(PETSC_SUCCESS);
}
```

# References.

1. SLEPc Users Manual Scalable Library for Eigenvalue Problem Computations, Carmen Campos Jose E. Roman, Eloy Romero Andres Tomas. –†–∞–∑–¥–µ–ª EPS: Eigenvalue Problem Solver, —Å—Ç—Ä–∞–Ω–∏—Ü–∞ 17.  
2. http://www.grycap.upv.es/slepc.  
3. https://petsc.org/release/  
4. https://slepc.upv.es/slepc-main/include/slepc/private/
5. https://en.wikipedia.org/wiki/Generalized_singular_value_decomposition
